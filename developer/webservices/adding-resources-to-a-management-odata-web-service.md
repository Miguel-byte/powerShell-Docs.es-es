---
title: Agregar recursos a un servicio de administración Web de OData | Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: e620bf6d-76be-47b0-a7a8-f43418f30c60
caps.latest.revision: 6
ms.openlocfilehash: b81a32b867795ae51c3f5308c2f82c31ed2747fa
ms.sourcegitcommit: b6871f21bd666f9cd71dd336bb3f844cf472b56c
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 02/03/2019
ms.locfileid: "56858371"
---
# <a name="adding-resources-to-a-management-odata-web-service"></a><span data-ttu-id="e9f7d-102">Adición de recursos a un servicio web de Management OData</span><span class="sxs-lookup"><span data-stu-id="e9f7d-102">Adding Resources to a Management OData Web Service</span></span>

<span data-ttu-id="e9f7d-103">En este ejemplo se muestra cómo agregar un recurso a un servicio web de IIS Management OData existente mediante el Diseñador de esquemas de OData de administración.</span><span class="sxs-lookup"><span data-stu-id="e9f7d-103">This example demonstrates how to add a resource to an existing Management OData web service by using the Management OData Schema Designer.</span></span> <span data-ttu-id="e9f7d-104">El [PswsRoleBasedPlugins](https://code.msdn.microsoft.com:443/windowsdesktop/PswsRoleBasedPlugins-9c79b75a) ejemplo crea un servicio web que expone los recursos de proceso y el servidor.</span><span class="sxs-lookup"><span data-stu-id="e9f7d-104">The [PswsRoleBasedPlugins](https://code.msdn.microsoft.com:443/windowsdesktop/PswsRoleBasedPlugins-9c79b75a) sample creates a web service that exposes the Process and Server resources.</span></span> <span data-ttu-id="e9f7d-105">En este ejemplo, agregará un recurso de máquina Virtual (VM) para el servicio web.</span><span class="sxs-lookup"><span data-stu-id="e9f7d-105">In this example, you will add a Virtual Machine (VM) resource to the web service.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="e9f7d-106">Requisitos previos</span><span class="sxs-lookup"><span data-stu-id="e9f7d-106">Prerequisites</span></span>

<span data-ttu-id="e9f7d-107">En este tema se da por supuesto que ha descargado e instalado la [PswsRoleBasedPlugins](https://code.msdn.microsoft.com:443/windowsdesktop/PswsRoleBasedPlugins-9c79b75a) de ejemplo como se describe en [crear un servicio de Windows PowerShell Web](./creating-a-management-odata-web-service.md), y que ha descargado e instalado el [Diseñador de esquemas de OData de administración](https://marketplace.visualstudio.com/items?itemName=jlisc0.ManagementODataSchemaDesigner).</span><span class="sxs-lookup"><span data-stu-id="e9f7d-107">This topic assumes that you have downloaded and installed the [PswsRoleBasedPlugins](https://code.msdn.microsoft.com:443/windowsdesktop/PswsRoleBasedPlugins-9c79b75a) sample as described in [Creating a Windows PowerShell Web Service](./creating-a-management-odata-web-service.md), and that you have downloaded and installed the [Management OData Schema Designer](https://marketplace.visualstudio.com/items?itemName=jlisc0.ManagementODataSchemaDesigner).</span></span> <span data-ttu-id="e9f7d-108">En este tema también se supone que tiene el módulo de Hyper-V de Windows PowerShell instalado en el equipo donde se configura el extremo de Odata de administración.</span><span class="sxs-lookup"><span data-stu-id="e9f7d-108">This topic also assumes that you have the Hyper-V Windows PowerShell module installed on the computer where you set up the Management Odata endpoint.</span></span>

## <a name="adding-vm-as-a-resource-to-the-web-service"></a><span data-ttu-id="e9f7d-109">Agregar máquina virtual como un recurso para el servicio Web</span><span class="sxs-lookup"><span data-stu-id="e9f7d-109">Adding VM as a Resource to the Web Service</span></span>

<span data-ttu-id="e9f7d-110">El primer paso consiste en importar el esquema desde el punto de conexión de OData de administración existente en el Diseñador de esquemas.</span><span class="sxs-lookup"><span data-stu-id="e9f7d-110">The first step is to import the schema from the existing Management OData endpoint into the schema designer.</span></span> <span data-ttu-id="e9f7d-111">El siguiente procedimiento describe cómo hacerlo.</span><span class="sxs-lookup"><span data-stu-id="e9f7d-111">The following procedure describes how to do that.</span></span>

#### <a name="importing-an-existing-schema-into-the-schema-designer"></a><span data-ttu-id="e9f7d-112">Importar un esquema existente en el Diseñador de esquemas</span><span class="sxs-lookup"><span data-stu-id="e9f7d-112">Importing an existing schema into the schema designer</span></span>

1. <span data-ttu-id="e9f7d-113">Abra el Diseñador de esquemas de OData de administración.</span><span class="sxs-lookup"><span data-stu-id="e9f7d-113">Open the Management OData Schema Designer.</span></span>

2. <span data-ttu-id="e9f7d-114">Desde el **archivo** menú, seleccione **archivo** ; **Nuevo** ; **Archivo**.</span><span class="sxs-lookup"><span data-stu-id="e9f7d-114">From the **File** menu, select **File** ; **New** ; **File**.</span></span> <span data-ttu-id="e9f7d-115">El **nuevo archivo** aparece el cuadro de diálogo.</span><span class="sxs-lookup"><span data-stu-id="e9f7d-115">The **New File** dialog appears.</span></span>

3. <span data-ttu-id="e9f7d-116">Haga clic en **modelo de administración de OData**y, a continuación, haga clic en **abierto**.</span><span class="sxs-lookup"><span data-stu-id="e9f7d-116">Click **Management OData Model**, and then click **Open**.</span></span>

4. <span data-ttu-id="e9f7d-117">Haga clic en la ventana principal y haga clic en **archivo de esquema** ; **Importación**.</span><span class="sxs-lookup"><span data-stu-id="e9f7d-117">Right-click in the main window, and click **Schema file** ; **Import**.</span></span> <span data-ttu-id="e9f7d-118">El **abierto** aparece el cuadro de diálogo.</span><span class="sxs-lookup"><span data-stu-id="e9f7d-118">The **Open** dialog appears.</span></span>

5. <span data-ttu-id="e9f7d-119">Navegue hasta la carpeta donde se configura el servicio web de IIS Management OData para la [PswsRoleBasedPlugins](https://code.msdn.microsoft.com:443/windowsdesktop/PswsRoleBasedPlugins-9c79b75a) ejemplo.</span><span class="sxs-lookup"><span data-stu-id="e9f7d-119">Navigate to the folder where you set up the Management OData web service for the [PswsRoleBasedPlugins](https://code.msdn.microsoft.com:443/windowsdesktop/PswsRoleBasedPlugins-9c79b75a) sample.</span></span> <span data-ttu-id="e9f7d-120">Si utiliza la secuencia de comandos Windows PowerShell con ese ejemplo para configurar el punto de conexión sin modificar el script, que la carpeta es **C:\inetpub\wwwroot\Modata**.</span><span class="sxs-lookup"><span data-stu-id="e9f7d-120">If you used the Windows PowerShell script provided with that sample to set up the endpoint without modifying the script, that folder is **C:\inetpub\wwwroot\Modata**.</span></span> <span data-ttu-id="e9f7d-121">Seleccione Schema.mof y haga clic en **abierto**.</span><span class="sxs-lookup"><span data-stu-id="e9f7d-121">Select Schema.mof, and click **Open**.</span></span>

   <span data-ttu-id="e9f7d-122">En este momento, abra los archivos Schema.mof y Schema.xml en un editor de texto y tenga en cuenta que contienen asignaciones para los recursos de proceso y servicio.</span><span class="sxs-lookup"><span data-stu-id="e9f7d-122">At this point, open the Schema.mof and Schema.xml files in a text editor, and notice that they contain mappings for the Process and Service resources.</span></span> <span data-ttu-id="e9f7d-123">Usa el archivo Schema.mof [Distributed Management Task Force](https://www.dmtf.org/) estándar (DTMF) MOF (Managed Object).</span><span class="sxs-lookup"><span data-stu-id="e9f7d-123">The Schema.mof file uses [Distributed Management  Task Force](https://www.dmtf.org/) (DTMF) Managed Object (MOF) standard.</span></span> <span data-ttu-id="e9f7d-124">El archivo schema.xml usa un esquema XML que se describe en [esquema de asignación de recursos](./resource-mapping-schema.md).</span><span class="sxs-lookup"><span data-stu-id="e9f7d-124">The schema.xml file uses an XML schema that is described in [Resource Mapping Schema](./resource-mapping-schema.md).</span></span>

   <span data-ttu-id="e9f7d-125">El siguiente procedimiento describe cómo importar los cmdlets de Hyper-V en el modelo de esquema.</span><span class="sxs-lookup"><span data-stu-id="e9f7d-125">The following procedure describes how to import Hyper-V cmdlets in to the schema model.</span></span>

#### <a name="importing-cmdlets-into-the-schema"></a><span data-ttu-id="e9f7d-126">Importación de cmdlets en el esquema</span><span class="sxs-lookup"><span data-stu-id="e9f7d-126">Importing cmdlets into the schema</span></span>

1. <span data-ttu-id="e9f7d-127">Haga doble clic en un área en blanco de la ventana del Diseñador de esquemas y haga clic en **Cmdlets de importación**.</span><span class="sxs-lookup"><span data-stu-id="e9f7d-127">Right-click on a blank area of the schema designer window, and click **Import Cmdlets**.</span></span> <span data-ttu-id="e9f7d-128">El **Asistente para importación de Cmdlet** aparece el cuadro de diálogo.</span><span class="sxs-lookup"><span data-stu-id="e9f7d-128">The **Cmdlet Import Wizard** dialog appears.</span></span>

2. <span data-ttu-id="e9f7d-129">Asegúrese de que **ordenador** está seleccionada y haga clic en **siguiente**.</span><span class="sxs-lookup"><span data-stu-id="e9f7d-129">Make sure **Local Computer** is selected, and click **Next**.</span></span>

3. <span data-ttu-id="e9f7d-130">Asegúrese de que se ha seleccionado instalar módulos de Windows PowerShell y seleccione Hyper-V en la lista desplegable.</span><span class="sxs-lookup"><span data-stu-id="e9f7d-130">Make sure that Installed Windows PowerShell Modules is selected, and select Hyper-V from the drop-down list.</span></span> <span data-ttu-id="e9f7d-131">Haga clic en **siguiente**.</span><span class="sxs-lookup"><span data-stu-id="e9f7d-131">click **Next**.</span></span> <span data-ttu-id="e9f7d-132">Haga clic en **Siguiente**.</span><span class="sxs-lookup"><span data-stu-id="e9f7d-132">Click **Next**.</span></span>

4. <span data-ttu-id="e9f7d-133">En el **Cmdlet sustantivo** lista, seleccione **VM**.</span><span class="sxs-lookup"><span data-stu-id="e9f7d-133">In the **Cmdlet Noun** list, select **VM**.</span></span> <span data-ttu-id="e9f7d-134">Haga clic en **Siguiente**.</span><span class="sxs-lookup"><span data-stu-id="e9f7d-134">Click **Next**</span></span>

5. <span data-ttu-id="e9f7d-135">En este ejemplo, enlazamos únicamente los comandos Get y Delete con los cmdlets.</span><span class="sxs-lookup"><span data-stu-id="e9f7d-135">For this example, we will bind only the Get and Delete commands with cmdlets.</span></span> <span data-ttu-id="e9f7d-136">Desactive el **crear** y **actualización** casillas de verificación y asegúrese de que el **obtener** y **eliminar** se comprueban las casillas de verificación.</span><span class="sxs-lookup"><span data-stu-id="e9f7d-136">Clear the **CREATE** and **UPDATE** checkboxes, and make sure the **GET** and **DELETE** checkboxes are checked.</span></span> <span data-ttu-id="e9f7d-137">Asegúrese de que el `Get-VM` cmdlet está seleccionado para **obtener**y el `Remove-VM` cmdlet está seleccionado para **eliminar**.</span><span class="sxs-lookup"><span data-stu-id="e9f7d-137">Make sure that the `Get-VM` cmdlet is selected for **GET**, and the `Remove-VM` cmdlet is selected for **DELETE**.</span></span>

6. <span data-ttu-id="e9f7d-138">Dado que los metadatos de los cmdlets de la máquina virtual no especifican un tipo de salida, deberá ejecutar el cmdlet para especificar el tipo de salida.</span><span class="sxs-lookup"><span data-stu-id="e9f7d-138">Because the metadata for the VM cmdlets does not specify an output type, you will need to run the cmdlet to specify the output type.</span></span> <span data-ttu-id="e9f7d-139">Seleccione **tipo de salida proporcione** y haga clic en **ejecutar el cmdlet**.</span><span class="sxs-lookup"><span data-stu-id="e9f7d-139">Select **Provide output type** and click **Run cmdlet**.</span></span> <span data-ttu-id="e9f7d-140">El **ejecutar el Cmdlet** aparece el cuadro de diálogo.</span><span class="sxs-lookup"><span data-stu-id="e9f7d-140">The **Run Cmdlet** dialog appears.</span></span> <span data-ttu-id="e9f7d-141">Haga clic en **ejecutar**.</span><span class="sxs-lookup"><span data-stu-id="e9f7d-141">Click **Run**.</span></span> <span data-ttu-id="e9f7d-142">El **tipo CLR** cuadro se rellena con el `VirtualMachine` tipo.</span><span class="sxs-lookup"><span data-stu-id="e9f7d-142">The **CLR Type** box is populated with the `VirtualMachine` type.</span></span> <span data-ttu-id="e9f7d-143">Haga clic en **Aceptar**, a continuación, haga clic en **siguiente**.</span><span class="sxs-lookup"><span data-stu-id="e9f7d-143">Click **OK**, then click **Next**.</span></span>

7. <span data-ttu-id="e9f7d-144">De forma predeterminada, se seleccionan todas las propiedades del objeto VirtualMachine.</span><span class="sxs-lookup"><span data-stu-id="e9f7d-144">By default, all of the properties of the VirtualMachine object are selected.</span></span> <span data-ttu-id="e9f7d-145">Puede borrar todas las propiedades que no desea como parte de los datos devueltos cuando se solicite este recurso desde el servicio web.</span><span class="sxs-lookup"><span data-stu-id="e9f7d-145">You can clear any properties that you do not want as part of the data returned when you request this resource from the web service.</span></span> <span data-ttu-id="e9f7d-146">Haga clic en **Siguiente**.</span><span class="sxs-lookup"><span data-stu-id="e9f7d-146">Click **Next**.</span></span>

8. <span data-ttu-id="e9f7d-147">Debe seleccionar al menos una propiedad que se usará como clave.</span><span class="sxs-lookup"><span data-stu-id="e9f7d-147">You must select at least one property to be used as a key.</span></span> <span data-ttu-id="e9f7d-148">Seleccione **nombre** en la lista y haga clic en **siguiente**.</span><span class="sxs-lookup"><span data-stu-id="e9f7d-148">Select **Name** in the list, and click **Next**.</span></span>

9. <span data-ttu-id="e9f7d-149">La siguiente ventana permite asignar propiedades de recurso de OData de administración a las propiedades de los cmdlets subyacentes.</span><span class="sxs-lookup"><span data-stu-id="e9f7d-149">The next window allows you to map properties of the Management OData resource to properties of the underlying cmdlets.</span></span> <span data-ttu-id="e9f7d-150">El asistente asigna las propiedades con nombres idénticos de forma predeterminada.</span><span class="sxs-lookup"><span data-stu-id="e9f7d-150">The wizard maps properties with identical names by default.</span></span> <span data-ttu-id="e9f7d-151">Por ejemplo, el `ComputerName` propiedad del recurso se asigna a la `ComputerName` propiedad de los cmdlets.</span><span class="sxs-lookup"><span data-stu-id="e9f7d-151">For example, the `ComputerName` property of the resource is mapped to the `ComputerName` property of the cmdlets.</span></span>  <span data-ttu-id="e9f7d-152">Esto le permite especificar el `ComputerName` propiedad en una solicitud al servicio web y tiene el valor especificado se pasa a la `Get-VM` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="e9f7d-152">This allows you to specify the `ComputerName` property in a request to the web service, and have the value you specify be passed to the `Get-VM` cmdlet.</span></span> <span data-ttu-id="e9f7d-153">`Id` y `Name` también se asignan de forma predeterminada.</span><span class="sxs-lookup"><span data-stu-id="e9f7d-153">`Id` and `Name` are also mapped by default.</span></span>

   10. <span data-ttu-id="e9f7d-154">Haga clic en **siguiente**, a continuación, haga clic en **finalizar**.</span><span class="sxs-lookup"><span data-stu-id="e9f7d-154">Click **Next**, then click **Finish**.</span></span>

       <span data-ttu-id="e9f7d-155">El recurso de máquina virtual ahora aparece en la ventana Esquema del diseñador.</span><span class="sxs-lookup"><span data-stu-id="e9f7d-155">The VM resource now appears in the schema designer window.</span></span> <span data-ttu-id="e9f7d-156">Puede examinar las propiedades y las operaciones asociadas con el recurso.</span><span class="sxs-lookup"><span data-stu-id="e9f7d-156">You can examine the properties and operations associated with the resource.</span></span> <span data-ttu-id="e9f7d-157">A continuación, exportará los archivos de esquema actualizado en el directorio virtual para el servicio web.</span><span class="sxs-lookup"><span data-stu-id="e9f7d-157">Next, you will export the updated schema files into the virtual directory for the web service.</span></span>

#### <a name="exporting-schema-files-from-the-schema-designer"></a><span data-ttu-id="e9f7d-158">Exportación de archivos de esquema desde el Diseñador de esquemas</span><span class="sxs-lookup"><span data-stu-id="e9f7d-158">Exporting schema files from the schema designer</span></span>

1. <span data-ttu-id="e9f7d-159">Haga doble clic en un área en blanco de la ventana del Diseñador de esquemas y haga clic en **archivo de esquema** ; **Exportar**.</span><span class="sxs-lookup"><span data-stu-id="e9f7d-159">Right-click on a blank area of the schema designer window, and click **Schema file** ; **Export**.</span></span> <span data-ttu-id="e9f7d-160">El **Guardar como** aparece el cuadro de diálogo.</span><span class="sxs-lookup"><span data-stu-id="e9f7d-160">The **Save As** dialog appears.</span></span>

2. <span data-ttu-id="e9f7d-161">Navegue hasta el mismo directorio desde donde se importó el archivo MOF.</span><span class="sxs-lookup"><span data-stu-id="e9f7d-161">Navigate to the same directory from where you imported the MOF file.</span></span> <span data-ttu-id="e9f7d-162">Nombre al archivo el mismo que el archivo MOF original (Schema.mof de forma predeterminada) y haga clic en **guardar**.</span><span class="sxs-lookup"><span data-stu-id="e9f7d-162">Name the file the same as the original MOF file (Schema.mof by default), and click **Save**.</span></span> <span data-ttu-id="e9f7d-163">Confirme que desea sobrescribir el archivo existente.</span><span class="sxs-lookup"><span data-stu-id="e9f7d-163">Confirm that you want to overwrite the existing file.</span></span>

   <span data-ttu-id="e9f7d-164">Aunque no se indica explícitamente en la **Guardar como** cuadro de diálogo, esto reemplaza el archivo Schema.xml y Schema.mof archivos.</span><span class="sxs-lookup"><span data-stu-id="e9f7d-164">Although it is not explicitly stated in the **Save As** dialog, this replaces both the Schema.mof and Schema.xml files.</span></span>

## <a name="next-steps"></a><span data-ttu-id="e9f7d-165">Pasos a seguir</span><span class="sxs-lookup"><span data-stu-id="e9f7d-165">Next Steps</span></span>

<span data-ttu-id="e9f7d-166">Antes de que tiene acceso el nuevo recurso de máquina virtual desde el servicio web de IIS Management OData, debe actualizar el archivo RbacConfiguration.xml para permitir el acceso al módulo de Hyper-V de Windows PowerShell como se describe en [autorización basada en roles de configuración de](./configuring-role-based-authorization.md), y también se deberá reiniciar el servicio web.</span><span class="sxs-lookup"><span data-stu-id="e9f7d-166">Before you access the new VM resource from the Management OData web service, you must update the RbacConfiguration.xml file to allow access to the Hyper-V Windows PowerShell module as described in [Configuring Role-based Authorization](./configuring-role-based-authorization.md), and you will also need to restart the web service.</span></span>