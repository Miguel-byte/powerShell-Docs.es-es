---
title: Creación de un proveedor de elementos de PowerShell de Windows | Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- item providers [PowerShell Programmer's Guide]
- providers [PowerShell Programmer's Guide], item provider
ms.assetid: a5a304ce-fc99-4a5b-a779-de7d85e031fe
caps.latest.revision: 6
ms.openlocfilehash: 30b4dbcd281f712bba8d8e3540d2282d527388e4
ms.sourcegitcommit: b6871f21bd666f9cd71dd336bb3f844cf472b56c
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 02/03/2019
ms.locfileid: "56862071"
---
# <a name="creating-a-windows-powershell-item-provider"></a><span data-ttu-id="07f51-102">Creación de un proveedor de elementos de Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="07f51-102">Creating a Windows PowerShell Item Provider</span></span>

<span data-ttu-id="07f51-103">Este tema describe cómo crear un proveedor de Windows PowerShell que puede manipular los datos en un almacén de datos.</span><span class="sxs-lookup"><span data-stu-id="07f51-103">This topic describes how to create a Windows PowerShell provider that can manipulate the data in a data store.</span></span> <span data-ttu-id="07f51-104">En este tema, se conocen como "elementos" de los datos de almacén de los elementos de datos en el almacén.</span><span class="sxs-lookup"><span data-stu-id="07f51-104">In this topic, the elements of data in the store are referred to as the "items" of the data store.</span></span> <span data-ttu-id="07f51-105">Como consecuencia, un proveedor que puede manipular los datos en el almacén se conoce como un proveedor de elementos de Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="07f51-105">As a consequence, a provider that can manipulate the data in the store is referred to as a Windows PowerShell item provider.</span></span>

> [!NOTE]
> <span data-ttu-id="07f51-106">Puede descargar el C# (AccessDBSampleProvider03.cs) de archivo de código fuente para este proveedor mediante el Microsoft Windows Software Development Kit para Windows Vista y .NET Framework 3.0 Runtime Components.</span><span class="sxs-lookup"><span data-stu-id="07f51-106">You can download the C# source file (AccessDBSampleProvider03.cs) for this provider using the Microsoft Windows Software Development Kit for Windows Vista and .NET Framework 3.0 Runtime Components.</span></span> <span data-ttu-id="07f51-107">Para obtener instrucciones de descarga, vea [cómo instalar Windows PowerShell y descarga el SDK de Windows PowerShell](/powershell/developer/installing-the-windows-powershell-sdk).</span><span class="sxs-lookup"><span data-stu-id="07f51-107">For download instructions, see [How to Install Windows PowerShell and Download the Windows PowerShell SDK](/powershell/developer/installing-the-windows-powershell-sdk).</span></span>
> <span data-ttu-id="07f51-108">Puede descargar el C# (AccessDBSampleProvider03.cs) de archivo de código fuente para este proveedor mediante el Microsoft Windows Software Development Kit para Windows Vista y .NET Framework 3.0 Runtime Components.</span><span class="sxs-lookup"><span data-stu-id="07f51-108">You can download the C# source file (AccessDBSampleProvider03.cs) for this provider using the Microsoft Windows Software Development Kit for Windows Vista and .NET Framework 3.0 Runtime Components.</span></span> <span data-ttu-id="07f51-109">Para obtener instrucciones de descarga, vea [cómo instalar Windows PowerShell y descarga el SDK de Windows PowerShell](/powershell/developer/installing-the-windows-powershell-sdk).</span><span class="sxs-lookup"><span data-stu-id="07f51-109">For download instructions, see [How to Install Windows PowerShell and Download the Windows PowerShell SDK](/powershell/developer/installing-the-windows-powershell-sdk).</span></span>
>
> <span data-ttu-id="07f51-110">Están disponibles en los archivos de origen descargado el  **\<ejemplos de PowerShell >** directory.</span><span class="sxs-lookup"><span data-stu-id="07f51-110">The downloaded source files are available in the **\<PowerShell Samples>** directory.</span></span>
>
> <span data-ttu-id="07f51-111">Para obtener más información acerca de otras implementaciones del proveedor de Windows PowerShell, consulte [diseñar su proveedor de Windows PowerShell](./designing-your-windows-powershell-provider.md).</span><span class="sxs-lookup"><span data-stu-id="07f51-111">For more information about other Windows PowerShell provider implementations, see [Designing Your Windows PowerShell Provider](./designing-your-windows-powershell-provider.md).</span></span>

<span data-ttu-id="07f51-112">El proveedor de elementos de Windows PowerShell que se describe en este tema obtiene los elementos de datos de una base de datos de Access.</span><span class="sxs-lookup"><span data-stu-id="07f51-112">The Windows PowerShell item provider described in this topic gets items of data from an Access database.</span></span> <span data-ttu-id="07f51-113">En este caso, un "elemento" es una tabla en la base de datos de Access o una fila en una tabla.</span><span class="sxs-lookup"><span data-stu-id="07f51-113">In this case, an "item" is either a table in the Access database or a row in a table.</span></span>

<span data-ttu-id="07f51-114">En la lista siguiente contiene las secciones de este tema.</span><span class="sxs-lookup"><span data-stu-id="07f51-114">The following list contains the sections in this topic.</span></span> <span data-ttu-id="07f51-115">Si no está familiarizado con la escritura de un proveedor de elementos de Windows PowerShell, lea estas secciones en el orden en que aparecen.</span><span class="sxs-lookup"><span data-stu-id="07f51-115">If you are unfamiliar with writing a Windows PowerShell item provider, read these sections in the order that they appear.</span></span> <span data-ttu-id="07f51-116">Sin embargo, si está familiarizado con la escritura de un proveedor de elementos de Windows PowerShell, vaya directamente a la información que necesita:</span><span class="sxs-lookup"><span data-stu-id="07f51-116">However, if you are familiar with writing a Windows PowerShell item provider, go directly to the information that you need:</span></span>

- [<span data-ttu-id="07f51-117">Definición de la clase de proveedor de Windows PowerShell elemento</span><span class="sxs-lookup"><span data-stu-id="07f51-117">Defining the Windows PowerShell Item Provider Class</span></span>](#Defining-the-Windows-PowerShell-Item-Provider-Class)

- [<span data-ttu-id="07f51-118">Definir la funcionalidad de Base</span><span class="sxs-lookup"><span data-stu-id="07f51-118">Defining Base Functionality</span></span>](#Defining-Base-Functionality)

- [<span data-ttu-id="07f51-119">Comprobación de validez de la ruta de acceso</span><span class="sxs-lookup"><span data-stu-id="07f51-119">Checking for Path Validity</span></span>](#Checking-for-Path-Validity)

- [<span data-ttu-id="07f51-120">Determinar si existe un elemento</span><span class="sxs-lookup"><span data-stu-id="07f51-120">Determining if an Item Exists</span></span>](#Determining-if-an-Item-Exists)

- [<span data-ttu-id="07f51-121">Asociar los parámetros dinámicos a la `Test-Path` Cmdlet</span><span class="sxs-lookup"><span data-stu-id="07f51-121">Attaching Dynamic Parameters to the `Test-Path` Cmdlet</span></span>](#Attaching-Dynamic-Parameters-to-the-Test-Path-Cmdlet)

- [<span data-ttu-id="07f51-122">Recuperación de un elemento</span><span class="sxs-lookup"><span data-stu-id="07f51-122">Retrieving an Item</span></span>](#Retrieving-an-Item)

- [<span data-ttu-id="07f51-123">Asociar los parámetros dinámicos a la `Get-Item` Cmdlet</span><span class="sxs-lookup"><span data-stu-id="07f51-123">Attaching Dynamic Parameters to the `Get-Item` Cmdlet</span></span>](#Attaching-Dynamic-Parameters-to-the-Get-Item-Cmdlet)

- [<span data-ttu-id="07f51-124">Definición de un elemento</span><span class="sxs-lookup"><span data-stu-id="07f51-124">Setting an Item</span></span>](#Setting-an-Item)

- [<span data-ttu-id="07f51-125">Asociar los parámetros dinámicos a la `Set-Item` Cmdlet</span><span class="sxs-lookup"><span data-stu-id="07f51-125">Attaching Dynamic Parameters to the `Set-Item` Cmdlet</span></span>](#Retrieving-Dynamic-Parameters-for-SetItem)

- [<span data-ttu-id="07f51-126">Borrar un elemento</span><span class="sxs-lookup"><span data-stu-id="07f51-126">Clearing an Item</span></span>](#Clearing-an-Item)

- [<span data-ttu-id="07f51-127">Asociar los parámetros dinámicos al Cmdlet Cler Item</span><span class="sxs-lookup"><span data-stu-id="07f51-127">Attaching Dynamic Parameters to the Cler-Item Cmdlet</span></span>](#Retrieve-Dynamic-Parameters-for-ClearItem)

- [<span data-ttu-id="07f51-128">Llevar a cabo una acción predeterminada para un elemento</span><span class="sxs-lookup"><span data-stu-id="07f51-128">Performing a Default Action for an Item</span></span>](#Performing-a-Default-Action-for-an-Item)

- [<span data-ttu-id="07f51-129">Recuperar los parámetros dinámicos para InvokeDefaultAction</span><span class="sxs-lookup"><span data-stu-id="07f51-129">Retrieving Dynamic Parameters for InvokeDefaultAction</span></span>](#Retrieve-Dynamic-Parameters-for-InvokeDefaultAction)

- [<span data-ttu-id="07f51-130">Implementación de métodos y clases auxiliares</span><span class="sxs-lookup"><span data-stu-id="07f51-130">Implementing Helper Methods and Classes</span></span>](#Implementing-Helper-Methods-and-Classes)

- [<span data-ttu-id="07f51-131">Ejemplo de código</span><span class="sxs-lookup"><span data-stu-id="07f51-131">Code Sample</span></span>](#Code-Sample)

- [<span data-ttu-id="07f51-132">Definir los tipos de objeto y el formato</span><span class="sxs-lookup"><span data-stu-id="07f51-132">Defining Object Types and Formatting</span></span>](#Defining-Object-Types-and-Formatting)

- [<span data-ttu-id="07f51-133">Creación del proveedor de Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="07f51-133">Building the Windows PowerShell Provider</span></span>](#Building-the-Windows-PowerShell-provider)

- [<span data-ttu-id="07f51-134">Probar el proveedor de Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="07f51-134">Testing the Windows PowerShell Provider</span></span>](#Testing-the-Windows-PowerShell-provider)

## <a name="defining-the-windows-powershell-item-provider-class"></a><span data-ttu-id="07f51-135">Definición de la clase de proveedor de Windows PowerShell elemento</span><span class="sxs-lookup"><span data-stu-id="07f51-135">Defining the Windows PowerShell Item Provider Class</span></span>

<span data-ttu-id="07f51-136">Un proveedor de elementos de Windows PowerShell debe definir una clase .NET que se deriva de la [System.Management.Automation.Provider.Itemcmdletprovider](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider) clase base.</span><span class="sxs-lookup"><span data-stu-id="07f51-136">A Windows PowerShell item provider must define a .NET class that derives from the [System.Management.Automation.Provider.Itemcmdletprovider](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider) base class.</span></span> <span data-ttu-id="07f51-137">La siguiente es la definición de clase para el proveedor de elementos que se describen en esta sección.</span><span class="sxs-lookup"><span data-stu-id="07f51-137">The following is the class definition for the item provider described in this section.</span></span>

[!code-csharp[AccessDBProviderSample03.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample03/AccessDBProviderSample03.cs#L34-L36 "AccessDBProviderSample03.cs")]

<span data-ttu-id="07f51-138">Tenga en cuenta que en esta definición, de la clase el [System.Management.Automation.Provider.Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) atributo incluye dos parámetros.</span><span class="sxs-lookup"><span data-stu-id="07f51-138">Note that in this class definition, the [System.Management.Automation.Provider.Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) attribute includes two parameters.</span></span> <span data-ttu-id="07f51-139">El primer parámetro especifica un nombre descriptivo para el proveedor que está usando Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="07f51-139">The first parameter specifies a user-friendly name for the provider that is used by Windows PowerShell.</span></span> <span data-ttu-id="07f51-140">El segundo parámetro especifica las capacidades específicas de Windows PowerShell que expone el proveedor para el tiempo de ejecución de Windows PowerShell durante el procesamiento de comandos.</span><span class="sxs-lookup"><span data-stu-id="07f51-140">The second parameter specifies the Windows PowerShell specific capabilities that the provider exposes to the Windows PowerShell runtime during command processing.</span></span> <span data-ttu-id="07f51-141">Para este proveedor, no hay ningún agregadas capacidades específicas de Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="07f51-141">For this provider, there are no added Windows PowerShell specific capabilities.</span></span>

## <a name="defining-base-functionality"></a><span data-ttu-id="07f51-142">Definir la funcionalidad de Base</span><span class="sxs-lookup"><span data-stu-id="07f51-142">Defining Base Functionality</span></span>

<span data-ttu-id="07f51-143">Como se describe en [proveedor de diseño de Windows PowerShell](./designing-your-windows-powershell-provider.md), [System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) clase se deriva de varias clases que proporcionan diferentes funcionalidad de proveedor.</span><span class="sxs-lookup"><span data-stu-id="07f51-143">As described in [Design Your Windows PowerShell Provider](./designing-your-windows-powershell-provider.md), the [System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) class derives from several other classes that provided different provider functionality.</span></span> <span data-ttu-id="07f51-144">Un proveedor de elementos de Windows PowerShell, por lo tanto, debe definir toda la funcionalidad proporcionada por esas clases.</span><span class="sxs-lookup"><span data-stu-id="07f51-144">A Windows PowerShell item provider, therefore, must define all of the functionality provided by those classes.</span></span>

<span data-ttu-id="07f51-145">Para obtener más información acerca de cómo implementar la funcionalidad para agregar información de inicialización específicas de la sesión y para liberar los recursos utilizados por el proveedor, consulte [creación de un proveedor de PowerShell de Windows básico](./creating-a-basic-windows-powershell-provider.md).</span><span class="sxs-lookup"><span data-stu-id="07f51-145">For more information about how to implement functionality for adding session-specific initialization information and for releasing resources used by the provider, see [Creating a Basic Windows PowerShell Provider](./creating-a-basic-windows-powershell-provider.md).</span></span> <span data-ttu-id="07f51-146">Sin embargo, la mayoría proveedores, incluidos el proveedor que se describe aquí, pueden usar la implementación predeterminada de esta funcionalidad proporcionada por Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="07f51-146">However, most providers, including the provider described here, can use the default implementation of this functionality that is provided by Windows PowerShell.</span></span>

<span data-ttu-id="07f51-147">Antes de que el proveedor de elementos de Windows PowerShell puede manipular los elementos en el almacén, debe implementar los métodos de la [System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) basar la clase para tener acceso al almacén de datos.</span><span class="sxs-lookup"><span data-stu-id="07f51-147">Before the Windows PowerShell item provider can manipulate the items in the store, it must implement the methods of the [System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) base class to access to the data store.</span></span> <span data-ttu-id="07f51-148">Para obtener más información sobre la implementación de esta clase, vea [creación de un proveedor de la unidad de Windows PowerShell](./creating-a-windows-powershell-drive-provider.md).</span><span class="sxs-lookup"><span data-stu-id="07f51-148">For more information about implementing this class, see [Creating a Windows PowerShell Drive Provider](./creating-a-windows-powershell-drive-provider.md).</span></span>

## <a name="checking-for-path-validity"></a><span data-ttu-id="07f51-149">Comprobación de validez de la ruta de acceso</span><span class="sxs-lookup"><span data-stu-id="07f51-149">Checking for Path Validity</span></span>

<span data-ttu-id="07f51-150">Cuando se busca un elemento de datos, el tiempo de ejecución de Windows PowerShell proporciona una ruta de acceso de Windows PowerShell para el proveedor, tal como se define en la sección "Conceptos de PSPath" de [cómo Windows PowerShell funciona](http://msdn.microsoft.com/en-us/ced30e23-10af-4700-8933-49873bd84d58).</span><span class="sxs-lookup"><span data-stu-id="07f51-150">When looking for an item of data, the Windows PowerShell runtime furnishes a Windows PowerShell path to the provider, as defined in the "PSPath Concepts" section of [How Windows PowerShell Works](http://msdn.microsoft.com/en-us/ced30e23-10af-4700-8933-49873bd84d58).</span></span> <span data-ttu-id="07f51-151">Un proveedor de elementos de Windows PowerShell debe comprobar la validez sintáctica y semántica de cualquier ruta de acceso pasado a él mediante la implementación de la [System.Management.Automation.Provider.Itemcmdletprovider.Isvalidpath\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.IsValidPath) método.</span><span class="sxs-lookup"><span data-stu-id="07f51-151">An Windows PowerShell item provider must verify the syntactic and semantic validity of any path passed to it by implementing the [System.Management.Automation.Provider.Itemcmdletprovider.Isvalidpath\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.IsValidPath) method.</span></span> <span data-ttu-id="07f51-152">Este método devuelve `true` si la ruta de acceso es válido, y `false` en caso contrario.</span><span class="sxs-lookup"><span data-stu-id="07f51-152">This method returns `true` if the path is valid, and `false` otherwise.</span></span> <span data-ttu-id="07f51-153">Ser consciente de que la implementación de este método no debe comprobar la existencia del elemento en la ruta de acceso, pero solo que la ruta de acceso es sintácticamente y correctos semánticamente.</span><span class="sxs-lookup"><span data-stu-id="07f51-153">Be aware that the implementation of this method should not verify the existence of the item at the path, but only that the path is syntactically and semantically correct.</span></span>
<span data-ttu-id="07f51-154">Cuando se busca un elemento de datos, el tiempo de ejecución de Windows PowerShell proporciona una ruta de acceso de Windows PowerShell para el proveedor, tal como se define en la sección "Conceptos de PSPath" de [cómo Windows PowerShell funciona](http://msdn.microsoft.com/en-us/ced30e23-10af-4700-8933-49873bd84d58).</span><span class="sxs-lookup"><span data-stu-id="07f51-154">When looking for an item of data, the Windows PowerShell runtime furnishes a Windows PowerShell path to the provider, as defined in the "PSPath Concepts" section of [How Windows PowerShell Works](http://msdn.microsoft.com/en-us/ced30e23-10af-4700-8933-49873bd84d58).</span></span> <span data-ttu-id="07f51-155">Un proveedor de elementos de Windows PowerShell debe comprobar la validez sintáctica y semántica de cualquier ruta de acceso pasado a él mediante la implementación de la [System.Management.Automation.Provider.Itemcmdletprovider.Isvalidpath\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.IsValidPath) método.</span><span class="sxs-lookup"><span data-stu-id="07f51-155">An Windows PowerShell item provider must verify the syntactic and semantic validity of any path passed to it by implementing the [System.Management.Automation.Provider.Itemcmdletprovider.Isvalidpath\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.IsValidPath) method.</span></span> <span data-ttu-id="07f51-156">Este método devuelve `true` si la ruta de acceso es válido, y `false` en caso contrario.</span><span class="sxs-lookup"><span data-stu-id="07f51-156">This method returns `true` if the path is valid, and `false` otherwise.</span></span> <span data-ttu-id="07f51-157">Ser consciente de que la implementación de este método no debe comprobar la existencia del elemento en la ruta de acceso, pero solo que la ruta de acceso es sintácticamente y correctos semánticamente.</span><span class="sxs-lookup"><span data-stu-id="07f51-157">Be aware that the implementation of this method should not verify the existence of the item at the path, but only that the path is syntactically and semantically correct.</span></span>

<span data-ttu-id="07f51-158">Esta es la implementación de la [System.Management.Automation.Provider.Itemcmdletprovider.Isvalidpath\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.IsValidPath) método para este proveedor.</span><span class="sxs-lookup"><span data-stu-id="07f51-158">Here is the implementation of the [System.Management.Automation.Provider.Itemcmdletprovider.Isvalidpath\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.IsValidPath) method for this provider.</span></span> <span data-ttu-id="07f51-159">Tenga en cuenta que esta implementación llama a un método de aplicación auxiliar de NormalizePath para convertir todos los separadores en la ruta de acceso a una uniforme.</span><span class="sxs-lookup"><span data-stu-id="07f51-159">Note that this implementation calls a NormalizePath helper method to convert all separators in the path to a uniform one.</span></span>

[!code-csharp[AccessDBProviderSample03.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample03/AccessDBProviderSample03.cs#L274-L298 "AccessDBProviderSample03.cs")]

## <a name="determining-if-an-item-exists"></a><span data-ttu-id="07f51-160">Determinar si existe un elemento</span><span class="sxs-lookup"><span data-stu-id="07f51-160">Determining if an Item Exists</span></span>

<span data-ttu-id="07f51-161">Después de comprobar la ruta de acceso, el tiempo de ejecución de Windows PowerShell debe determinar si existe un elemento de datos en esa ruta de acceso.</span><span class="sxs-lookup"><span data-stu-id="07f51-161">After verifying the path, the Windows PowerShell runtime must determine if an item of data exists at that path.</span></span> <span data-ttu-id="07f51-162">Para admitir este tipo de consulta, el proveedor de elementos de Windows PowerShell implementa la [System.Management.Automation.Provider.Itemcmdletprovider.Itemexists\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists) método.</span><span class="sxs-lookup"><span data-stu-id="07f51-162">To support this type of query, the Windows PowerShell item provider implements the [System.Management.Automation.Provider.Itemcmdletprovider.Itemexists\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists) method.</span></span> <span data-ttu-id="07f51-163">Este método devuelve `true` un elemento se encuentra en la ruta de acceso especificada y `false` (predeterminado) en caso contrario.</span><span class="sxs-lookup"><span data-stu-id="07f51-163">This method returns `true` an item is found at the specified path and `false` (default) otherwise.</span></span>

<span data-ttu-id="07f51-164">Esta es la implementación de la [System.Management.Automation.Provider.Itemcmdletprovider.Itemexists\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists) método para este proveedor.</span><span class="sxs-lookup"><span data-stu-id="07f51-164">Here is the implementation of the [System.Management.Automation.Provider.Itemcmdletprovider.Itemexists\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists) method for this provider.</span></span> <span data-ttu-id="07f51-165">Tenga en cuenta que este método llama a los métodos auxiliares PathIsDrive ChunkPath y GetTable y DatabaseTableInfo objeto definido por el usa un proveedor.</span><span class="sxs-lookup"><span data-stu-id="07f51-165">Note that this method calls the PathIsDrive, ChunkPath, and GetTable helper methods, and uses a provider defined DatabaseTableInfo object.</span></span>

[!code-csharp[AccessDBProviderSample03.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample03/AccessDBProviderSample03.cs#L229-L267 "AccessDBProviderSample03.cs")]

#### <a name="things-to-remember-about-implementing-itemexists"></a><span data-ttu-id="07f51-166">Cosas que recordar acerca de cómo implementar ItemExists</span><span class="sxs-lookup"><span data-stu-id="07f51-166">Things to Remember About Implementing ItemExists</span></span>

<span data-ttu-id="07f51-167">Las siguientes condiciones pueden aplicarse a la implementación de [System.Management.Automation.Provider.Itemcmdletprovider.Itemexists\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists):</span><span class="sxs-lookup"><span data-stu-id="07f51-167">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Itemcmdletprovider.Itemexists\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists):</span></span>

- <span data-ttu-id="07f51-168">Al definir la clase de proveedor, un proveedor de elementos de Windows PowerShell puede declarar las capacidades del proveedor de ExpandWildcards, filtro, Include o Exclude, desde el [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities)enumeración.</span><span class="sxs-lookup"><span data-stu-id="07f51-168">When defining the provider class, a Windows PowerShell item provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="07f51-169">En estos casos, la implementación de la [System.Management.Automation.Provider.Itemcmdletprovider.Itemexists\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists) método debe asegurarse de que la ruta de acceso que se pasa al método cumple los requisitos de las funciones especificadas.</span><span class="sxs-lookup"><span data-stu-id="07f51-169">In these cases, the implementation of the [System.Management.Automation.Provider.Itemcmdletprovider.Itemexists\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists) method must ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="07f51-170">Para ello, el método debe tener acceso a la propiedad adecuada, por ejemplo, el [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) y [ System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) propiedades.</span><span class="sxs-lookup"><span data-stu-id="07f51-170">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="07f51-171">La implementación de este método debe controlar cualquier forma de acceso al elemento que podría hacer que el elemento visible para el usuario.</span><span class="sxs-lookup"><span data-stu-id="07f51-171">The implementation of this method should handle any form of access to the item that might make the item visible to the user.</span></span> <span data-ttu-id="07f51-172">Por ejemplo, si un usuario tiene acceso de escritura a un archivo mediante el proveedor FileSystem (proporcionado por Windows PowerShell), pero no el acceso de lectura, el archivo sigue existiendo y [System.Management.Automation.Provider.Itemcmdletprovider.Itemexists\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists) devuelve `true`.</span><span class="sxs-lookup"><span data-stu-id="07f51-172">For example, if a user has write access to a file through the FileSystem provider (supplied by Windows PowerShell), but not read access, the file still exists and [System.Management.Automation.Provider.Itemcmdletprovider.Itemexists\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists) returns `true`.</span></span> <span data-ttu-id="07f51-173">Su implementación podría requerir la comprobación de un elemento primario para ver si el elemento secundario se puede enumerar.</span><span class="sxs-lookup"><span data-stu-id="07f51-173">Your implementation might require checking a parent item to see if the child item can be enumerated.</span></span>

## <a name="attaching-dynamic-parameters-to-the-test-path-cmdlet"></a><span data-ttu-id="07f51-174">Asociar los parámetros dinámicos para el Cmdlet Test-Path</span><span class="sxs-lookup"><span data-stu-id="07f51-174">Attaching Dynamic Parameters to the Test-Path Cmdlet</span></span>

<span data-ttu-id="07f51-175">A veces la `Test-Path` cmdlet que llama a [System.Management.Automation.Provider.Itemcmdletprovider.Itemexists\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists) requiere parámetros adicionales que se especifican de forma dinámica en tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="07f51-175">Sometimes the `Test-Path` cmdlet that calls [System.Management.Automation.Provider.Itemcmdletprovider.Itemexists\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists) requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="07f51-176">Para proporcionar estos parámetros dinámicos de Windows PowerShell debe implementar el proveedor de elementos de la [System.Management.Automation.Provider.Itemcmdletprovider.Itemexistsdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExistsDynamicParameters) método.</span><span class="sxs-lookup"><span data-stu-id="07f51-176">To provide these dynamic parameters the Windows PowerShell item provider must implement the [System.Management.Automation.Provider.Itemcmdletprovider.Itemexistsdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExistsDynamicParameters) method.</span></span> <span data-ttu-id="07f51-177">Este método recupera los parámetros dinámicos para el elemento situado en la ruta de acceso indicada y devuelve un objeto que tiene las propiedades y campos con atributos similares a una clase de cmdlet de análisis o un [ System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) objeto.</span><span class="sxs-lookup"><span data-stu-id="07f51-177">This method retrieves the dynamic parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="07f51-178">El tiempo de ejecución de Windows PowerShell usa el objeto devuelto para agregar los parámetros para el `Test-Path` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="07f51-178">The Windows PowerShell runtime uses the returned object to add the parameters to the `Test-Path` cmdlet.</span></span>

<span data-ttu-id="07f51-179">Este proveedor de elementos de Windows PowerShell no implementa este método.</span><span class="sxs-lookup"><span data-stu-id="07f51-179">This Windows PowerShell item provider does not implement this method.</span></span> <span data-ttu-id="07f51-180">Sin embargo, el código siguiente es la implementación predeterminada de este método.</span><span class="sxs-lookup"><span data-stu-id="07f51-180">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovideritemexistdynamicparameters](Msh_samplestestcmdlets#testprovideritemexistdynamicparameters)]  -->

## <a name="retrieving-an-item"></a><span data-ttu-id="07f51-181">Recuperación de un elemento</span><span class="sxs-lookup"><span data-stu-id="07f51-181">Retrieving an Item</span></span>

<span data-ttu-id="07f51-182">Para recuperar un elemento, debe invalidar el proveedor de elementos de Windows PowerShell [System.Management.Automation.Provider.Itemcmdletprovider.Getitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem) método para admitir llamadas desde el `Get-Item` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="07f51-182">To retrieve an item, the Windows PowerShell item provider must override [System.Management.Automation.Provider.Itemcmdletprovider.Getitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem) method to support calls from the `Get-Item` cmdlet.</span></span> <span data-ttu-id="07f51-183">Este método escribe el elemento con el [System.Management.Automation.Provider.Cmdletprovider.Writeitemobject\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteItemObject) método.</span><span class="sxs-lookup"><span data-stu-id="07f51-183">This method writes the item using the [System.Management.Automation.Provider.Cmdletprovider.Writeitemobject\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteItemObject) method.</span></span>

<span data-ttu-id="07f51-184">Esta es la implementación de la [System.Management.Automation.Provider.Itemcmdletprovider.Getitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem) método para este proveedor.</span><span class="sxs-lookup"><span data-stu-id="07f51-184">Here is the implementation of the [System.Management.Automation.Provider.Itemcmdletprovider.Getitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem) method for this provider.</span></span> <span data-ttu-id="07f51-185">Tenga en cuenta que este método utiliza los métodos auxiliares GetTable y GetRow para recuperar los elementos que son las filas de una tabla de datos o tablas en la base de datos de Access.</span><span class="sxs-lookup"><span data-stu-id="07f51-185">Note that this method uses the GetTable and GetRow helper methods to retrieve items that are either tables in the Access database or rows in a data table.</span></span>

[!code-csharp[AccessDBProviderSample03.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample03/AccessDBProviderSample03.cs#L132-L163 "AccessDBProviderSample03.cs")]

#### <a name="things-to-remember-about-implementing-getitem"></a><span data-ttu-id="07f51-186">Cosas que recordar acerca de cómo implementar GetItem</span><span class="sxs-lookup"><span data-stu-id="07f51-186">Things to Remember About Implementing GetItem</span></span>

<span data-ttu-id="07f51-187">Las siguientes condiciones pueden aplicarse a una implementación de [System.Management.Automation.Provider.Itemcmdletprovider.Getitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem):</span><span class="sxs-lookup"><span data-stu-id="07f51-187">The following conditions may apply to an implementation of [System.Management.Automation.Provider.Itemcmdletprovider.Getitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem):</span></span>

- <span data-ttu-id="07f51-188">Al definir la clase de proveedor, un proveedor de elementos de Windows PowerShell puede declarar las capacidades del proveedor de ExpandWildcards, filtro, Include o Exclude, desde el [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities)enumeración.</span><span class="sxs-lookup"><span data-stu-id="07f51-188">When defining the provider class, a Windows PowerShell item provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="07f51-189">En estos casos, la implementación de [System.Management.Automation.Provider.Itemcmdletprovider.Getitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem) debe asegurarse de que la ruta de acceso que se pasa al método cumple esos requisitos.</span><span class="sxs-lookup"><span data-stu-id="07f51-189">In these cases, the implementation of [System.Management.Automation.Provider.Itemcmdletprovider.Getitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem) must ensure that the path passed to the method meets those requirements.</span></span> <span data-ttu-id="07f51-190">Para ello, el método debe tener acceso a la propiedad adecuada, por ejemplo, el [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) y [ System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) propiedades.</span><span class="sxs-lookup"><span data-stu-id="07f51-190">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="07f51-191">De forma predeterminada, las invalidaciones de este método no deben recuperar los objetos que se ocultan generalmente el usuario a menos que el [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) propiedad está establecida en `true`.</span><span class="sxs-lookup"><span data-stu-id="07f51-191">By default, overrides of this method should not retrieve objects that are generally hidden from the user unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="07f51-192">Por ejemplo, el [System.Management.Automation.Provider.Itemcmdletprovider.Getitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem) método para las comprobaciones de proveedor del sistema de archivos la [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) propiedad antes de intentar llamar a [System.Management.Automation.Provider.Cmdletprovider.Writeitemobject\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteItemObject) ocultos o archivos del sistema.</span><span class="sxs-lookup"><span data-stu-id="07f51-192">For example, the [System.Management.Automation.Provider.Itemcmdletprovider.Getitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem) method for the FileSystem provider checks the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property before it attempts to call [System.Management.Automation.Provider.Cmdletprovider.Writeitemobject\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteItemObject) for hidden or system files.</span></span>

## <a name="attaching-dynamic-parameters-to-the-get-item-cmdlet"></a><span data-ttu-id="07f51-193">Asociar los parámetros dinámicos al Cmdlet Get-Item</span><span class="sxs-lookup"><span data-stu-id="07f51-193">Attaching Dynamic Parameters to the Get-Item Cmdlet</span></span>

<span data-ttu-id="07f51-194">A veces la `Get-Item` cmdlet requiere parámetros adicionales que se especifican de forma dinámica en tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="07f51-194">Sometimes the `Get-Item` cmdlet requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="07f51-195">Para proporcionar estos parámetros dinámicos de Windows PowerShell debe implementar el proveedor de elementos de la [System.Management.Automation.Provider.Itemcmdletprovider.Getitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItemDynamicParameters) método.</span><span class="sxs-lookup"><span data-stu-id="07f51-195">To provide these dynamic parameters the Windows PowerShell item provider must implement the [System.Management.Automation.Provider.Itemcmdletprovider.Getitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItemDynamicParameters) method.</span></span> <span data-ttu-id="07f51-196">Este método recupera los parámetros dinámicos para el elemento situado en la ruta de acceso indicada y devuelve un objeto que tiene las propiedades y campos con atributos similares a una clase de cmdlet de análisis o un [ System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) objeto.</span><span class="sxs-lookup"><span data-stu-id="07f51-196">This method retrieves the dynamic parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="07f51-197">El tiempo de ejecución de Windows PowerShell usa el objeto devuelto para agregar los parámetros para el `Get-Item` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="07f51-197">The Windows PowerShell runtime uses the returned object to add the parameters to the `Get-Item` cmdlet.</span></span>

<span data-ttu-id="07f51-198">Este proveedor no implementa este método.</span><span class="sxs-lookup"><span data-stu-id="07f51-198">This provider does not implement this method.</span></span> <span data-ttu-id="07f51-199">Sin embargo, el código siguiente es la implementación predeterminada de este método.</span><span class="sxs-lookup"><span data-stu-id="07f51-199">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidergetitemdynamicparameters](Msh_samplestestcmdlets#testprovidergetitemdynamicparameters)]  -->

## <a name="setting-an-item"></a><span data-ttu-id="07f51-200">Definición de un elemento</span><span class="sxs-lookup"><span data-stu-id="07f51-200">Setting an Item</span></span>

<span data-ttu-id="07f51-201">Para establecer un elemento, debe invalidar el proveedor de elementos de Windows PowerShell la [System.Management.Automation.Provider.Itemcmdletprovider.Setitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItem) método para admitir llamadas desde el `Set-Item` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="07f51-201">To set an item, the Windows PowerShell item provider must override the [System.Management.Automation.Provider.Itemcmdletprovider.Setitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItem) method to support calls from the `Set-Item` cmdlet.</span></span> <span data-ttu-id="07f51-202">Este método establece el valor del elemento en la ruta de acceso especificada.</span><span class="sxs-lookup"><span data-stu-id="07f51-202">This method sets the value of the item at the specified path.</span></span>

<span data-ttu-id="07f51-203">Este proveedor no proporciona una invalidación para el [System.Management.Automation.Provider.Itemcmdletprovider.Setitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItem) método.</span><span class="sxs-lookup"><span data-stu-id="07f51-203">This provider does not provide an override for the  [System.Management.Automation.Provider.Itemcmdletprovider.Setitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItem) method.</span></span> <span data-ttu-id="07f51-204">Sin embargo, la siguiente es la implementación predeterminada de este método.</span><span class="sxs-lookup"><span data-stu-id="07f51-204">However, the following is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidersetitem](Msh_samplestestcmdlets#testprovidersetitem)]  -->

#### <a name="things-to-remember-about-implementing-setitem"></a><span data-ttu-id="07f51-205">Cosas que recordar acerca de cómo implementar SetItem</span><span class="sxs-lookup"><span data-stu-id="07f51-205">Things to Remember About Implementing SetItem</span></span>

<span data-ttu-id="07f51-206">Las siguientes condiciones pueden aplicarse a la implementación de [System.Management.Automation.Provider.Itemcmdletprovider.Setitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItem):</span><span class="sxs-lookup"><span data-stu-id="07f51-206">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Itemcmdletprovider.Setitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItem):</span></span>

- <span data-ttu-id="07f51-207">Al definir la clase de proveedor, un proveedor de elementos de Windows PowerShell puede declarar las capacidades del proveedor de ExpandWildcards, filtro, Include o Exclude, desde el [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities)enumeración.</span><span class="sxs-lookup"><span data-stu-id="07f51-207">When defining the provider class, a Windows PowerShell item provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="07f51-208">En estos casos, la implementación de [System.Management.Automation.Provider.Itemcmdletprovider.Setitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItem) debe asegurarse de que la ruta de acceso que se pasa al método cumple esos requisitos.</span><span class="sxs-lookup"><span data-stu-id="07f51-208">In these cases, the implementation of [System.Management.Automation.Provider.Itemcmdletprovider.Setitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItem) must ensure that the path passed to the method meets those requirements.</span></span> <span data-ttu-id="07f51-209">Para ello, el método debe tener acceso a la propiedad adecuada, por ejemplo, el [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) y [ System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) propiedades.</span><span class="sxs-lookup"><span data-stu-id="07f51-209">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="07f51-210">De forma predeterminada, las invalidaciones de este método no deben establecer o escribir en objetos que se ocultan al usuario a menos que el [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) propiedad está establecida en `true`.</span><span class="sxs-lookup"><span data-stu-id="07f51-210">By default, overrides of this method should not set or write objects that are hidden from the user unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="07f51-211">Se debe enviar un error en la [System.Management.Automation.Provider.Cmdletprovider.Writeerror\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteError) método si la ruta de acceso representa un elemento oculto y [ System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) está establecido en `false`.</span><span class="sxs-lookup"><span data-stu-id="07f51-211">An error should be sent to the [System.Management.Automation.Provider.Cmdletprovider.Writeerror\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteError) method if the path represents a hidden item and [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) is set to `false`.</span></span>

- <span data-ttu-id="07f51-212">La implementación de la [System.Management.Automation.Provider.Itemcmdletprovider.Setitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItem) debe llamar al método [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess)y comprobar su valor devuelto antes de realizar cualquier cambio en el almacén de datos.</span><span class="sxs-lookup"><span data-stu-id="07f51-212">Your implementation of the [System.Management.Automation.Provider.Itemcmdletprovider.Setitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItem) method should call [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and verify its return value before making any changes to the data store.</span></span> <span data-ttu-id="07f51-213">Este método se utiliza para confirmar la ejecución de una operación cuando se realiza un cambio en el almacén de datos, por ejemplo, eliminar archivos.</span><span class="sxs-lookup"><span data-stu-id="07f51-213">This method is used to confirm execution of an operation when a change is made to the data store, for example, deleting files.</span></span> <span data-ttu-id="07f51-214">El [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) método envía el nombre del recurso que se puede cambiar con el tiempo de ejecución de Windows PowerShell teniendo en cuenta cualquier configuración de línea de comandos para el usuario, o variables de preferencia de determinar lo que debe mostrarse.</span><span class="sxs-lookup"><span data-stu-id="07f51-214">The [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) method sends the name of the resource to be changed to the user, with the Windows PowerShell runtime taking into account any command-line settings or preference variables in determining what should be displayed.</span></span>

  <span data-ttu-id="07f51-215">Después de llamar a [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) devuelve `true`, [System.Management.Automation.Provider.Itemcmdletprovider.Setitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItem)debe llamar al método el [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) método.</span><span class="sxs-lookup"><span data-stu-id="07f51-215">After the call to [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns `true`, the [System.Management.Automation.Provider.Itemcmdletprovider.Setitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItem) method should call the [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method.</span></span> <span data-ttu-id="07f51-216">Este método envía un mensaje al usuario para que los comentarios comprobar si debe continuarse la operación.</span><span class="sxs-lookup"><span data-stu-id="07f51-216">This method sends a message to the user to allow feedback to verify if the operation should be continued.</span></span> <span data-ttu-id="07f51-217">La llamada a [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) permite una comprobación adicional para las modificaciones del sistema potencialmente peligrosos.</span><span class="sxs-lookup"><span data-stu-id="07f51-217">The call to [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) allows an additional check for potentially dangerous system modifications.</span></span>

## <a name="retrieving-dynamic-parameters-for-setitem"></a><span data-ttu-id="07f51-218">Recuperar los parámetros dinámicos para SetItem</span><span class="sxs-lookup"><span data-stu-id="07f51-218">Retrieving Dynamic Parameters for SetItem</span></span>

<span data-ttu-id="07f51-219">A veces la `Set-Item` cmdlet requiere parámetros adicionales que se especifican de forma dinámica en tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="07f51-219">Sometimes the `Set-Item` cmdlet requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="07f51-220">Para proporcionar estos parámetros dinámicos de Windows PowerShell debe implementar el proveedor de elementos de la [System.Management.Automation.Provider.Itemcmdletprovider.Setitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItemDynamicParameters) método.</span><span class="sxs-lookup"><span data-stu-id="07f51-220">To provide these dynamic parameters the Windows PowerShell item provider must implement the [System.Management.Automation.Provider.Itemcmdletprovider.Setitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItemDynamicParameters) method.</span></span> <span data-ttu-id="07f51-221">Este método recupera los parámetros dinámicos para el elemento situado en la ruta de acceso indicada y devuelve un objeto que tiene las propiedades y campos con atributos similares a una clase de cmdlet de análisis o un [ System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) objeto.</span><span class="sxs-lookup"><span data-stu-id="07f51-221">This method retrieves the dynamic parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="07f51-222">El tiempo de ejecución de Windows PowerShell usa el objeto devuelto para agregar los parámetros para el `Set-Item` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="07f51-222">The Windows PowerShell runtime uses the returned object to add the parameters to the `Set-Item` cmdlet.</span></span>

<span data-ttu-id="07f51-223">Este proveedor no implementa este método.</span><span class="sxs-lookup"><span data-stu-id="07f51-223">This provider does not implement this method.</span></span> <span data-ttu-id="07f51-224">Sin embargo, el código siguiente es la implementación predeterminada de este método.</span><span class="sxs-lookup"><span data-stu-id="07f51-224">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidersetitemdynamicparameters](Msh_samplestestcmdlets#testprovidersetitemdynamicparameters)]  -->

## <a name="clearing-an-item"></a><span data-ttu-id="07f51-225">Borrar un elemento</span><span class="sxs-lookup"><span data-stu-id="07f51-225">Clearing an Item</span></span>

<span data-ttu-id="07f51-226">Para borrar un elemento, el proveedor de elementos de Windows PowerShell implementa la [System.Management.Automation.Provider.Itemcmdletprovider.Clearitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ClearItem) método para admitir llamadas desde el `Clear-Item` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="07f51-226">To clear an item, the Windows PowerShell item provider implements the [System.Management.Automation.Provider.Itemcmdletprovider.Clearitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ClearItem) method to support calls from the `Clear-Item` cmdlet.</span></span> <span data-ttu-id="07f51-227">Este método borra el elemento de datos en la ruta especificada.</span><span class="sxs-lookup"><span data-stu-id="07f51-227">This method erases the data item at the specified path.</span></span>

<span data-ttu-id="07f51-228">Este proveedor no implementa este método.</span><span class="sxs-lookup"><span data-stu-id="07f51-228">This provider does not implement this method.</span></span> <span data-ttu-id="07f51-229">Sin embargo, el código siguiente es la implementación predeterminada de este método.</span><span class="sxs-lookup"><span data-stu-id="07f51-229">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testproviderclearitem](Msh_samplestestcmdlets#testproviderclearitem)]  -->

#### <a name="things-to-remember-about-implementing-clearitem"></a><span data-ttu-id="07f51-230">Cosas que recordar acerca de cómo implementar ClearItem</span><span class="sxs-lookup"><span data-stu-id="07f51-230">Things to Remember About Implementing ClearItem</span></span>

<span data-ttu-id="07f51-231">Las siguientes condiciones pueden aplicarse a una implementación de [System.Management.Automation.Provider.Itemcmdletprovider.Clearitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ClearItem):</span><span class="sxs-lookup"><span data-stu-id="07f51-231">The following conditions may apply to an implementation of [System.Management.Automation.Provider.Itemcmdletprovider.Clearitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ClearItem):</span></span>

- <span data-ttu-id="07f51-232">Al definir la clase de proveedor, un proveedor de elementos de Windows PowerShell puede declarar las capacidades del proveedor de ExpandWildcards, filtro, Include o Exclude, desde el [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities)enumeración.</span><span class="sxs-lookup"><span data-stu-id="07f51-232">When defining the provider class, a Windows PowerShell item provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="07f51-233">En estos casos, la implementación de [System.Management.Automation.Provider.Itemcmdletprovider.Clearitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ClearItem) debe asegurarse de que la ruta de acceso que se pasa al método cumple esos requisitos.</span><span class="sxs-lookup"><span data-stu-id="07f51-233">In these cases, the implementation of [System.Management.Automation.Provider.Itemcmdletprovider.Clearitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ClearItem) must ensure that the path passed to the method meets those requirements.</span></span> <span data-ttu-id="07f51-234">Para ello, el método debe tener acceso a la propiedad adecuada, por ejemplo, el [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) y [ System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) propiedades.</span><span class="sxs-lookup"><span data-stu-id="07f51-234">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="07f51-235">De forma predeterminada, las invalidaciones de este método no deben establecer o escribir en objetos que se ocultan al usuario a menos que el [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) propiedad está establecida en `true`.</span><span class="sxs-lookup"><span data-stu-id="07f51-235">By default, overrides of this method should not set or write objects that are hidden from the user unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="07f51-236">Se debe enviar un error en la [System.Management.Automation.Provider.Cmdletprovider.Writeerror\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteError) método si la ruta de acceso representa un elemento que se oculta al usuario y [ System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) está establecido en `false`.</span><span class="sxs-lookup"><span data-stu-id="07f51-236">An error should be sent to the [System.Management.Automation.Provider.Cmdletprovider.Writeerror\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteError) method if the path represents an item that is hidden from the user and [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) is set to `false`.</span></span>

- <span data-ttu-id="07f51-237">La implementación de la [System.Management.Automation.Provider.Itemcmdletprovider.Setitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItem) debe llamar al método [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess)y comprobar su valor devuelto antes de realizar cualquier cambio en el almacén de datos.</span><span class="sxs-lookup"><span data-stu-id="07f51-237">Your implementation of the [System.Management.Automation.Provider.Itemcmdletprovider.Setitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItem) method should call [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and verify its return value before making any changes to the data store.</span></span> <span data-ttu-id="07f51-238">Este método se utiliza para confirmar la ejecución de una operación cuando se realiza un cambio en el almacén de datos, por ejemplo, eliminar archivos.</span><span class="sxs-lookup"><span data-stu-id="07f51-238">This method is used to confirm execution of an operation when a change is made to the data store, for example, deleting files.</span></span> <span data-ttu-id="07f51-239">El [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) método envía el nombre del recurso que se puede cambiar para el usuario, con el tiempo de ejecución de Windows PowerShell y controlar cualquier configuración de línea de comandos o la preferencia variables de determinar lo que debe mostrarse.</span><span class="sxs-lookup"><span data-stu-id="07f51-239">The [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) method sends the name of the resource to be changed to the user, with the Windows PowerShell runtime and handle any command-line settings or preference variables in determining what should be displayed.</span></span>

  <span data-ttu-id="07f51-240">Después de llamar a [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) devuelve `true`, [System.Management.Automation.Provider.Itemcmdletprovider.Setitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItem)debe llamar al método el [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) método.</span><span class="sxs-lookup"><span data-stu-id="07f51-240">After the call to [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns `true`, the [System.Management.Automation.Provider.Itemcmdletprovider.Setitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.SetItem) method should call the [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method.</span></span> <span data-ttu-id="07f51-241">Este método envía un mensaje al usuario para que los comentarios comprobar si debe continuarse la operación.</span><span class="sxs-lookup"><span data-stu-id="07f51-241">This method sends a message to the user to allow feedback to verify if the operation should be continued.</span></span> <span data-ttu-id="07f51-242">La llamada a [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) permite una comprobación adicional para las modificaciones del sistema potencialmente peligrosos.</span><span class="sxs-lookup"><span data-stu-id="07f51-242">The call to [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) allows an additional check for potentially dangerous system modifications.</span></span>

## <a name="retrieve-dynamic-parameters-for-clearitem"></a><span data-ttu-id="07f51-243">Recuperar los parámetros dinámicos para ClearItem</span><span class="sxs-lookup"><span data-stu-id="07f51-243">Retrieve Dynamic Parameters for ClearItem</span></span>

<span data-ttu-id="07f51-244">A veces la `Clear-Item` cmdlet requiere parámetros adicionales que se especifican de forma dinámica en tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="07f51-244">Sometimes the `Clear-Item` cmdlet requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="07f51-245">Para proporcionar estos parámetros dinámicos de Windows PowerShell debe implementar el proveedor de elementos de la [System.Management.Automation.Provider.Itemcmdletprovider.Clearitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ClearItemDynamicParameters) método.</span><span class="sxs-lookup"><span data-stu-id="07f51-245">To provide these dynamic parameters the Windows PowerShell item provider must implement the [System.Management.Automation.Provider.Itemcmdletprovider.Clearitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ClearItemDynamicParameters) method.</span></span> <span data-ttu-id="07f51-246">Este método recupera los parámetros dinámicos para el elemento situado en la ruta de acceso indicada y devuelve un objeto que tiene las propiedades y campos con atributos similares a una clase de cmdlet de análisis o un [ System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) objeto.</span><span class="sxs-lookup"><span data-stu-id="07f51-246">This method retrieves the dynamic parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="07f51-247">El tiempo de ejecución de Windows PowerShell usa el objeto devuelto para agregar los parámetros para el `Clear-Item` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="07f51-247">The Windows PowerShell runtime uses the returned object to add the parameters to the `Clear-Item` cmdlet.</span></span>

<span data-ttu-id="07f51-248">Este proveedor de elementos no implementa este método.</span><span class="sxs-lookup"><span data-stu-id="07f51-248">This item provider does not implement this method.</span></span> <span data-ttu-id="07f51-249">Sin embargo, el código siguiente es la implementación predeterminada de este método.</span><span class="sxs-lookup"><span data-stu-id="07f51-249">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testproviderclearitemdynamicparameters](Msh_samplestestcmdlets#testproviderclearitemdynamicparameters)]  -->

## <a name="performing-a-default-action-for-an-item"></a><span data-ttu-id="07f51-250">Llevar a cabo una acción predeterminada para un elemento</span><span class="sxs-lookup"><span data-stu-id="07f51-250">Performing a Default Action for an Item</span></span>

<span data-ttu-id="07f51-251">Puede implementar un proveedor de elementos de Windows PowerShell la [System.Management.Automation.Provider.Itemcmdletprovider.Invokedefaultaction\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.InvokeDefaultAction) método para admitir llamadas desde el `Invoke-Item` cmdlet, que permite al proveedor a realizar una acción predeterminada para el elemento situado en la ruta de acceso especificada.</span><span class="sxs-lookup"><span data-stu-id="07f51-251">A Windows PowerShell item provider can implement the [System.Management.Automation.Provider.Itemcmdletprovider.Invokedefaultaction\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.InvokeDefaultAction) method to support calls from the `Invoke-Item` cmdlet, which allows the provider to perform a default action for the item at the specified path.</span></span> <span data-ttu-id="07f51-252">Por ejemplo, el proveedor FileSystem podría usar este método para llamar a ShellExecute para un elemento específico.</span><span class="sxs-lookup"><span data-stu-id="07f51-252">For example, the FileSystem provider might use this method to call ShellExecute for a specific item.</span></span>

<span data-ttu-id="07f51-253">Este proveedor no implementa este método.</span><span class="sxs-lookup"><span data-stu-id="07f51-253">This provider does not implement this method.</span></span> <span data-ttu-id="07f51-254">Sin embargo, el código siguiente es la implementación predeterminada de este método.</span><span class="sxs-lookup"><span data-stu-id="07f51-254">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testproviderinvokedefaultaction](Msh_samplestestcmdlets#testproviderinvokedefaultaction)]  -->

#### <a name="things-to-remember-about-implementing-invokedefaultaction"></a><span data-ttu-id="07f51-255">Cosas que recordar acerca de cómo implementar InvokeDefaultAction</span><span class="sxs-lookup"><span data-stu-id="07f51-255">Things to Remember About Implementing InvokeDefaultAction</span></span>

<span data-ttu-id="07f51-256">Las siguientes condiciones pueden aplicarse a una implementación de [System.Management.Automation.Provider.Itemcmdletprovider.Invokedefaultaction\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.InvokeDefaultAction):</span><span class="sxs-lookup"><span data-stu-id="07f51-256">The following conditions may apply to an implementation of [System.Management.Automation.Provider.Itemcmdletprovider.Invokedefaultaction\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.InvokeDefaultAction):</span></span>

- <span data-ttu-id="07f51-257">Al definir la clase de proveedor, un proveedor de elementos de Windows PowerShell puede declarar las capacidades del proveedor de ExpandWildcards, filtro, Include o Exclude, desde el [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities)enumeración.</span><span class="sxs-lookup"><span data-stu-id="07f51-257">When defining the provider class, a Windows PowerShell item provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="07f51-258">En estos casos, la implementación de [System.Management.Automation.Provider.Itemcmdletprovider.Invokedefaultaction\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.InvokeDefaultAction) debe asegurarse de que la ruta de acceso que se pasa al método cumple esos requisitos.</span><span class="sxs-lookup"><span data-stu-id="07f51-258">In these cases, the implementation of [System.Management.Automation.Provider.Itemcmdletprovider.Invokedefaultaction\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.InvokeDefaultAction) must ensure that the path passed to the method meets those requirements.</span></span> <span data-ttu-id="07f51-259">Para ello, el método debe tener acceso a la propiedad adecuada, por ejemplo, el [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) y [ System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) propiedades.</span><span class="sxs-lookup"><span data-stu-id="07f51-259">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="07f51-260">De forma predeterminada, las invalidaciones de este método no deben establecer o escribir objetos ocultos al usuario a menos que el [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) propiedad está establecida en `true`.</span><span class="sxs-lookup"><span data-stu-id="07f51-260">By default, overrides of this method should not set or write objects hidden from the user unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="07f51-261">Se debe enviar un error en la [System.Management.Automation.Provider.Cmdletprovider.Writeerror\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteError) método si la ruta de acceso representa un elemento que se oculta al usuario y [ System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) está establecido en `false`.</span><span class="sxs-lookup"><span data-stu-id="07f51-261">An error should be sent to the [System.Management.Automation.Provider.Cmdletprovider.Writeerror\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteError) method if the path represents an item that is hidden from the user and [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) is set to `false`.</span></span>

## <a name="retrieve-dynamic-parameters-for-invokedefaultaction"></a><span data-ttu-id="07f51-262">Recuperar los parámetros dinámicos para InvokeDefaultAction</span><span class="sxs-lookup"><span data-stu-id="07f51-262">Retrieve Dynamic Parameters for InvokeDefaultAction</span></span>

<span data-ttu-id="07f51-263">A veces la `Invoke-Item` cmdlet requiere parámetros adicionales que se especifican de forma dinámica en tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="07f51-263">Sometimes the `Invoke-Item` cmdlet requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="07f51-264">Para proporcionar estos parámetros dinámicos de Windows PowerShell debe implementar el proveedor de elementos de la [System.Management.Automation.Provider.Itemcmdletprovider.Invokedefaultactiondynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.InvokeDefaultActionDynamicParameters) método.</span><span class="sxs-lookup"><span data-stu-id="07f51-264">To provide these dynamic parameters the Windows PowerShell item provider must implement the [System.Management.Automation.Provider.Itemcmdletprovider.Invokedefaultactiondynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.InvokeDefaultActionDynamicParameters) method.</span></span> <span data-ttu-id="07f51-265">Este método recupera los parámetros dinámicos para el elemento situado en la ruta de acceso indicada y devuelve un objeto que tiene las propiedades y campos con atributos similares a una clase de cmdlet de análisis o un [ System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) objeto.</span><span class="sxs-lookup"><span data-stu-id="07f51-265">This method retrieves the dynamic parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="07f51-266">El tiempo de ejecución de Windows PowerShell usa el objeto devuelto para agregar los parámetros dinámicos a la `Invoke-Item` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="07f51-266">The Windows PowerShell runtime uses the returned object to add the dynamic parameters to the `Invoke-Item` cmdlet.</span></span>

<span data-ttu-id="07f51-267">Este proveedor de elementos no implementa este método.</span><span class="sxs-lookup"><span data-stu-id="07f51-267">This item provider does not implement this method.</span></span> <span data-ttu-id="07f51-268">Sin embargo, el código siguiente es la implementación predeterminada de este método.</span><span class="sxs-lookup"><span data-stu-id="07f51-268">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testproviderinvokedefaultactiondynamicparameters](Msh_samplestestcmdlets#testproviderinvokedefaultactiondynamicparameters)]  -->

## <a name="implementing-helper-methods-and-classes"></a><span data-ttu-id="07f51-269">Implementación de métodos y clases auxiliares</span><span class="sxs-lookup"><span data-stu-id="07f51-269">Implementing Helper Methods and Classes</span></span>

<span data-ttu-id="07f51-270">Este proveedor de elementos implementa varios métodos auxiliares y las clases que son utilizadas por el público reemplazar métodos definidos por Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="07f51-270">This item provider implements several helper methods and classes that are used by the public override methods defined by Windows PowerShell.</span></span> <span data-ttu-id="07f51-271">El código para estas clases y métodos auxiliares se muestran en el [código de ejemplo](#Code-Sample) sección.</span><span class="sxs-lookup"><span data-stu-id="07f51-271">The code for these helper methods and classes are shown in the [Code Sample](#Code-Sample) section.</span></span>

### <a name="normalizepath-method"></a><span data-ttu-id="07f51-272">Método NormalizePath</span><span class="sxs-lookup"><span data-stu-id="07f51-272">NormalizePath Method</span></span>

<span data-ttu-id="07f51-273">Este proveedor de elementos implementa un método de aplicación auxiliar de NormalizePath para asegurarse de que la ruta de acceso tiene un formato coherente.</span><span class="sxs-lookup"><span data-stu-id="07f51-273">This item provider implements a NormalizePath helper method to ensure that the path has a consistent format.</span></span> <span data-ttu-id="07f51-274">El formato especificado usa una barra diagonal inversa (\\) como separador.</span><span class="sxs-lookup"><span data-stu-id="07f51-274">The format specified uses a backslash (\\) as a separator.</span></span>

### <a name="pathisdrive-method"></a><span data-ttu-id="07f51-275">Método PathIsDrive</span><span class="sxs-lookup"><span data-stu-id="07f51-275">PathIsDrive Method</span></span>

<span data-ttu-id="07f51-276">Este proveedor de elementos implementa un método de aplicación auxiliar de PathIsDrive para determinar si la ruta de acceso especificada es realmente el nombre de la unidad.</span><span class="sxs-lookup"><span data-stu-id="07f51-276">This item provider implements a PathIsDrive helper method to determine if the specified path is actually the drive name.</span></span>

### <a name="chunkpath-method"></a><span data-ttu-id="07f51-277">Método ChunkPath</span><span class="sxs-lookup"><span data-stu-id="07f51-277">ChunkPath Method</span></span>

<span data-ttu-id="07f51-278">Este proveedor de elementos implementa un método auxiliar ChunkPath que interrumpe la ruta de acceso especificada para que el proveedor pueda identificar sus elementos individuales.</span><span class="sxs-lookup"><span data-stu-id="07f51-278">This item provider implements a ChunkPath helper method that breaks up the specified path so that the provider can identify its individual elements.</span></span> <span data-ttu-id="07f51-279">Devuelve una matriz que se compone de los elementos de la ruta de acceso.</span><span class="sxs-lookup"><span data-stu-id="07f51-279">It returns an array composed of the path elements.</span></span>

### <a name="gettable-method"></a><span data-ttu-id="07f51-280">Método getTable</span><span class="sxs-lookup"><span data-stu-id="07f51-280">GetTable Method</span></span>

<span data-ttu-id="07f51-281">Este proveedor de elementos implementa el método auxiliar GetTables que devuelve un objeto DatabaseTableInfo que representa información acerca de la tabla especificada en la llamada.</span><span class="sxs-lookup"><span data-stu-id="07f51-281">This item provider implements the GetTables helper method that returns a DatabaseTableInfo object that represents information about the table specified in the call.</span></span>

### <a name="getrow-method"></a><span data-ttu-id="07f51-282">GetRow (método)</span><span class="sxs-lookup"><span data-stu-id="07f51-282">GetRow Method</span></span>

<span data-ttu-id="07f51-283">El [System.Management.Automation.Provider.Itemcmdletprovider.Getitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem) método del proveedor de este elemento llama al método de aplicación auxiliar de GetRows.</span><span class="sxs-lookup"><span data-stu-id="07f51-283">The [System.Management.Automation.Provider.Itemcmdletprovider.Getitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem) method of this item provider calls the GetRows helper method.</span></span> <span data-ttu-id="07f51-284">Este método auxiliar recupera un objeto DatabaseRowInfo que representa información acerca de la fila especificada en la tabla.</span><span class="sxs-lookup"><span data-stu-id="07f51-284">This helper method retrieves a DatabaseRowInfo object that represents information about the specified row in the table.</span></span>

### <a name="databasetableinfo-class"></a><span data-ttu-id="07f51-285">Clase DatabaseTableInfo</span><span class="sxs-lookup"><span data-stu-id="07f51-285">DatabaseTableInfo Class</span></span>

<span data-ttu-id="07f51-286">El proveedor de este elemento define una clase de DatabaseTableInfo que representa una colección de información en una tabla de datos en la base de datos.</span><span class="sxs-lookup"><span data-stu-id="07f51-286">This item provider defines a DatabaseTableInfo class that represents a collection of information in a data table in the database.</span></span> <span data-ttu-id="07f51-287">Esta clase es similar a la [System.IO.Directoryinfo](/dotnet/api/System.IO.DirectoryInfo) clase.</span><span class="sxs-lookup"><span data-stu-id="07f51-287">This class is similar to the [System.IO.Directoryinfo](/dotnet/api/System.IO.DirectoryInfo) class.</span></span>

<span data-ttu-id="07f51-288">El proveedor de elementos de ejemplo define un método de DatabaseTableInfo.GetTables que devuelve una colección de objetos de información de tabla define las tablas en la base de datos.</span><span class="sxs-lookup"><span data-stu-id="07f51-288">The sample item provider defines a DatabaseTableInfo.GetTables method that returns a collection of table information objects defining the tables in the database.</span></span> <span data-ttu-id="07f51-289">Este método incluye un bloque try/catch para asegurarse de que cualquier error de base de datos se muestra como una fila con las entradas de cero.</span><span class="sxs-lookup"><span data-stu-id="07f51-289">This method includes a try/catch block to ensure that any database error shows up as a row with zero entries.</span></span>

### <a name="databaserowinfo-class"></a><span data-ttu-id="07f51-290">DatabaseRowInfo Class</span><span class="sxs-lookup"><span data-stu-id="07f51-290">DatabaseRowInfo Class</span></span>

<span data-ttu-id="07f51-291">El proveedor de este elemento define la clase auxiliar DatabaseRowInfo que representa una fila en una tabla de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="07f51-291">This item provider defines the DatabaseRowInfo helper class that represents a row in a table of the database.</span></span> <span data-ttu-id="07f51-292">Esta clase es similar a la [System.IO.Fileinfo](/dotnet/api/System.IO.FileInfo) clase.</span><span class="sxs-lookup"><span data-stu-id="07f51-292">This class is similar to the [System.IO.Fileinfo](/dotnet/api/System.IO.FileInfo) class.</span></span>

<span data-ttu-id="07f51-293">El proveedor de ejemplo define un método DatabaseRowInfo.GetRows para devolver una colección de objetos de información de la fila de la tabla especificada.</span><span class="sxs-lookup"><span data-stu-id="07f51-293">The sample provider defines a DatabaseRowInfo.GetRows method to return a collection of row information objects for the specified table.</span></span> <span data-ttu-id="07f51-294">Este método incluye un bloque try/catch para capturar excepciones.</span><span class="sxs-lookup"><span data-stu-id="07f51-294">This method includes a try/catch block to trap exceptions.</span></span> <span data-ttu-id="07f51-295">No hay información de fila producirá errores.</span><span class="sxs-lookup"><span data-stu-id="07f51-295">Any errors will result in no row information.</span></span>

## <a name="code-sample"></a><span data-ttu-id="07f51-296">Ejemplo de código</span><span class="sxs-lookup"><span data-stu-id="07f51-296">Code Sample</span></span>

<span data-ttu-id="07f51-297">Para el código de ejemplo completo, vea [AccessDbProviderSample03 código de ejemplo](./accessdbprovidersample03-code-sample.md).</span><span class="sxs-lookup"><span data-stu-id="07f51-297">For complete sample code, see [AccessDbProviderSample03 Code Sample](./accessdbprovidersample03-code-sample.md).</span></span>

## <a name="defining-object-types-and-formatting"></a><span data-ttu-id="07f51-298">Definir los tipos de objeto y el formato</span><span class="sxs-lookup"><span data-stu-id="07f51-298">Defining Object Types and Formatting</span></span>

<span data-ttu-id="07f51-299">Al escribir un proveedor, puede ser necesario agregar a miembros a los objetos existentes o defina nuevos objetos.</span><span class="sxs-lookup"><span data-stu-id="07f51-299">When writing a provider, it may be necessary to add members to existing objects or define new objects.</span></span> <span data-ttu-id="07f51-300">Cuando termine, cree un archivo de tipos que puede usar Windows PowerShell para identificar a los miembros del objeto y un archivo de formato que define cómo se muestra el objeto.</span><span class="sxs-lookup"><span data-stu-id="07f51-300">When finished, create a Types file that Windows PowerShell can use to identify the members of the object and a Format file that defines how the object is displayed.</span></span> <span data-ttu-id="07f51-301">Para obtener más información, consulte [extender los tipos de objeto y formato](http://msdn.microsoft.com/en-us/da976d91-a3d6-44e8-affa-466b1e2bd351).</span><span class="sxs-lookup"><span data-stu-id="07f51-301">For more information about , see [Extending Object Types and Formatting](http://msdn.microsoft.com/en-us/da976d91-a3d6-44e8-affa-466b1e2bd351).</span></span>
<span data-ttu-id="07f51-302">Al escribir un proveedor, puede ser necesario agregar a miembros a los objetos existentes o defina nuevos objetos.</span><span class="sxs-lookup"><span data-stu-id="07f51-302">When writing a provider, it may be necessary to add members to existing objects or define new objects.</span></span> <span data-ttu-id="07f51-303">Cuando termine, cree un archivo de tipos que puede usar Windows PowerShell para identificar a los miembros del objeto y un archivo de formato que define cómo se muestra el objeto.</span><span class="sxs-lookup"><span data-stu-id="07f51-303">When finished, create a Types file that Windows PowerShell can use to identify the members of the object and a Format file that defines how the object is displayed.</span></span> <span data-ttu-id="07f51-304">Para obtener más información, consulte [extender los tipos de objeto y formato](http://msdn.microsoft.com/en-us/da976d91-a3d6-44e8-affa-466b1e2bd351).</span><span class="sxs-lookup"><span data-stu-id="07f51-304">For more information about , see [Extending Object Types and Formatting](http://msdn.microsoft.com/en-us/da976d91-a3d6-44e8-affa-466b1e2bd351).</span></span>

## <a name="building-the-windows-powershell-provider"></a><span data-ttu-id="07f51-305">Creación del proveedor de Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="07f51-305">Building the Windows PowerShell provider</span></span>

<span data-ttu-id="07f51-306">Consulte [cómo registrar Cmdlets, proveedores y aplicaciones Host](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c).</span><span class="sxs-lookup"><span data-stu-id="07f51-306">See [How to Register Cmdlets, Providers, and Host Applications](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c).</span></span>
<span data-ttu-id="07f51-307">Consulte [cómo registrar Cmdlets, proveedores y aplicaciones Host](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c).</span><span class="sxs-lookup"><span data-stu-id="07f51-307">See [How to Register Cmdlets, Providers, and Host Applications](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c).</span></span>

## <a name="testing-the-windows-powershell-provider"></a><span data-ttu-id="07f51-308">Probar el proveedor de Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="07f51-308">Testing the Windows PowerShell provider</span></span>

<span data-ttu-id="07f51-309">Cuando se registra este proveedor de elementos de Windows PowerShell con Windows PowerShell, sólo puede probar las opciones básicas y funcionalidad del proveedor de la unidad.</span><span class="sxs-lookup"><span data-stu-id="07f51-309">When this Windows PowerShell item provider is registered with Windows PowerShell, you can only test the basic and drive functionality of the provider.</span></span> <span data-ttu-id="07f51-310">Para probar la manipulación de los elementos, también debe implementar funcionalidad del contenedor se describe en [implementar un proveedor de contenedor de Windows PowerShell](./creating-a-windows-powershell-container-provider.md).</span><span class="sxs-lookup"><span data-stu-id="07f51-310">To test the manipulation of items, you must also implement container functionality described in [Implementing a Container Windows PowerShell Provider](./creating-a-windows-powershell-container-provider.md).</span></span>

## <a name="see-also"></a><span data-ttu-id="07f51-311">Véase también</span><span class="sxs-lookup"><span data-stu-id="07f51-311">See Also</span></span>

[<span data-ttu-id="07f51-312">Windows PowerShell SDK</span><span class="sxs-lookup"><span data-stu-id="07f51-312">Windows PowerShell SDK</span></span>](../windows-powershell-reference.md)

[<span data-ttu-id="07f51-313">Guía del programador de Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="07f51-313">Windows PowerShell Programmer's Guide</span></span>](./windows-powershell-programmer-s-guide.md)

[<span data-ttu-id="07f51-314">Creación de proveedores de Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="07f51-314">Creating Windows PowerShell Providers</span></span>](./how-to-create-a-windows-powershell-provider.md)

[<span data-ttu-id="07f51-315">Proveedor de PowerShell de Windows de su diseño</span><span class="sxs-lookup"><span data-stu-id="07f51-315">Designing Your Windows PowerShell provider</span></span>](./designing-your-windows-powershell-provider.md)

[<span data-ttu-id="07f51-316">Extensión de tipos de objeto y el formato</span><span class="sxs-lookup"><span data-stu-id="07f51-316">Extending Object Types and Formatting</span></span>](http://msdn.microsoft.com/en-us/da976d91-a3d6-44e8-affa-466b1e2bd351)

[<span data-ttu-id="07f51-317">Extensión de tipos de objeto y el formato</span><span class="sxs-lookup"><span data-stu-id="07f51-317">Extending Object Types and Formatting</span></span>](http://msdn.microsoft.com/en-us/da976d91-a3d6-44e8-affa-466b1e2bd351)

[<span data-ttu-id="07f51-318">Cómo funciona Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="07f51-318">How Windows PowerShell Works</span></span>](http://msdn.microsoft.com/en-us/ced30e23-10af-4700-8933-49873bd84d58)

[<span data-ttu-id="07f51-319">Cómo funciona Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="07f51-319">How Windows PowerShell Works</span></span>](http://msdn.microsoft.com/en-us/ced30e23-10af-4700-8933-49873bd84d58)

[<span data-ttu-id="07f51-320">Creación de un proveedor de contenedor Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="07f51-320">Creating a Container Windows PowerShell provider</span></span>](./creating-a-windows-powershell-container-provider.md)

[<span data-ttu-id="07f51-321">Creación de un proveedor de la unidad de Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="07f51-321">Creating a Drive Windows PowerShell provider</span></span>](./creating-a-windows-powershell-drive-provider.md)

[<span data-ttu-id="07f51-322">Cómo registrar Cmdlets, proveedores y aplicaciones Host</span><span class="sxs-lookup"><span data-stu-id="07f51-322">How to Register Cmdlets, Providers, and Host Applications</span></span>](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c)

[<span data-ttu-id="07f51-323">Cómo registrar Cmdlets, proveedores y aplicaciones Host</span><span class="sxs-lookup"><span data-stu-id="07f51-323">How to Register Cmdlets, Providers, and Host Applications</span></span>](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c)