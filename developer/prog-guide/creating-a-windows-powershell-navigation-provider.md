---
title: Creación de un proveedor de navegación de Windows PowerShell | Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- navigation providers [PowerShell Programmer's Guide]
- providers [PowerShell Programmer's Guide], navigation provider
ms.assetid: 8bd3224d-ca6f-4640-9464-cb4d9f4e13b1
caps.latest.revision: 5
ms.openlocfilehash: 066aa188d5d7dfde5af424a3bb8f15ff51c1e936
ms.sourcegitcommit: b6871f21bd666f9cd71dd336bb3f844cf472b56c
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 02/03/2019
ms.locfileid: "56856961"
---
# <a name="creating-a-windows-powershell-navigation-provider"></a><span data-ttu-id="a0d72-102">Creación de un proveedor de navegación de Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="a0d72-102">Creating a Windows PowerShell Navigation Provider</span></span>

<span data-ttu-id="a0d72-103">Este tema describe cómo crear un proveedor de navegación de Windows PowerShell que puede navegar por el almacén de datos.</span><span class="sxs-lookup"><span data-stu-id="a0d72-103">This topic describes how to create a Windows PowerShell navigation provider that can navigate the data store.</span></span> <span data-ttu-id="a0d72-104">Este tipo de proveedor es compatible con comandos recursivos, los contenedores anidados y rutas de acceso relativas.</span><span class="sxs-lookup"><span data-stu-id="a0d72-104">This type of provider supports recursive commands, nested containers, and relative paths.</span></span>

> [!NOTE]
> <span data-ttu-id="a0d72-105">Puede descargar el C# (AccessDBSampleProvider05.cs) de archivo de código fuente para este proveedor mediante el Microsoft Windows Software Development Kit para Windows Vista y .NET Framework 3.0 Runtime Components.</span><span class="sxs-lookup"><span data-stu-id="a0d72-105">You can download the C# source file (AccessDBSampleProvider05.cs) for this provider using the Microsoft Windows Software Development Kit for Windows Vista and .NET Framework 3.0 Runtime Components.</span></span> <span data-ttu-id="a0d72-106">Para obtener instrucciones de descarga, vea [cómo instalar Windows PowerShell y descarga el SDK de Windows PowerShell](/powershell/developer/installing-the-windows-powershell-sdk).</span><span class="sxs-lookup"><span data-stu-id="a0d72-106">For download instructions, see [How to Install Windows PowerShell and Download the Windows PowerShell SDK](/powershell/developer/installing-the-windows-powershell-sdk).</span></span>
> <span data-ttu-id="a0d72-107">Puede descargar el C# (AccessDBSampleProvider05.cs) de archivo de código fuente para este proveedor mediante el Microsoft Windows Software Development Kit para Windows Vista y .NET Framework 3.0 Runtime Components.</span><span class="sxs-lookup"><span data-stu-id="a0d72-107">You can download the C# source file (AccessDBSampleProvider05.cs) for this provider using the Microsoft Windows Software Development Kit for Windows Vista and .NET Framework 3.0 Runtime Components.</span></span> <span data-ttu-id="a0d72-108">Para obtener instrucciones de descarga, vea [cómo instalar Windows PowerShell y descarga el SDK de Windows PowerShell](/powershell/developer/installing-the-windows-powershell-sdk).</span><span class="sxs-lookup"><span data-stu-id="a0d72-108">For download instructions, see [How to Install Windows PowerShell and Download the Windows PowerShell SDK](/powershell/developer/installing-the-windows-powershell-sdk).</span></span>
>
> <span data-ttu-id="a0d72-109">Están disponibles en los archivos de origen descargado el  **\<ejemplos de PowerShell >** directory.</span><span class="sxs-lookup"><span data-stu-id="a0d72-109">The downloaded source files are available in the **\<PowerShell Samples>** directory.</span></span>
>
> <span data-ttu-id="a0d72-110">Para obtener más información acerca de otras implementaciones del proveedor de Windows PowerShell, consulte [diseñar su proveedor de Windows PowerShell](./designing-your-windows-powershell-provider.md).</span><span class="sxs-lookup"><span data-stu-id="a0d72-110">For more information about other Windows PowerShell provider implementations, see [Designing Your Windows PowerShell Provider](./designing-your-windows-powershell-provider.md).</span></span>

<span data-ttu-id="a0d72-111">El proveedor que se describe aquí permite el identificador de usuario de una base de datos de Access como una unidad para que el usuario pueda ir a las tablas de datos en la base de datos.</span><span class="sxs-lookup"><span data-stu-id="a0d72-111">The provider described here enables the user handle an Access database as a drive so that the user can navigate to the data tables in the database.</span></span> <span data-ttu-id="a0d72-112">Al crear su propio proveedor de navegación, puede implementar los métodos que pueden hacer rutas de acceso completa a la unidad necesarios para la navegación, normalizar rutas de acceso relativas, mover los elementos de almacén de datos, además de los métodos que obtención los nombres de elemento secundario, probar y obtención la ruta de acceso primaria de un elemento para identificar si un elemento es un contenedor.</span><span class="sxs-lookup"><span data-stu-id="a0d72-112">When creating your own navigation provider, you can implement methods that can make drive-qualified paths required for navigation, normalize relative paths, move items of the data store, as well as methods that get child names, get the parent path of an item, and test to identify if an item is a container.</span></span>

> [!CAUTION]
> <span data-ttu-id="a0d72-113">Tenga en cuenta que este diseño considera una base de datos que tiene un campo con el identificador de nombre y que el tipo del campo es LongInteger.</span><span class="sxs-lookup"><span data-stu-id="a0d72-113">Be aware that this design assumes a database that has a field with the name ID, and that the type of the field is LongInteger.</span></span>

<span data-ttu-id="a0d72-114">En la lista siguiente incluye las secciones de este tema.</span><span class="sxs-lookup"><span data-stu-id="a0d72-114">The following list includes sections in this topic.</span></span> <span data-ttu-id="a0d72-115">Si no está familiarizado con la escritura de un proveedor de navegación de Windows PowerShell, lea esta información en el orden en que aparece.</span><span class="sxs-lookup"><span data-stu-id="a0d72-115">If you are unfamiliar with writing a Windows PowerShell navigation provider, read this information in the order that it appears.</span></span> <span data-ttu-id="a0d72-116">Sin embargo, si está familiarizado con la escritura de un proveedor de navegación de Windows PowerShell, vaya directamente a la información que necesita.</span><span class="sxs-lookup"><span data-stu-id="a0d72-116">However, if you are familiar with writing a Windows PowerShell navigation provider, please go directly to the information that you need.</span></span>

- [<span data-ttu-id="a0d72-117">Definir una clase de proveedor de navegación de PS</span><span class="sxs-lookup"><span data-stu-id="a0d72-117">Defining a PS Navigation Provider Class</span></span>](#Define-the-Windows-PowerShell-provider)

- [<span data-ttu-id="a0d72-118">Definir la funcionalidad de Base</span><span class="sxs-lookup"><span data-stu-id="a0d72-118">Defining Base Functionality</span></span>](#Defining-Base-Functionality)

- [<span data-ttu-id="a0d72-119">Creación de una ruta de acceso PS</span><span class="sxs-lookup"><span data-stu-id="a0d72-119">Creating a PS Path</span></span>](#Creating-a-Windows-PowerShell-Path)

- [<span data-ttu-id="a0d72-120">Recuperar la ruta de acceso primaria</span><span class="sxs-lookup"><span data-stu-id="a0d72-120">Retrieving the Parent Path</span></span>](#Retrieving-the-Parent-Path)

- [<span data-ttu-id="a0d72-121">Recuperar el nombre de ruta de acceso secundaria</span><span class="sxs-lookup"><span data-stu-id="a0d72-121">Retrieving the Child Path Name</span></span>](#Retrieve-the-Child-Path-Name)

- [<span data-ttu-id="a0d72-122">Determinar si un elemento es un contenedor</span><span class="sxs-lookup"><span data-stu-id="a0d72-122">Determining if an Item is a Container</span></span>](#Determining-if-an-Item-is-a-Container)

- [<span data-ttu-id="a0d72-123">Mover un elemento</span><span class="sxs-lookup"><span data-stu-id="a0d72-123">Moving an Item</span></span>](#Moving-an-Item)

- [<span data-ttu-id="a0d72-124">Asociar los parámetros dinámicos a la `Move-Item` Cmdlet</span><span class="sxs-lookup"><span data-stu-id="a0d72-124">Attaching Dynamic Parameters to the `Move-Item` Cmdlet</span></span>](#Attaching-Dynamic-Parameters-to-the-Move-Item-Cmdlet)

- [<span data-ttu-id="a0d72-125">La normalización de una ruta de acceso relativa</span><span class="sxs-lookup"><span data-stu-id="a0d72-125">Normalizing a Relative Path</span></span>](#Normalizing-a-Relative-Path)

- [<span data-ttu-id="a0d72-126">Ejemplo de código</span><span class="sxs-lookup"><span data-stu-id="a0d72-126">Code Sample</span></span>](#Code-Sample)

- [<span data-ttu-id="a0d72-127">Definir los tipos de objeto y el formato</span><span class="sxs-lookup"><span data-stu-id="a0d72-127">Defining Object Types and Formatting</span></span>](#Defining-Object-Types-and-Formatting)

- [<span data-ttu-id="a0d72-128">Creación del proveedor de Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="a0d72-128">Building the Windows PowerShell Provider</span></span>](#Building-the-Windows-PowerShell-provider)

- [<span data-ttu-id="a0d72-129">Probar el proveedor de Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="a0d72-129">Testing the Windows PowerShell Provider</span></span>](#Testing-the-Windows-PowerShell-provider)

## <a name="define-the-windows-powershell-provider"></a><span data-ttu-id="a0d72-130">Defina el proveedor de Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="a0d72-130">Define the Windows PowerShell provider</span></span>

<span data-ttu-id="a0d72-131">Un proveedor de navegación de Windows PowerShell debe crear una clase .NET que se deriva de la [System.Management.Automation.Provider.Navigationcmdletprovider](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider) clase base.</span><span class="sxs-lookup"><span data-stu-id="a0d72-131">A Windows PowerShell navigation provider must create a .NET class that derives from the [System.Management.Automation.Provider.Navigationcmdletprovider](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider) base class.</span></span> <span data-ttu-id="a0d72-132">Esta es la definición de clase para el proveedor de navegación que se describe en esta sección.</span><span class="sxs-lookup"><span data-stu-id="a0d72-132">Here is the class definition for the navigation provider described in this section.</span></span>

[!code-csharp[AccessDBProviderSample05.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample05/AccessDBProviderSample05.cs#L31-L32 "AccessDBProviderSample05.cs")]

<span data-ttu-id="a0d72-133">Tenga en cuenta que en este proveedor, el [System.Management.Automation.Provider.Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) atributo incluye dos parámetros.</span><span class="sxs-lookup"><span data-stu-id="a0d72-133">Note that in this provider, the [System.Management.Automation.Provider.Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) attribute includes two parameters.</span></span> <span data-ttu-id="a0d72-134">El primer parámetro especifica un nombre descriptivo para el proveedor que está usando Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="a0d72-134">The first parameter specifies a user-friendly name for the provider that is used by Windows PowerShell.</span></span> <span data-ttu-id="a0d72-135">El segundo parámetro especifica las capacidades específicas de Windows PowerShell que expone el proveedor para el tiempo de ejecución de Windows PowerShell durante el procesamiento de comandos.</span><span class="sxs-lookup"><span data-stu-id="a0d72-135">The second parameter specifies the Windows PowerShell specific capabilities that the provider exposes to the Windows PowerShell runtime during command processing.</span></span> <span data-ttu-id="a0d72-136">Para este proveedor, no hay ningún funcionalidades específicas de Windows PowerShell que se agregan.</span><span class="sxs-lookup"><span data-stu-id="a0d72-136">For this provider, there are no Windows PowerShell specific capabilities that are added.</span></span>

## <a name="defining-base-functionality"></a><span data-ttu-id="a0d72-137">Definir la funcionalidad de Base</span><span class="sxs-lookup"><span data-stu-id="a0d72-137">Defining Base Functionality</span></span>

<span data-ttu-id="a0d72-138">Como se describe en [diseño PS proveedor](./designing-your-windows-powershell-provider.md), el [System.Management.Automation.Provider.Navigationcmdletprovider](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider) clase base que se deriva de varias clases que proporcionan otro proveedor funcionalidad.</span><span class="sxs-lookup"><span data-stu-id="a0d72-138">As described in [Design Your PS Provider](./designing-your-windows-powershell-provider.md), the [System.Management.Automation.Provider.Navigationcmdletprovider](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider) base class derives from several other classes that provided different provider functionality.</span></span> <span data-ttu-id="a0d72-139">Un proveedor de navegación de Windows PowerShell, por lo tanto, debe definir toda la funcionalidad proporcionada por esas clases.</span><span class="sxs-lookup"><span data-stu-id="a0d72-139">A Windows PowerShell navigation provider, therefore, must define all of the functionality provided by those classes.</span></span>

<span data-ttu-id="a0d72-140">Para implementar la funcionalidad para agregar información de inicialización específicas de la sesión y para liberar los recursos utilizados por el proveedor, consulte [creación de un proveedor básico de PS](./creating-a-basic-windows-powershell-provider.md).</span><span class="sxs-lookup"><span data-stu-id="a0d72-140">To implement functionality for adding session-specific initialization information and for releasing resources that are used by the provider, see [Creating a Basic PS Provider](./creating-a-basic-windows-powershell-provider.md).</span></span> <span data-ttu-id="a0d72-141">Sin embargo, la mayoría de proveedores (incluido el proveedor que se describe aquí) puede usar la implementación predeterminada de esta funcionalidad proporcionada por Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="a0d72-141">However, most providers (including the provider described here) can use the default implementation of this functionality provided by Windows PowerShell.</span></span>

<span data-ttu-id="a0d72-142">Para obtener acceso al almacén de datos a través de una unidad de Windows PowerShell, debe implementar los métodos de la [System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) clase base.</span><span class="sxs-lookup"><span data-stu-id="a0d72-142">To get access to the data store through a Windows PowerShell drive, you must implement the methods of the [System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) base class.</span></span> <span data-ttu-id="a0d72-143">Para obtener más información acerca de cómo implementar estos métodos, consulte [creación de un proveedor de la unidad de Windows PowerShell](./creating-a-windows-powershell-drive-provider.md).</span><span class="sxs-lookup"><span data-stu-id="a0d72-143">For more information about implementing these methods, see [Creating a Windows PowerShell Drive Provider](./creating-a-windows-powershell-drive-provider.md).</span></span>

<span data-ttu-id="a0d72-144">Para manipular los elementos de un almacén de datos, como introducción, configuración y elementos de compensación, el proveedor debe implementar los métodos proporcionados por el [System.Management.Automation.Provider.Itemcmdletprovider](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider) clase base.</span><span class="sxs-lookup"><span data-stu-id="a0d72-144">To manipulate the items of a data store, such as getting, setting, and clearing items, the provider must implement the methods provided by the [System.Management.Automation.Provider.Itemcmdletprovider](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider) base class.</span></span> <span data-ttu-id="a0d72-145">Para obtener más información acerca de cómo implementar estos métodos, consulte [creación de un proveedor de elementos de Windows PowerShell](./creating-a-windows-powershell-item-provider.md).</span><span class="sxs-lookup"><span data-stu-id="a0d72-145">For more information about implementing these methods, see [Creating an Windows PowerShell Item Provider](./creating-a-windows-powershell-item-provider.md).</span></span>

<span data-ttu-id="a0d72-146">Para obtener los elementos secundarios o sus nombres, de que el almacén de datos, así como los métodos que crean, copiarán, cambiar el nombre y eliminar elementos, debe implementar los métodos proporcionados por el [System.Management.Automation.Provider.Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider)clase base.</span><span class="sxs-lookup"><span data-stu-id="a0d72-146">To get to the child items, or their names, of the data store, as well as methods that create, copy, rename, and remove items, you must implement the methods provided by the [System.Management.Automation.Provider.Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider) base class.</span></span> <span data-ttu-id="a0d72-147">Para obtener más información acerca de cómo implementar estos métodos, consulte [creación de un proveedor de contenedores de Windows PowerShell](./creating-a-windows-powershell-container-provider.md).</span><span class="sxs-lookup"><span data-stu-id="a0d72-147">For more information about implementing these methods, see [Creating a Windows PowerShell Container Provider](./creating-a-windows-powershell-container-provider.md).</span></span>

## <a name="creating-a-windows-powershell-path"></a><span data-ttu-id="a0d72-148">Creación de una ruta de acceso de Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="a0d72-148">Creating a Windows PowerShell Path</span></span>

<span data-ttu-id="a0d72-149">Proveedor de navegación de Windows PowerShell usa una ruta de acceso interna del proveedor de Windows PowerShell para navegar por los elementos del almacén de datos.</span><span class="sxs-lookup"><span data-stu-id="a0d72-149">Windows PowerShell navigation provider use a provider-internal Windows PowerShell path to navigate the items of the data store.</span></span> <span data-ttu-id="a0d72-150">Para crear una ruta de acceso interna del proveedor en el proveedor debe implementar la [System.Management.Automation.Provider.Navigationcmdletprovider.Makepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath) llamadas al método que admite del cmdlet Combine-Path.</span><span class="sxs-lookup"><span data-stu-id="a0d72-150">To create a provider-internal path the provider must implement the [System.Management.Automation.Provider.Navigationcmdletprovider.Makepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath) method to supports calls from the Combine-Path cmdlet.</span></span> <span data-ttu-id="a0d72-151">Este método combina una ruta de acceso primaria y secundaria en una ruta de acceso interna del proveedor, con un separador de ruta de acceso específica del proveedor entre las rutas de acceso primarias y secundarias.</span><span class="sxs-lookup"><span data-stu-id="a0d72-151">This method combines a parent and child path into a provider-internal path, using a provider-specific path separator between the parent and child paths.</span></span>

<span data-ttu-id="a0d72-152">La implementación predeterminada toma rutas de acceso con "/" o "\\"como separador de ruta de acceso, normaliza el separador de ruta de acceso a"\\", combina los elementos primarios y secundarios de la ruta con el separador entre ellas y, a continuación, devuelve una cadena que contiene el rutas de acceso combinadas.</span><span class="sxs-lookup"><span data-stu-id="a0d72-152">The default implementation takes paths with "/" or "\\" as the path separator, normalizes the path separator to "\\", combines the parent and child path parts with the separator between them, and then returns a string that contains the combined paths.</span></span>

<span data-ttu-id="a0d72-153">Este proveedor de navegación no implementa este método.</span><span class="sxs-lookup"><span data-stu-id="a0d72-153">This navigation provider does not implement this method.</span></span> <span data-ttu-id="a0d72-154">Sin embargo, el código siguiente es la implementación predeterminada de la [System.Management.Automation.Provider.Navigationcmdletprovider.Makepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath) método.</span><span class="sxs-lookup"><span data-stu-id="a0d72-154">However, the following code is the default implementation of the [System.Management.Automation.Provider.Navigationcmdletprovider.Makepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath) method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidermakepath](Msh_samplestestcmdlets#testprovidermakepath)]  -->

#### <a name="things-to-remember-about-implementing-makepath"></a><span data-ttu-id="a0d72-155">Cosas que recordar acerca de cómo implementar MakePath</span><span class="sxs-lookup"><span data-stu-id="a0d72-155">Things to Remember About Implementing MakePath</span></span>

<span data-ttu-id="a0d72-156">Las siguientes condiciones pueden aplicarse a la implementación de [System.Management.Automation.Provider.Navigationcmdletprovider.Makepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath):</span><span class="sxs-lookup"><span data-stu-id="a0d72-156">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Navigationcmdletprovider.Makepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath):</span></span>

- <span data-ttu-id="a0d72-157">La implementación de la [System.Management.Automation.Provider.Navigationcmdletprovider.Makepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath) método no debe validar la ruta de acceso como una ruta legal completo en el espacio de nombres del proveedor.</span><span class="sxs-lookup"><span data-stu-id="a0d72-157">Your implementation of the [System.Management.Automation.Provider.Navigationcmdletprovider.Makepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath) method should not validate the path as a legal fully-qualified path in the provider namespace.</span></span> <span data-ttu-id="a0d72-158">Tenga en cuenta que cada parámetro sólo pueden representar una parte de una ruta de acceso y los elementos combinados no podrían generar una ruta de acceso completa.</span><span class="sxs-lookup"><span data-stu-id="a0d72-158">Be aware that each parameter can only represent a part of a path, and the combined parts might not generate a fully-qualified path.</span></span> <span data-ttu-id="a0d72-159">Por ejemplo, el [System.Management.Automation.Provider.Navigationcmdletprovider.Makepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath) método para el proveedor filesystem podría recibir "windows\system32" en el `parent` parámetro y "abc.dll" en el `child` parámetro.</span><span class="sxs-lookup"><span data-stu-id="a0d72-159">For example, the [System.Management.Automation.Provider.Navigationcmdletprovider.Makepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath) method for the filesystem provider might receive "windows\system32" in the `parent` parameter and "abc.dll" in the `child` parameter.</span></span> <span data-ttu-id="a0d72-160">El método combina estos valores con el "\\" separador y devuelve "windows\system32\abc.dll", que no es una ruta de acceso de archivo completo del sistema.</span><span class="sxs-lookup"><span data-stu-id="a0d72-160">The method joins these values with the "\\" separator and returns "windows\system32\abc.dll", which is not a fully-qualified file system path.</span></span>

  > [!IMPORTANT]
  > <span data-ttu-id="a0d72-161">Los elementos de la ruta de acceso proporcionados en la llamada a [System.Management.Automation.Provider.Navigationcmdletprovider.Makepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath) podría contener caracteres no permitidos en el espacio de nombres del proveedor.</span><span class="sxs-lookup"><span data-stu-id="a0d72-161">The path parts provided in the call to [System.Management.Automation.Provider.Navigationcmdletprovider.Makepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MakePath) might contain characters not allowed in the provider namespace.</span></span> <span data-ttu-id="a0d72-162">Estos caracteres más probable es que se usan para la expansión de caracteres comodín y la implementación de este método no debería quitar.</span><span class="sxs-lookup"><span data-stu-id="a0d72-162">These characters are most likely used for wildcard expansion and the implementation of this method should not remove them.</span></span>

## <a name="retrieving-the-parent-path"></a><span data-ttu-id="a0d72-163">Recuperar la ruta de acceso primaria</span><span class="sxs-lookup"><span data-stu-id="a0d72-163">Retrieving the Parent Path</span></span>

<span data-ttu-id="a0d72-164">Los proveedores de exploración de Windows PowerShell implementan el [System.Management.Automation.Provider.Navigationcmdletprovider.Getparentpath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.GetParentPath) método para recuperar la parte principal del completa o parcial ruta de acceso específica del proveedor.</span><span class="sxs-lookup"><span data-stu-id="a0d72-164">Windows PowerShell navigation providers implement the [System.Management.Automation.Provider.Navigationcmdletprovider.Getparentpath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.GetParentPath) method to retrieve the parent part of the indicated full or partial provider-specific path.</span></span> <span data-ttu-id="a0d72-165">El método quita la parte secundaria de la ruta de acceso y devuelve al elemento primario de parte de la ruta de acceso.</span><span class="sxs-lookup"><span data-stu-id="a0d72-165">The method removes the child part of the path and returns the parent path part.</span></span> <span data-ttu-id="a0d72-166">El `root` parámetro especifica la ruta de acceso completa a la raíz de una unidad.</span><span class="sxs-lookup"><span data-stu-id="a0d72-166">The `root` parameter specifies the fully-qualified path to the root of a drive.</span></span> <span data-ttu-id="a0d72-167">Este parámetro puede ser nulo ni estar vacío si no se usa para la operación de recuperación de una unidad montada.</span><span class="sxs-lookup"><span data-stu-id="a0d72-167">This parameter can be null or empty if a mounted drive is not in use for the retrieval operation.</span></span> <span data-ttu-id="a0d72-168">Si se especifica una raíz, el método debe devolver una ruta de acceso a un contenedor en el mismo árbol de la raíz.</span><span class="sxs-lookup"><span data-stu-id="a0d72-168">If a root is specified, the method must return a path to a container in the same tree as the root.</span></span>

<span data-ttu-id="a0d72-169">El proveedor de navegación no invalida este método, pero utiliza la implementación predeterminada.</span><span class="sxs-lookup"><span data-stu-id="a0d72-169">The sample navigation provider does not override this method, but uses the default implementation.</span></span> <span data-ttu-id="a0d72-170">Acepta las rutas de acceso que se usan "/" y "\\" como separadores de ruta de acceso.</span><span class="sxs-lookup"><span data-stu-id="a0d72-170">It accepts paths that use both "/" and "\\" as path separators.</span></span> <span data-ttu-id="a0d72-171">En primer lugar normaliza la ruta de acceso para que solo se "\\" separadores, a continuación, divide la ruta de acceso primaria desactivado en el último "\\" y devuelve la ruta de acceso primaria.</span><span class="sxs-lookup"><span data-stu-id="a0d72-171">It first normalizes the path to have only "\\" separators, then splits the parent path off at the last "\\" and returns the parent path.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidergetparentpath](Msh_samplestestcmdlets#testprovidergetparentpath)]  -->

#### <a name="to-remember-about-implementing-getparentpath"></a><span data-ttu-id="a0d72-172">Recordar acerca de cómo implementar GetParentPath</span><span class="sxs-lookup"><span data-stu-id="a0d72-172">To Remember About Implementing GetParentPath</span></span>

<span data-ttu-id="a0d72-173">La implementación de la [System.Management.Automation.Provider.Navigationcmdletprovider.Getparentpath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.GetParentPath) método debe dividir la ruta de acceso léxicamente en el separador de ruta de acceso del espacio de nombres del proveedor.</span><span class="sxs-lookup"><span data-stu-id="a0d72-173">Your implementation of the [System.Management.Automation.Provider.Navigationcmdletprovider.Getparentpath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.GetParentPath) method should split the path lexically on the path separator for the provider namespace.</span></span> <span data-ttu-id="a0d72-174">Por ejemplo, el proveedor filesystem utiliza este método para buscar la última "\\" y todo lo devuelve a la izquierda del separador.</span><span class="sxs-lookup"><span data-stu-id="a0d72-174">For example, the filesystem provider uses this method to look for the last "\\" and returns everything to the left of the separator.</span></span>

## <a name="retrieve-the-child-path-name"></a><span data-ttu-id="a0d72-175">Recuperar el nombre de ruta de acceso secundaria</span><span class="sxs-lookup"><span data-stu-id="a0d72-175">Retrieve the Child Path Name</span></span>

<span data-ttu-id="a0d72-176">El proveedor de navegación implementa el [System.Management.Automation.Provider.Navigationcmdletprovider.Getchildname\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.GetChildName) método para recuperar el nombre (elemento de hoja) del elemento secundario del elemento situado en el completo indicado o ruta de acceso parcial específica del proveedor.</span><span class="sxs-lookup"><span data-stu-id="a0d72-176">Your navigation provider implements the [System.Management.Automation.Provider.Navigationcmdletprovider.Getchildname\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.GetChildName) method to retrieve the name (leaf element) of the child of the item located at the indicated full or partial provider-specific path.</span></span>

<span data-ttu-id="a0d72-177">El proveedor de navegación no invalida este método.</span><span class="sxs-lookup"><span data-stu-id="a0d72-177">The sample navigation provider does not override this method.</span></span> <span data-ttu-id="a0d72-178">La implementación predeterminada se muestra a continuación.</span><span class="sxs-lookup"><span data-stu-id="a0d72-178">The default implementation is shown below.</span></span> <span data-ttu-id="a0d72-179">Acepta las rutas de acceso que se usan "/" y "\\" como separadores de ruta de acceso.</span><span class="sxs-lookup"><span data-stu-id="a0d72-179">It accepts paths that use both "/" and "\\" as path separators.</span></span> <span data-ttu-id="a0d72-180">En primer lugar normaliza la ruta de acceso para que solo se "\\" separadores, a continuación, divide la ruta de acceso primaria desactivado en el último "\\" y devuelve el nombre del elemento secundario de parte de la ruta de acceso.</span><span class="sxs-lookup"><span data-stu-id="a0d72-180">It first normalizes the path to have only "\\" separators, then splits the parent path off at the last "\\" and returns the name of the child path part.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidergetchildname](Msh_samplestestcmdlets#testprovidergetchildname)]  -->

#### <a name="things-to-remember-about-implementing-getchildname"></a><span data-ttu-id="a0d72-181">Cosas que recordar acerca de cómo implementar GetChildName</span><span class="sxs-lookup"><span data-stu-id="a0d72-181">Things to Remember About Implementing GetChildName</span></span>

<span data-ttu-id="a0d72-182">La implementación de la [System.Management.Automation.Provider.Navigationcmdletprovider.Getchildname\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.GetChildName) método debe dividir la ruta de acceso léxicamente en el separador de ruta de acceso.</span><span class="sxs-lookup"><span data-stu-id="a0d72-182">Your implementation of the [System.Management.Automation.Provider.Navigationcmdletprovider.Getchildname\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.GetChildName) method should split the path lexically on the path separator.</span></span> <span data-ttu-id="a0d72-183">Si la ruta de acceso proporcionada no contiene separadores de ruta de acceso, el método debe devolver la ruta de acceso sin modificar.</span><span class="sxs-lookup"><span data-stu-id="a0d72-183">If the supplied path contains no path separators, the method should return the path unmodified.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="a0d72-184">La ruta de acceso proporcionada en la llamada a este método podría contener caracteres que no son válidos en el espacio de nombres del proveedor.</span><span class="sxs-lookup"><span data-stu-id="a0d72-184">The path provided in the call to this method might contain characters that are illegal in the provider namespace.</span></span> <span data-ttu-id="a0d72-185">Estos caracteres son probablemente usa para la expansión de caracteres comodín o coincidencia de expresión regular y la implementación de este método no debería quitar.</span><span class="sxs-lookup"><span data-stu-id="a0d72-185">These characters are most likely used for wildcard expansion or regular expression matching, and the implementation of this method should not remove them.</span></span>

## <a name="determining-if-an-item-is-a-container"></a><span data-ttu-id="a0d72-186">Determinar si un elemento es un contenedor</span><span class="sxs-lookup"><span data-stu-id="a0d72-186">Determining if an Item is a Container</span></span>

<span data-ttu-id="a0d72-187">Puede implementar el proveedor de navegación de la [System.Management.Automation.Provider.Navigationcmdletprovider.Isitemcontainer\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.IsItemContainer) método para determinar si la ruta de acceso especificada indica un contenedor.</span><span class="sxs-lookup"><span data-stu-id="a0d72-187">The navigation provider can implement the [System.Management.Automation.Provider.Navigationcmdletprovider.Isitemcontainer\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.IsItemContainer) method to determine if the specified path indicates a container.</span></span> <span data-ttu-id="a0d72-188">Devuelve true si la ruta de acceso representa un contenedor y false en caso contrario.</span><span class="sxs-lookup"><span data-stu-id="a0d72-188">It returns true if the path represents a container, and false otherwise.</span></span> <span data-ttu-id="a0d72-189">El usuario necesita este método para que pueda usar el `Test-Path` cmdlet para la ruta de acceso proporcionada.</span><span class="sxs-lookup"><span data-stu-id="a0d72-189">The user needs this method to be able to use the `Test-Path` cmdlet for the supplied path.</span></span>

<span data-ttu-id="a0d72-190">El siguiente código muestra la [System.Management.Automation.Provider.Navigationcmdletprovider.Isitemcontainer\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.IsItemContainer) implementación en nuestro proveedor de navegación de ejemplo.</span><span class="sxs-lookup"><span data-stu-id="a0d72-190">The following code shows the [System.Management.Automation.Provider.Navigationcmdletprovider.Isitemcontainer\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.IsItemContainer) implementation in our sample navigation provider.</span></span> <span data-ttu-id="a0d72-191">El método comprueba que la ruta de acceso especificada sea correcta y si la tabla existe y devuelve true si la ruta de acceso indica un contenedor.</span><span class="sxs-lookup"><span data-stu-id="a0d72-191">The method verifies that  the specified path is correct and if the table exists, and returns true if the path indicates a container.</span></span>

[!code-csharp[AccessDBProviderSample05.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample05/AccessDBProviderSample05.cs#L847-L872 "AccessDBProviderSample05.cs")]

#### <a name="things-to-remember-about-implementing-isitemcontainer"></a><span data-ttu-id="a0d72-192">Cosas que recordar acerca de cómo implementar IsItemContainer</span><span class="sxs-lookup"><span data-stu-id="a0d72-192">Things to Remember About Implementing IsItemContainer</span></span>

<span data-ttu-id="a0d72-193">El clase .NET del proveedor de navegación puede declarar las capacidades del proveedor de ExpandWildcards, filtro, Include o Exclude, desde el [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeración.</span><span class="sxs-lookup"><span data-stu-id="a0d72-193">Your navigation provider .NET class might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="a0d72-194">En este caso, la implementación de [System.Management.Automation.Provider.Navigationcmdletprovider.Isitemcontainer\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.IsItemContainer) debe asegurarse de que la ruta de acceso pasa cumple los requisitos.</span><span class="sxs-lookup"><span data-stu-id="a0d72-194">In this case, the implementation of [System.Management.Automation.Provider.Navigationcmdletprovider.Isitemcontainer\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.IsItemContainer) needs to ensure that the path passed meets requirements.</span></span> <span data-ttu-id="a0d72-195">Para ello, el método debe tener acceso a la propiedad adecuada, por ejemplo, el [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) propiedad.</span><span class="sxs-lookup"><span data-stu-id="a0d72-195">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) property.</span></span>

## <a name="moving-an-item"></a><span data-ttu-id="a0d72-196">Mover un elemento</span><span class="sxs-lookup"><span data-stu-id="a0d72-196">Moving an Item</span></span>

<span data-ttu-id="a0d72-197">Soporte del `Move-Item` implementa el proveedor de navegación de cmdlet, el [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitem\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) método.</span><span class="sxs-lookup"><span data-stu-id="a0d72-197">In support of the `Move-Item` cmdlet, your navigation provider implements the [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitem\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) method.</span></span> <span data-ttu-id="a0d72-198">Este método mueve el elemento especificado por el `path` parámetro en el contenedor en la ruta de acceso proporcionada en el `destination` parámetro.</span><span class="sxs-lookup"><span data-stu-id="a0d72-198">This method moves the item specified by the `path` parameter to the container at the path supplied in the `destination` parameter.</span></span>

<span data-ttu-id="a0d72-199">El proveedor de navegación no invalida el [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitem\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) método.</span><span class="sxs-lookup"><span data-stu-id="a0d72-199">The sample navigation provider does not override the [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitem\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) method.</span></span> <span data-ttu-id="a0d72-200">La siguiente es la implementación predeterminada.</span><span class="sxs-lookup"><span data-stu-id="a0d72-200">The following is the default implementation.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidermoveitem](Msh_samplestestcmdlets#testprovidermoveitem)]  -->

#### <a name="things-to-remember-about-implementing-moveitem"></a><span data-ttu-id="a0d72-201">Cosas que recordar acerca de cómo implementar MoveItem</span><span class="sxs-lookup"><span data-stu-id="a0d72-201">Things to Remember About Implementing MoveItem</span></span>

<span data-ttu-id="a0d72-202">El clase .NET del proveedor de navegación puede declarar las capacidades del proveedor de ExpandWildcards, filtro, Include o Exclude, desde el [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeración.</span><span class="sxs-lookup"><span data-stu-id="a0d72-202">Your navigation provider .NET class might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="a0d72-203">En este caso, la implementación de [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitem\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) debe asegurarse de que la ruta de acceso pasa cumple los requisitos.</span><span class="sxs-lookup"><span data-stu-id="a0d72-203">In this case, the implementation of [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitem\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) must ensure that the path passed meets requirements.</span></span> <span data-ttu-id="a0d72-204">Para ello, el método debe tener acceso a la propiedad adecuada, por ejemplo, el **CmdletProvider.Exclude** propiedad.</span><span class="sxs-lookup"><span data-stu-id="a0d72-204">To do this, the method should access the appropriate property, for example, the **CmdletProvider.Exclude** property.</span></span>

<span data-ttu-id="a0d72-205">De forma predeterminada, las invalidaciones de este método no deben mover los objetos a través de los objetos existentes a menos que el [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) propiedad está establecida en `true`.</span><span class="sxs-lookup"><span data-stu-id="a0d72-205">By default, overrides of this method should not move objects over existing objects unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="a0d72-206">Por ejemplo, el proveedor filesystem no copiará c:\temp\abc.txt a través de un archivo c:\bar.txt existente a menos que el [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) propiedad está establecida en `true`.</span><span class="sxs-lookup"><span data-stu-id="a0d72-206">For example, the filesystem provider will not copy c:\temp\abc.txt over an existing c:\bar.txt file unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="a0d72-207">Si la ruta de acceso especificada en el `destination` parámetro existe y es un contenedor, el [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) propiedad no es necesaria.</span><span class="sxs-lookup"><span data-stu-id="a0d72-207">If the path specified in the `destination` parameter exists and is a container, the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is not required.</span></span> <span data-ttu-id="a0d72-208">En este caso, [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitem\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) debe mover el elemento indicado por el `path` parámetro en el contenedor indicado por el `destination` parámetro como un elemento secundario.</span><span class="sxs-lookup"><span data-stu-id="a0d72-208">In this case, [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitem\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) should move the item indicated by the `path` parameter to the container indicated by the `destination` parameter as a child.</span></span>

<span data-ttu-id="a0d72-209">La implementación de la [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitem\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) debe llamar al método [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) y comprobar su valor devuelto antes de realizar cualquier cambio en el almacén de datos.</span><span class="sxs-lookup"><span data-stu-id="a0d72-209">Your implementation of the [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitem\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) method should call [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and check its return value before making any changes to the data store.</span></span> <span data-ttu-id="a0d72-210">Este método se utiliza para confirmar la ejecución de una operación cuando se modifica el estado del sistema, por ejemplo, eliminar archivos.</span><span class="sxs-lookup"><span data-stu-id="a0d72-210">This method is used to confirm execution of an operation when a change is made to system state, for example, deleting files.</span></span> <span data-ttu-id="a0d72-211">[System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) envía el nombre del recurso que se puede cambiar para el usuario, con el tiempo de ejecución de Windows PowerShell teniendo en cuenta cualquier configuración de línea de comandos o variables de preferencia en determinar lo que debe mostrarse al usuario.</span><span class="sxs-lookup"><span data-stu-id="a0d72-211">[System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) sends the name of the resource to be changed to the user, with the Windows PowerShell runtime taking into account any command line settings or preference variables in determining what should be displayed to the user.</span></span>

<span data-ttu-id="a0d72-212">Después de llamar a [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) devuelve `true`, [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitem\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) debe llamar al método el [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) método.</span><span class="sxs-lookup"><span data-stu-id="a0d72-212">After the call to [System.Management.Automation.Provider.Cmdletprovider.Shouldprocess\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns `true`, the [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitem\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItem) method should call the [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method.</span></span> <span data-ttu-id="a0d72-213">Este método envía un mensaje al usuario para que los comentarios que decir si debe continuarse la operación.</span><span class="sxs-lookup"><span data-stu-id="a0d72-213">This method sends a message to the user to allow feedback to say if the operation should be continued.</span></span> <span data-ttu-id="a0d72-214">El proveedor debe llamar a [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) como una comprobación adicional para las modificaciones del sistema potencialmente peligrosos.</span><span class="sxs-lookup"><span data-stu-id="a0d72-214">Your provider should call [System.Management.Automation.Provider.Cmdletprovider.Shouldcontinue\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) as an additional check for potentially dangerous system modifications.</span></span>

## <a name="attaching-dynamic-parameters-to-the-move-item-cmdlet"></a><span data-ttu-id="a0d72-215">Asociar los parámetros dinámicos para el Cmdlet Move-Item</span><span class="sxs-lookup"><span data-stu-id="a0d72-215">Attaching Dynamic Parameters to the Move-Item Cmdlet</span></span>

<span data-ttu-id="a0d72-216">A veces la `Move-Item` cmdlet requiere parámetros adicionales que se proporcionan de forma dinámica en tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="a0d72-216">Sometimes the `Move-Item` cmdlet requires additional parameters that are provided dynamically at runtime.</span></span> <span data-ttu-id="a0d72-217">Para proporcionar estos parámetros dinámicos, el proveedor de navegación debe implementar la [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItemDynamicParameters) método para obtener los valores de parámetro necesarios desde el elemento situado en la ruta de acceso indicada y devolver un objeto que tiene las propiedades y campos con el análisis de atributos similar a una clase de cmdlet o una [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) objeto.</span><span class="sxs-lookup"><span data-stu-id="a0d72-217">To provide these dynamic parameters, the navigation provider must implement the [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItemDynamicParameters) method to get the required parameter values from the item at the indicated path, and return an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span>

<span data-ttu-id="a0d72-218">Este proveedor de navegación no implementa este método.</span><span class="sxs-lookup"><span data-stu-id="a0d72-218">This navigation provider does not implement this method.</span></span> <span data-ttu-id="a0d72-219">Sin embargo, el código siguiente es la implementación predeterminada de [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItemDynamicParameters).</span><span class="sxs-lookup"><span data-stu-id="a0d72-219">However, the following code is the default implementation of [System.Management.Automation.Provider.Navigationcmdletprovider.Moveitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.MoveItemDynamicParameters).</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidermoveitemdynamicparameters](Msh_samplestestcmdlets#testprovidermoveitemdynamicparameters)]  -->

## <a name="normalizing-a-relative-path"></a><span data-ttu-id="a0d72-220">La normalización de una ruta de acceso relativa</span><span class="sxs-lookup"><span data-stu-id="a0d72-220">Normalizing a Relative Path</span></span>

<span data-ttu-id="a0d72-221">El proveedor de navegación implementa el [System.Management.Automation.Provider.Navigationcmdletprovider.Normalizerelativepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.NormalizeRelativePath) indica el método para normalizar la ruta de acceso completa en el `path` parámetro como en relación con la ruta de acceso especificada por el `basePath` parámetro.</span><span class="sxs-lookup"><span data-stu-id="a0d72-221">Your navigation provider implements the [System.Management.Automation.Provider.Navigationcmdletprovider.Normalizerelativepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.NormalizeRelativePath) method to normalize the fully-qualified path indicated in the `path` parameter as being relative to the path specified by the `basePath` parameter.</span></span> <span data-ttu-id="a0d72-222">El método devuelve una representación de cadena de la ruta de acceso normalizada.</span><span class="sxs-lookup"><span data-stu-id="a0d72-222">The method returns a string representation of the normalized path.</span></span> <span data-ttu-id="a0d72-223">Escribe un error si el `path` parámetro especifica una ruta de acceso que no existe.</span><span class="sxs-lookup"><span data-stu-id="a0d72-223">It writes an error if the `path` parameter specifies a nonexistent path.</span></span>

<span data-ttu-id="a0d72-224">El proveedor de navegación no invalida este método.</span><span class="sxs-lookup"><span data-stu-id="a0d72-224">The sample navigation provider does not override this method.</span></span> <span data-ttu-id="a0d72-225">La siguiente es la implementación predeterminada.</span><span class="sxs-lookup"><span data-stu-id="a0d72-225">The following is the default implementation.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidernormalizepath](Msh_samplestestcmdlets#testprovidernormalizepath)]  -->

#### <a name="things-to-remember-about-implementing-normalizerelativepath"></a><span data-ttu-id="a0d72-226">Cosas que recordar acerca de cómo implementar NormalizeRelativePath</span><span class="sxs-lookup"><span data-stu-id="a0d72-226">Things to Remember About Implementing NormalizeRelativePath</span></span>

<span data-ttu-id="a0d72-227">La implementación de [System.Management.Automation.Provider.Navigationcmdletprovider.Normalizerelativepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.NormalizeRelativePath) debe analizar el `path` parámetro, pero no tiene que utilizar el análisis sintácticas.</span><span class="sxs-lookup"><span data-stu-id="a0d72-227">Your implementation of [System.Management.Automation.Provider.Navigationcmdletprovider.Normalizerelativepath\*](/dotnet/api/System.Management.Automation.Provider.NavigationCmdletProvider.NormalizeRelativePath) should parse the `path` parameter, but it does not have to use purely syntactical parsing.</span></span> <span data-ttu-id="a0d72-228">Se recomienda este método para utilizar la ruta de acceso para buscar la información de ruta de acceso del almacén de datos y crear una ruta de acceso que coincide con las mayúsculas y minúsculas de diseño y estandarizado de sintaxis de ruta de acceso.</span><span class="sxs-lookup"><span data-stu-id="a0d72-228">You are encouraged to design this method to use the path to look up the path information in the data store and create a path that matches the casing and standardized path syntax.</span></span>

## <a name="code-sample"></a><span data-ttu-id="a0d72-229">Ejemplo de código</span><span class="sxs-lookup"><span data-stu-id="a0d72-229">Code Sample</span></span>

<span data-ttu-id="a0d72-230">Para el código de ejemplo completo, vea [AccessDbProviderSample05 código de ejemplo](./accessdbprovidersample05-code-sample.md).</span><span class="sxs-lookup"><span data-stu-id="a0d72-230">For complete sample code, see [AccessDbProviderSample05 Code Sample](./accessdbprovidersample05-code-sample.md).</span></span>

## <a name="defining-object-types-and-formatting"></a><span data-ttu-id="a0d72-231">Definir los tipos de objeto y el formato</span><span class="sxs-lookup"><span data-stu-id="a0d72-231">Defining Object Types and Formatting</span></span>

<span data-ttu-id="a0d72-232">Es posible que un proveedor para agregar a miembros a los objetos existentes o defina nuevos objetos.</span><span class="sxs-lookup"><span data-stu-id="a0d72-232">It is possible for a provider to add members to existing objects or define new objects.</span></span> <span data-ttu-id="a0d72-233">Para obtener más información, consulte[extender los tipos de objeto y formato](http://msdn.microsoft.com/en-us/da976d91-a3d6-44e8-affa-466b1e2bd351).</span><span class="sxs-lookup"><span data-stu-id="a0d72-233">For more information, see[Extending Object Types and Formatting](http://msdn.microsoft.com/en-us/da976d91-a3d6-44e8-affa-466b1e2bd351).</span></span>
<span data-ttu-id="a0d72-234">Es posible que un proveedor para agregar a miembros a los objetos existentes o defina nuevos objetos.</span><span class="sxs-lookup"><span data-stu-id="a0d72-234">It is possible for a provider to add members to existing objects or define new objects.</span></span> <span data-ttu-id="a0d72-235">Para obtener más información, consulte[extender los tipos de objeto y formato](http://msdn.microsoft.com/en-us/da976d91-a3d6-44e8-affa-466b1e2bd351).</span><span class="sxs-lookup"><span data-stu-id="a0d72-235">For more information, see[Extending Object Types and Formatting](http://msdn.microsoft.com/en-us/da976d91-a3d6-44e8-affa-466b1e2bd351).</span></span>

## <a name="building-the-windows-powershell-provider"></a><span data-ttu-id="a0d72-236">Creación del proveedor de Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="a0d72-236">Building the Windows PowerShell provider</span></span>

<span data-ttu-id="a0d72-237">Para obtener más información, consulte [cómo registrar Cmdlets, proveedores y aplicaciones Host](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c).</span><span class="sxs-lookup"><span data-stu-id="a0d72-237">For more information, see [How to Register Cmdlets, Providers, and Host Applications](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c).</span></span>
<span data-ttu-id="a0d72-238">Para obtener más información, consulte [cómo registrar Cmdlets, proveedores y aplicaciones Host](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c).</span><span class="sxs-lookup"><span data-stu-id="a0d72-238">For more information, see [How to Register Cmdlets, Providers, and Host Applications](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c).</span></span>

## <a name="testing-the-windows-powershell-provider"></a><span data-ttu-id="a0d72-239">Probar el proveedor de Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="a0d72-239">Testing the Windows PowerShell provider</span></span>

<span data-ttu-id="a0d72-240">Cuando se ha registrado el proveedor de Windows PowerShell con Windows PowerShell, puede probarla mediante la ejecución de los cmdlets compatibles en la línea de comandos, incluidos los cmdlets facilitados por derivación.</span><span class="sxs-lookup"><span data-stu-id="a0d72-240">When your Windows PowerShell provider has been registered with Windows PowerShell, you can test it by running the supported cmdlets on the command line, including cmdlets made available by derivation.</span></span> <span data-ttu-id="a0d72-241">En este ejemplo se probará el proveedor de navegación.</span><span class="sxs-lookup"><span data-stu-id="a0d72-241">This example will test the sample navigation provider.</span></span>

1. <span data-ttu-id="a0d72-242">Ejecute el nuevo shell y use el `Set-Location` cmdlet para establecer la ruta de acceso para indicar la base de datos de Access.</span><span class="sxs-lookup"><span data-stu-id="a0d72-242">Run your new shell and use the `Set-Location` cmdlet to set the path to indicate the Access database.</span></span>

   ```powershell
   Set-Location mydb:
   ```

2. <span data-ttu-id="a0d72-243">Ahora ejecute el `Get-Childitem` para recuperar una lista de los elementos de la base de datos, que son las tablas de base de datos disponibles.</span><span class="sxs-lookup"><span data-stu-id="a0d72-243">Now run the `Get-Childitem` cmdlet to retrieve a list of the database items, which are the available database tables.</span></span> <span data-ttu-id="a0d72-244">Para cada tabla, este cmdlet también recupera el número de filas de tabla.</span><span class="sxs-lookup"><span data-stu-id="a0d72-244">For each table, this cmdlet also retrieves the number of table rows.</span></span>

   ```powershell
   Get-ChildItem | Format-Table rowcount,name -AutoSize
   ```

   ```output
   RowCount   Name
   --------   ----
        180   MSysAccessObjects
          0   MSysACEs
          1   MSysCmdbars
          0   MSysIMEXColumns
          0   MSysIMEXSpecs
          0   MSysObjects
          0   MSysQueries
          7   MSysRelationships
          8   Categories
         91   Customers
          9   Employees
       2155   Order Details
        830   Orders
         77   Products
          3   Shippers
         29   Suppliers
   ```

3. <span data-ttu-id="a0d72-245">Use el `Set-Location` cmdlet nuevo para establecer la ubicación de la tabla de datos de empleados.</span><span class="sxs-lookup"><span data-stu-id="a0d72-245">Use the `Set-Location` cmdlet again to set the location of the Employees data table.</span></span>

   ```powershell
   Set-Location Employees
   ```

4. <span data-ttu-id="a0d72-246">Ahora vamos a usar el `Get-Location` para recuperar la ruta de acceso a la tabla Employees.</span><span class="sxs-lookup"><span data-stu-id="a0d72-246">Let's now use the `Get-Location` cmdlet to retrieve the path to the Employees table.</span></span>

   ```powershell
   Get-Location
   ```

   ```output
   Path
   ----
   mydb:\Employees
   ```

5. <span data-ttu-id="a0d72-247">Ahora utilice el `Get-Childitem` se canaliza al cmdlet la `Format-Table` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="a0d72-247">Now use the `Get-Childitem` cmdlet piped to the `Format-Table` cmdlet.</span></span> <span data-ttu-id="a0d72-248">Este conjunto de cmdlets recupera los elementos de la tabla de datos de empleados, que son las filas de tabla.</span><span class="sxs-lookup"><span data-stu-id="a0d72-248">This set of cmdlets retrieves the items for the Employees data table, which are the table rows.</span></span> <span data-ttu-id="a0d72-249">Se les aplica formato según lo especificado por el `Format-Table` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="a0d72-249">They are formatted as specified by the `Format-Table` cmdlet.</span></span>

   ```powershell
   Get-ChildItem | Format-Table rownumber,psiscontainer,data -AutoSize
   ```

   ```output
   RowNumber   PSIsContainer   Data
   ---------   --------------   ----
   0           False            System.Data.DataRow
   1           False            System.Data.DataRow
   2           False            System.Data.DataRow
   3           False            System.Data.DataRow
   4           False            System.Data.DataRow
   5           False            System.Data.DataRow
   6           False            System.Data.DataRow
   7           False            System.Data.DataRow
   8           False            System.Data.DataRow
   ```

6. <span data-ttu-id="a0d72-250">Ahora puede ejecutar el `Get-Item` cmdlet para recuperar los elementos de la fila 0 de la tabla de datos de empleados.</span><span class="sxs-lookup"><span data-stu-id="a0d72-250">You can now run the `Get-Item` cmdlet to retrieve the items for row 0 of the Employees data table.</span></span>

   ```powershell
   Get-Item 0
   ```

   ```output
   PSPath        : AccessDB::C:\PS\Northwind.mdb\Employees\0
   PSParentPath  : AccessDB::C:\PS\Northwind.mdb\Employees
   PSChildName   : 0
   PSDrive       : mydb
   PSProvider    : System.Management.Automation.ProviderInfo
   PSIsContainer : False
   Data           : System.Data.DataRow
   RowNumber      : 0
   ```

7. <span data-ttu-id="a0d72-251">Use el `Get-Item` cmdlet nuevo para recuperar los datos del empleado para los elementos en la fila 0.</span><span class="sxs-lookup"><span data-stu-id="a0d72-251">Use the `Get-Item` cmdlet again to retrieve the employee data for the items in row 0.</span></span>

   ```powershell
   (Get-Item 0).data
   ```

   ```output
   EmployeeID      : 1
   LastName        : Davis
   FirstName       : Sara
   Title           : Sales Representative
   TitleOfCourtesy : Ms.
   BirthDate       : 12/8/1968 12:00:00 AM
   HireDate        : 5/1/1992 12:00:00 AM
   Address         : 4567 Main Street
                     Apt. 2A
   City            : Buffalo
   Region          : NY
   PostalCode      : 98052
   Country         : USA
   HomePhone       : (206) 555-9857
   Extension       : 5467
   Photo           : EmpID1.bmp
   Notes           : Education includes a BA in psychology from
                     Colorado State University. She also completed "The
                     Art of the Cold Call."  Nancy is a member of
                     Toastmasters International.
   ReportsTo       : 2
   ```

## <a name="see-also"></a><span data-ttu-id="a0d72-252">Véase también</span><span class="sxs-lookup"><span data-stu-id="a0d72-252">See Also</span></span>

[<span data-ttu-id="a0d72-253">Crear proveedores de Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="a0d72-253">Creating Windows PowerShell providers</span></span>](./how-to-create-a-windows-powershell-provider.md)

[<span data-ttu-id="a0d72-254">Proveedor de PowerShell de Windows de su diseño</span><span class="sxs-lookup"><span data-stu-id="a0d72-254">Design Your Windows PowerShell provider</span></span>](./designing-your-windows-powershell-provider.md)

[<span data-ttu-id="a0d72-255">Extensión de tipos de objeto y el formato</span><span class="sxs-lookup"><span data-stu-id="a0d72-255">Extending Object Types and Formatting</span></span>](http://msdn.microsoft.com/en-us/da976d91-a3d6-44e8-affa-466b1e2bd351)

[<span data-ttu-id="a0d72-256">Extensión de tipos de objeto y el formato</span><span class="sxs-lookup"><span data-stu-id="a0d72-256">Extending Object Types and Formatting</span></span>](http://msdn.microsoft.com/en-us/da976d91-a3d6-44e8-affa-466b1e2bd351)

[<span data-ttu-id="a0d72-257">Implementar un proveedor de contenedor Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="a0d72-257">Implement a Container Windows PowerShell provider</span></span>](./creating-a-windows-powershell-container-provider.md)

[<span data-ttu-id="a0d72-258">Cómo registrar Cmdlets, proveedores y aplicaciones Host</span><span class="sxs-lookup"><span data-stu-id="a0d72-258">How to Register Cmdlets, Providers, and Host Applications</span></span>](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c)

[<span data-ttu-id="a0d72-259">Cómo registrar Cmdlets, proveedores y aplicaciones Host</span><span class="sxs-lookup"><span data-stu-id="a0d72-259">How to Register Cmdlets, Providers, and Host Applications</span></span>](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c)

[<span data-ttu-id="a0d72-260">Guía del programador de Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="a0d72-260">Windows PowerShell Programmer's Guide</span></span>](./windows-powershell-programmer-s-guide.md)

[<span data-ttu-id="a0d72-261">Windows PowerShell SDK</span><span class="sxs-lookup"><span data-stu-id="a0d72-261">Windows PowerShell SDK</span></span>](../windows-powershell-reference.md)