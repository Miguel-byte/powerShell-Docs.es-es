---
title: Creación de un proveedor de contenedores de Windows PowerShell | Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- providers [PowerShell Programmer's Guide], container provider
- container providers [PowerShell Programmer's Guide]
ms.assetid: a7926647-0d18-45b2-967e-b31f92004bc4
caps.latest.revision: 5
ms.openlocfilehash: 33effed9a96cf1b9ee5f1a50b60a1937526db9d1
ms.sourcegitcommit: e7445ba8203da304286c591ff513900ad1c244a4
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/23/2019
ms.locfileid: "62081910"
---
# <a name="creating-a-windows-powershell-container-provider"></a><span data-ttu-id="f0e46-102">Creación de un proveedor de contenedores de Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="f0e46-102">Creating a Windows PowerShell Container Provider</span></span>

<span data-ttu-id="f0e46-103">Este tema describe cómo crear un proveedor de Windows PowerShell que puede trabajar en almacenes de datos de varias capas.</span><span class="sxs-lookup"><span data-stu-id="f0e46-103">This topic describes how to create a Windows PowerShell provider that can work on multi-layer data stores.</span></span> <span data-ttu-id="f0e46-104">Para este tipo de almacén de datos, el nivel superior de la tienda contiene los elementos raíz y cada nivel posterior se conoce como un nodo de elementos secundarios.</span><span class="sxs-lookup"><span data-stu-id="f0e46-104">For this type of data store, the top level of the store contains the root items and each subsequent level is referred to as a node of child items.</span></span> <span data-ttu-id="f0e46-105">Al permitir al usuario que funcionan en los siguientes nodos secundarios, un usuario puede interactuar de forma jerárquica a través del almacén de datos.</span><span class="sxs-lookup"><span data-stu-id="f0e46-105">By allowing the user to work on these child nodes, a user can interact hierarchically through the data store.</span></span>

<span data-ttu-id="f0e46-106">Los proveedores que pueden trabajar en los almacenes de datos de varios niveles se conocen como proveedores de contenedor de Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="f0e46-106">Providers that can work on multi-level data stores are referred to as Windows PowerShell container providers.</span></span> <span data-ttu-id="f0e46-107">Sin embargo, tenga en cuenta que un proveedor de contenedores de Windows PowerShell puede usarse solo cuando hay un contenedor (no hay contenedores anidados) con los elementos en ella.</span><span class="sxs-lookup"><span data-stu-id="f0e46-107">However, be aware that a Windows PowerShell container provider can be used only when there is one container (no nested containers) with items in it.</span></span> <span data-ttu-id="f0e46-108">Si no hay contenedores anidados, a continuación, debe implementar un proveedor de navegación de Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="f0e46-108">If there are nested containers, then you must implement a Windows PowerShell navigation provider.</span></span> <span data-ttu-id="f0e46-109">Para obtener más información sobre la implementación de proveedor de navegación de Windows PowerShell, consulte [creación de un proveedor de navegación de Windows PowerShell](./creating-a-windows-powershell-navigation-provider.md).</span><span class="sxs-lookup"><span data-stu-id="f0e46-109">For more information about implementing Windows PowerShell navigation provider, see [Creating a Windows PowerShell Navigation Provider](./creating-a-windows-powershell-navigation-provider.md).</span></span>

> [!NOTE]
> <span data-ttu-id="f0e46-110">Puede descargar el C# (AccessDBSampleProvider04.cs) de archivo de código fuente para este proveedor mediante el Microsoft Windows Software Development Kit para Windows Vista y .NET Framework 3.0 Runtime Components.</span><span class="sxs-lookup"><span data-stu-id="f0e46-110">You can download the C# source file (AccessDBSampleProvider04.cs) for this provider using the Microsoft Windows Software Development Kit for Windows Vista and .NET Framework 3.0 Runtime Components.</span></span> <span data-ttu-id="f0e46-111">Para obtener instrucciones de descarga, vea [cómo instalar Windows PowerShell y descarga el SDK de Windows PowerShell](/powershell/developer/installing-the-windows-powershell-sdk).</span><span class="sxs-lookup"><span data-stu-id="f0e46-111">For download instructions, see [How to Install Windows PowerShell and Download the Windows PowerShell SDK](/powershell/developer/installing-the-windows-powershell-sdk).</span></span>
>
> <span data-ttu-id="f0e46-112">Están disponibles en los archivos de origen descargado el  **\<ejemplos de PowerShell >** directory.</span><span class="sxs-lookup"><span data-stu-id="f0e46-112">The downloaded source files are available in the **\<PowerShell Samples>** directory.</span></span>
>
> <span data-ttu-id="f0e46-113">Para obtener más información acerca de otras implementaciones del proveedor de Windows PowerShell, consulte [diseñar su proveedor de Windows PowerShell](./designing-your-windows-powershell-provider.md).</span><span class="sxs-lookup"><span data-stu-id="f0e46-113">For more information about other Windows PowerShell provider implementations, see [Designing Your Windows PowerShell Provider](./designing-your-windows-powershell-provider.md).</span></span>

<span data-ttu-id="f0e46-114">El proveedor de contenedores de Windows PowerShell que se describe aquí, define la base de datos como su contenedor único, con las tablas y filas de la base de datos que se definen como elementos del contenedor.</span><span class="sxs-lookup"><span data-stu-id="f0e46-114">The Windows PowerShell container provider described here defines the database as its single container, with the tables and rows of the database defined as items of the container.</span></span>

> [!CAUTION]
> <span data-ttu-id="f0e46-115">Tenga en cuenta que este diseño considera una base de datos que tiene un campo con el identificador de nombre y que el tipo del campo es LongInteger.</span><span class="sxs-lookup"><span data-stu-id="f0e46-115">Be aware that this design assumes a database that has a field with the name ID, and that the type of the field is LongInteger.</span></span>

<span data-ttu-id="f0e46-116">Esta es una lista de las secciones de este tema.</span><span class="sxs-lookup"><span data-stu-id="f0e46-116">Here is a list of the sections in this topic.</span></span> <span data-ttu-id="f0e46-117">Si no está familiarizado con la escritura de un proveedor de contenedores de Windows PowerShell, lea esta información en el orden en que aparece.</span><span class="sxs-lookup"><span data-stu-id="f0e46-117">If you are unfamiliar with writing a Windows PowerShell container provider, please read this information in the order that it appears.</span></span> <span data-ttu-id="f0e46-118">Sin embargo, si está familiarizado con la escritura de un proveedor de contenedores de Windows PowerShell, vaya directamente a la información que necesita.</span><span class="sxs-lookup"><span data-stu-id="f0e46-118">However, if you are familiar with writing a Windows PowerShell container provider, please go directly to the information that you need.</span></span>

- [<span data-ttu-id="f0e46-119">Definir una clase de proveedor de contenedor de Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="f0e46-119">Defining a Windows PowerShell Container Provider Class</span></span>](#Defining-a-Windows-PowerShell-Container-Provider-Class)

- [<span data-ttu-id="f0e46-120">Definir la funcionalidad de Base</span><span class="sxs-lookup"><span data-stu-id="f0e46-120">Defining Base Functionality</span></span>](#defining-base-functionality)

- [<span data-ttu-id="f0e46-121">Recuperar elementos secundarios</span><span class="sxs-lookup"><span data-stu-id="f0e46-121">Retrieving Child Items</span></span>](#Retrieving-Child-Items)

- [<span data-ttu-id="f0e46-122">Asociar los parámetros dinámicos a la `Get-ChildItem` Cmdlet</span><span class="sxs-lookup"><span data-stu-id="f0e46-122">Attaching Dynamic Parameters to the `Get-ChildItem` Cmdlet</span></span>](#Attaching-Dynamic-Parameters-to-the-Get-ChildItem-Cmdlet)

- [<span data-ttu-id="f0e46-123">Al recuperar los nombres de elementos secundarios</span><span class="sxs-lookup"><span data-stu-id="f0e46-123">Retrieving Child Item Names</span></span>](#Retrieving-Child-Item-Names)

- <span data-ttu-id="f0e46-124">[Asociar los parámetros dinámicos a la `Get-ChildItem` Cmdlet (nombre)](#Attaching-Dynamic-Parameters-to-the-Get-ChildItem-Cmdlet-(Name))</span><span class="sxs-lookup"><span data-stu-id="f0e46-124">[Attaching Dynamic Parameters to the `Get-ChildItem` Cmdlet (Name)](#Attaching-Dynamic-Parameters-to-the-Get-ChildItem-Cmdlet-(Name))</span></span>

- [<span data-ttu-id="f0e46-125">Cambiar nombre de elementos</span><span class="sxs-lookup"><span data-stu-id="f0e46-125">Renaming Items</span></span>](#Renaming-Items)

- [<span data-ttu-id="f0e46-126">Asociar los parámetros dinámicos a la `Rename-Item` Cmdlet</span><span class="sxs-lookup"><span data-stu-id="f0e46-126">Attaching Dynamic Parameters to the  `Rename-Item` Cmdlet</span></span>](#Attaching-Dynamic-Parameters-to-the-Rename-Item-Cmdlet)

- [<span data-ttu-id="f0e46-127">Crear nuevos elementos</span><span class="sxs-lookup"><span data-stu-id="f0e46-127">Creating New Items</span></span>](#Creating-New-Items)

- [<span data-ttu-id="f0e46-128">Asociar los parámetros dinámicos a la `New-Item` Cmdlet</span><span class="sxs-lookup"><span data-stu-id="f0e46-128">Attaching Dynamic Parameters to the `New-Item` Cmdlet</span></span>](#Attaching-Dynamic-Parameters-to-the-New-Item-Cmdlet)

- [<span data-ttu-id="f0e46-129">Quitar elementos de un</span><span class="sxs-lookup"><span data-stu-id="f0e46-129">Removing a Items</span></span>](#Removing-Items)

- [<span data-ttu-id="f0e46-130">Asociar los parámetros dinámicos a la `Remove-Item` Cmdlet</span><span class="sxs-lookup"><span data-stu-id="f0e46-130">Attaching Dynamic Parameters to the `Remove-Item` Cmdlet</span></span>](#Attaching-Dynamic-Parameters-to-the-Remove-Item-Cmdlet)

- [<span data-ttu-id="f0e46-131">Consulta de elementos secundarios</span><span class="sxs-lookup"><span data-stu-id="f0e46-131">Querying for Child Items</span></span>](#Querying-for-Child-Items)

- [<span data-ttu-id="f0e46-132">Copiar elementos</span><span class="sxs-lookup"><span data-stu-id="f0e46-132">Coping Items</span></span>](#Copying-Items)

- [<span data-ttu-id="f0e46-133">Asociar los parámetros dinámicos a la `Copy-Item` Cmdlet</span><span class="sxs-lookup"><span data-stu-id="f0e46-133">Attaching Dynamic Parameters to the  `Copy-Item` Cmdlet</span></span>](#Attaching-Dynamic-Parameters-to-the-Copy-Item-Cmdlet)

- [<span data-ttu-id="f0e46-134">Ejemplo de código</span><span class="sxs-lookup"><span data-stu-id="f0e46-134">Code Sample</span></span>](#Code-Sample)

- [<span data-ttu-id="f0e46-135">Creación del proveedor de Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="f0e46-135">Building the Windows PowerShell Provider</span></span>](#Building-the-Windows-PowerShell-Provider)

- [<span data-ttu-id="f0e46-136">Probar el proveedor de Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="f0e46-136">Testing the Windows PowerShell Provider</span></span>](#Testing-the-Windows-PowerShell-Provider)

## <a name="defining-a-windows-powershell-container-provider-class"></a><span data-ttu-id="f0e46-137">Definir una clase de proveedor de contenedor de Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="f0e46-137">Defining a Windows PowerShell Container Provider Class</span></span>

<span data-ttu-id="f0e46-138">Un proveedor de contenedores de Windows PowerShell debe definir una clase .NET que se deriva de la [System.Management.Automation.Provider.Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider) clase base.</span><span class="sxs-lookup"><span data-stu-id="f0e46-138">A Windows PowerShell container provider must define a .NET class that derives from the [System.Management.Automation.Provider.Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider) base class.</span></span> <span data-ttu-id="f0e46-139">Esta es la definición de clase para el proveedor de contenedores de Windows PowerShell descrito en esta sección.</span><span class="sxs-lookup"><span data-stu-id="f0e46-139">Here is the class definition for the Windows PowerShell container provider described in this section.</span></span>

```csharp
   [CmdletProvider("AccessDB", ProviderCapabilities.None)]
   public class AccessDBProvider : ContainerCmdletProvider
```

[!code-csharp[AccessDBProviderSample04.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample04/AccessDBProviderSample04.cs#L34-L35 "AccessDBProviderSample04.cs")]

<span data-ttu-id="f0e46-140">Tenga en cuenta que en esta definición, de la clase el [System.Management.Automation.Provider.Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) atributo incluye dos parámetros.</span><span class="sxs-lookup"><span data-stu-id="f0e46-140">Notice that in this class definition, the [System.Management.Automation.Provider.Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) attribute includes two parameters.</span></span> <span data-ttu-id="f0e46-141">El primer parámetro especifica un nombre descriptivo para el proveedor que está usando Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="f0e46-141">The first parameter specifies a user-friendly name for the provider that is used by Windows PowerShell.</span></span> <span data-ttu-id="f0e46-142">El segundo parámetro especifica las capacidades específicas de Windows PowerShell que expone el proveedor para el tiempo de ejecución de Windows PowerShell durante el procesamiento de comandos.</span><span class="sxs-lookup"><span data-stu-id="f0e46-142">The second parameter specifies the Windows PowerShell specific capabilities that the provider exposes to the Windows PowerShell runtime during command processing.</span></span> <span data-ttu-id="f0e46-143">Para este proveedor, no hay ningún funcionalidades específicas de Windows PowerShell que se agregan.</span><span class="sxs-lookup"><span data-stu-id="f0e46-143">For this provider, there are no Windows PowerShell specific capabilities that are added.</span></span>

## <a name="defining-base-functionality"></a><span data-ttu-id="f0e46-144">Definir la funcionalidad de Base</span><span class="sxs-lookup"><span data-stu-id="f0e46-144">Defining Base Functionality</span></span>

<span data-ttu-id="f0e46-145">Como se describe en [diseñar su proveedor de Windows PowerShell](./designing-your-windows-powershell-provider.md), [System.Management.Automation.Provider.Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider) clase se deriva de varias clases que proporcionan funcionalidad proveedor diferente.</span><span class="sxs-lookup"><span data-stu-id="f0e46-145">As described in [Designing Your Windows PowerShell Provider](./designing-your-windows-powershell-provider.md), the [System.Management.Automation.Provider.Containercmdletprovider](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider) class derives from several other classes that provided different provider functionality.</span></span> <span data-ttu-id="f0e46-146">Un proveedor de contenedor de Windows PowerShell, por lo tanto, tiene que definir toda la funcionalidad proporcionada por esas clases.</span><span class="sxs-lookup"><span data-stu-id="f0e46-146">A Windows PowerShell container provider, therefore, needs to define all of the functionality provided by those classes.</span></span>

<span data-ttu-id="f0e46-147">Para implementar la funcionalidad para agregar información de inicialización específicas de la sesión y para liberar los recursos utilizados por el proveedor, consulte [creación de un proveedor de PowerShell de Windows básico](./creating-a-basic-windows-powershell-provider.md).</span><span class="sxs-lookup"><span data-stu-id="f0e46-147">To implement functionality for adding session-specific initialization information and for releasing resources that are used by the provider, see [Creating a Basic Windows PowerShell Provider](./creating-a-basic-windows-powershell-provider.md).</span></span> <span data-ttu-id="f0e46-148">Sin embargo, la mayoría de proveedores (incluido el proveedor que se describe aquí) puede usar la implementación predeterminada de esta funcionalidad proporcionada por Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="f0e46-148">However, most providers (including the provider described here) can use the default implementation of this functionality that is provided by Windows PowerShell.</span></span>

<span data-ttu-id="f0e46-149">Para obtener acceso al almacén de datos, el proveedor debe implementar los métodos de la [System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) clase base.</span><span class="sxs-lookup"><span data-stu-id="f0e46-149">To get access to the data store, the provider must implement the methods of the [System.Management.Automation.Provider.Drivecmdletprovider](/dotnet/api/System.Management.Automation.Provider.DriveCmdletProvider) base class.</span></span> <span data-ttu-id="f0e46-150">Para obtener más información acerca de cómo implementar estos métodos, consulte [creación de un proveedor de la unidad de Windows PowerShell](./creating-a-windows-powershell-drive-provider.md).</span><span class="sxs-lookup"><span data-stu-id="f0e46-150">For more information about implementing these methods, see [Creating an Windows PowerShell Drive Provider](./creating-a-windows-powershell-drive-provider.md).</span></span>

<span data-ttu-id="f0e46-151">Para manipular los elementos de un almacén de datos, como introducción, configuración y elementos de compensación, el proveedor debe implementar los métodos proporcionados por el [System.Management.Automation.Provider.Itemcmdletprovider](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider) clase base.</span><span class="sxs-lookup"><span data-stu-id="f0e46-151">To manipulate the items of a data store, such as getting, setting, and clearing items, the provider must implement the methods provided by the [System.Management.Automation.Provider.Itemcmdletprovider](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider) base class.</span></span> <span data-ttu-id="f0e46-152">Para obtener más información acerca de cómo implementar estos métodos, consulte [creación de un proveedor de elementos de Windows PowerShell](./creating-a-windows-powershell-item-provider.md).</span><span class="sxs-lookup"><span data-stu-id="f0e46-152">For more information about implementing these methods, see [Creating an Windows PowerShell Item Provider](./creating-a-windows-powershell-item-provider.md).</span></span>

## <a name="retrieving-child-items"></a><span data-ttu-id="f0e46-153">Recuperar elementos secundarios</span><span class="sxs-lookup"><span data-stu-id="f0e46-153">Retrieving Child Items</span></span>

<span data-ttu-id="f0e46-154">Para recuperar un elemento secundario, debe invalidar el proveedor de contenedores de Windows PowerShell la [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) método para admitir llamadas desde el `Get-ChildItem` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="f0e46-154">To retrieve a child item, the Windows PowerShell container provider must override the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method to support calls from the `Get-ChildItem` cmdlet.</span></span> <span data-ttu-id="f0e46-155">Este método recupera los elementos secundarios del almacén de datos y los escribe en la canalización como objetos.</span><span class="sxs-lookup"><span data-stu-id="f0e46-155">This method retrieves child items from the data store and writes them to the pipeline as objects.</span></span> <span data-ttu-id="f0e46-156">Si el `recurse` se especifica el parámetro del cmdlet, el método recupera todos los elementos secundarios, independientemente de qué nivel se encuentran en.</span><span class="sxs-lookup"><span data-stu-id="f0e46-156">If the `recurse` parameter of the cmdlet is specified, the method retrieves all children regardless of what level they are at.</span></span> <span data-ttu-id="f0e46-157">Si el `recurse` parámetro no se especifica, el método recupera sólo un único nivel de elementos secundarios.</span><span class="sxs-lookup"><span data-stu-id="f0e46-157">If the `recurse` parameter is not specified, the method retrieves only a single level of children.</span></span>

<span data-ttu-id="f0e46-158">Esta es la implementación de la [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) método para este proveedor.</span><span class="sxs-lookup"><span data-stu-id="f0e46-158">Here is the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method for this provider.</span></span> <span data-ttu-id="f0e46-159">Tenga en cuenta que este método recupera los elementos secundarios de todas las tablas de base de datos cuando la ruta de acceso indica la base de datos de Access y recupera los elementos secundarios de las filas de la tabla si la ruta de acceso indica una tabla de datos.</span><span class="sxs-lookup"><span data-stu-id="f0e46-159">Notice that this method retrieves the child items in all database tables when the path indicates the Access database, and retrieves the child items from the rows of that table if the path indicates a data table.</span></span>

```csharp
protected override void GetChildItems(string path, bool recurse)
{
    // If path represented is a drive then the children in the path are
    // tables. Hence all tables in the drive represented will have to be
    // returned
    if (PathIsDrive(path))
    {
        foreach (DatabaseTableInfo table in GetTables())
        {
            WriteItemObject(table, path, true);

            // if the specified item exists and recurse has been set then
            // all child items within it have to be obtained as well
            if (ItemExists(path) && recurse)
            {
                GetChildItems(path + pathSeparator + table.Name, recurse);
            }
        } // foreach (DatabaseTableInfo...
    } // if (PathIsDrive...
    else
    {
        // Get the table name, row number and type of path from the
        // path specified
        string tableName;
        int rowNumber;

        PathType type = GetNamesFromPath(path, out tableName, out rowNumber);

        if (type == PathType.Table)
        {
            // Obtain all the rows within the table
            foreach (DatabaseRowInfo row in GetRows(tableName))
            {
                WriteItemObject(row, path + pathSeparator + row.RowNumber,
                        false);
            } // foreach (DatabaseRowInfo...
        }
        else if (type == PathType.Row)
        {
            // In this case the user has directly specified a row, hence
            // just give that particular row
            DatabaseRowInfo row = GetRow(tableName, rowNumber);
            WriteItemObject(row, path + pathSeparator + row.RowNumber,
                        false);
        }
        else
        {
            // In this case, the path specified is not valid
            ThrowTerminatingInvalidPathException(path);
        }
    } // else
} // GetChildItems
```

[!code-csharp[AccessDBProviderSample04.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample04/AccessDBProviderSample04.cs#L311-L362 "AccessDBProviderSample04.cs")]

#### <a name="things-to-remember-about-implementing-getchilditems"></a><span data-ttu-id="f0e46-160">Cosas que recordar acerca de cómo implementar GetChildItems</span><span class="sxs-lookup"><span data-stu-id="f0e46-160">Things to Remember About Implementing GetChildItems</span></span>

<span data-ttu-id="f0e46-161">Las siguientes condiciones pueden aplicarse a la implementación de [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems):</span><span class="sxs-lookup"><span data-stu-id="f0e46-161">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems):</span></span>

- <span data-ttu-id="f0e46-162">Al definir la clase de proveedor, un proveedor de contenedores de Windows PowerShell puede declarar las capacidades del proveedor de ExpandWildcards, filtro, Include o Exclude, desde el [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeración.</span><span class="sxs-lookup"><span data-stu-id="f0e46-162">When defining the provider class, a Windows PowerShell container provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="f0e46-163">En estos casos, la implementación de la [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) debe asegurarse de que la ruta de acceso que se pasa al método cumple los requisitos del elemento especificado (método) capacidades.</span><span class="sxs-lookup"><span data-stu-id="f0e46-163">In these cases, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="f0e46-164">Para ello, el método debe tener acceso a la propiedad adecuada, por ejemplo, el [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) y [ System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) propiedades.</span><span class="sxs-lookup"><span data-stu-id="f0e46-164">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="f0e46-165">La implementación de este método debe tener en cuenta cualquier forma de acceso al elemento que podría hacer que el elemento visible para el usuario.</span><span class="sxs-lookup"><span data-stu-id="f0e46-165">The implementation of this method should take into account any form of access to the item that might make the item visible to the user.</span></span> <span data-ttu-id="f0e46-166">Por ejemplo, si un usuario tiene acceso de escritura a un archivo mediante el proveedor FileSystem (proporcionado por Windows PowerShell), pero no el acceso de lectura, el archivo sigue existiendo y [System.Management.Automation.Provider.Itemcmdletprovider.Itemexists\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists) devuelve `true`.</span><span class="sxs-lookup"><span data-stu-id="f0e46-166">For example, if a user has write access to a file through the FileSystem provider (supplied by Windows PowerShell), but not read access, the file still exists and [System.Management.Automation.Provider.Itemcmdletprovider.Itemexists\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.ItemExists) returns `true`.</span></span> <span data-ttu-id="f0e46-167">Su implementación podría requerir la comprobación de un elemento primario para ver si se puede enumerar el elemento secundario.</span><span class="sxs-lookup"><span data-stu-id="f0e46-167">Your implementation might require the checking of a parent item to see if the child can be enumerated.</span></span>

- <span data-ttu-id="f0e46-168">Al escribir varios elementos, el [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) método puede tardar algún tiempo.</span><span class="sxs-lookup"><span data-stu-id="f0e46-168">When writing multiple items, the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method can take some time.</span></span> <span data-ttu-id="f0e46-169">Puede diseñar su proveedor para escribir los elementos mediante el [System.Management.Automation.Provider.Cmdletprovider.Writeitemobject\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteItemObject) método a la vez.</span><span class="sxs-lookup"><span data-stu-id="f0e46-169">You can design your provider to write the items using the [System.Management.Automation.Provider.Cmdletprovider.Writeitemobject\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.WriteItemObject) method one at a time.</span></span> <span data-ttu-id="f0e46-170">Con esta técnica se presentan los elementos al usuario en una secuencia.</span><span class="sxs-lookup"><span data-stu-id="f0e46-170">Using this technique will present the items to the user in a stream.</span></span>

- <span data-ttu-id="f0e46-171">La implementación de [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) es responsable de evitar una recursión infinita cuando hay vínculos circulares y similares.</span><span class="sxs-lookup"><span data-stu-id="f0e46-171">Your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) is responsible for preventing infinite recursion when there are circular links, and the like.</span></span> <span data-ttu-id="f0e46-172">Debe iniciará una excepción de terminación adecuada para reflejar una condición de ese tipo.</span><span class="sxs-lookup"><span data-stu-id="f0e46-172">An appropriate terminating exception should be thrown to reflect such a condition.</span></span>

## <a name="attaching-dynamic-parameters-to-the-get-childitem-cmdlet"></a><span data-ttu-id="f0e46-173">Asociar los parámetros dinámicos al Cmdlet Get-ChildItem</span><span class="sxs-lookup"><span data-stu-id="f0e46-173">Attaching Dynamic Parameters to the Get-ChildItem Cmdlet</span></span>

<span data-ttu-id="f0e46-174">A veces la `Get-ChildItem` cmdlet que llama a [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) requiere parámetros adicionales que se especifican de forma dinámica en tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="f0e46-174">Sometimes the `Get-ChildItem` cmdlet that calls [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="f0e46-175">Para proporcionar estos parámetros dinámicos, debe implementar el proveedor de contenedores de Windows PowerShell la [System.Management.Automation.Provider.Containercmdletprovider.Getchilditemsdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItemsDynamicParameters) método.</span><span class="sxs-lookup"><span data-stu-id="f0e46-175">To provide these dynamic parameters, the Windows PowerShell container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditemsdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItemsDynamicParameters) method.</span></span> <span data-ttu-id="f0e46-176">Este método recupera los parámetros dinámicos para el elemento situado en la ruta de acceso indicada y devuelve un objeto que tiene las propiedades y campos con atributos similares a una clase de cmdlet de análisis o un [ System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) objeto.</span><span class="sxs-lookup"><span data-stu-id="f0e46-176">This method retrieves dynamic parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="f0e46-177">El tiempo de ejecución de Windows PowerShell usa el objeto devuelto para agregar los parámetros para el `Get-ChildItem` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="f0e46-177">The Windows PowerShell runtime uses the returned object to add the parameters to the `Get-ChildItem` cmdlet.</span></span>

<span data-ttu-id="f0e46-178">Este proveedor de contenedores de Windows PowerShell no implementa este método.</span><span class="sxs-lookup"><span data-stu-id="f0e46-178">This Windows PowerShell container provider does not implement this method.</span></span> <span data-ttu-id="f0e46-179">Sin embargo, el código siguiente es la implementación predeterminada de este método.</span><span class="sxs-lookup"><span data-stu-id="f0e46-179">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidergetchilditemsdynamicparameters](Msh_samplestestcmdlets#testprovidergetchilditemsdynamicparameters)]  -->

## <a name="retrieving-child-item-names"></a><span data-ttu-id="f0e46-180">Al recuperar los nombres de elementos secundarios</span><span class="sxs-lookup"><span data-stu-id="f0e46-180">Retrieving Child Item Names</span></span>

<span data-ttu-id="f0e46-181">Para recuperar los nombres de elementos secundarios, debe invalidar el proveedor de contenedores de Windows PowerShell la [System.Management.Automation.Provider.Containercmdletprovider.Getchildnames\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) método para admitir llamadas desde el `Get-ChildItem`cmdlet cuando su `Name` se especifica el parámetro.</span><span class="sxs-lookup"><span data-stu-id="f0e46-181">To retrieve the names of child items, the Windows PowerShell container provider must override the [System.Management.Automation.Provider.Containercmdletprovider.Getchildnames\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) method to support calls from the `Get-ChildItem` cmdlet when its `Name` parameter is specified.</span></span> <span data-ttu-id="f0e46-182">Este método recupera los nombres de los elementos secundarios de los nombres de elemento secundario o de ruta de acceso especificados para todos los contenedores si el `returnAllContainers` se especifica el parámetro del cmdlet.</span><span class="sxs-lookup"><span data-stu-id="f0e46-182">This method retrieves the names of the child items for the specified path or child item names for all containers if the `returnAllContainers` parameter of the cmdlet is specified.</span></span> <span data-ttu-id="f0e46-183">Un nombre de elemento secundario es la parte de la hoja de una ruta de acceso.</span><span class="sxs-lookup"><span data-stu-id="f0e46-183">A child name is the leaf portion of a path.</span></span> <span data-ttu-id="f0e46-184">Por ejemplo, el nombre de elemento secundario para la ruta de acceso de c:\windows\system32\abc.dll es "abc.dll".</span><span class="sxs-lookup"><span data-stu-id="f0e46-184">For example, the child name for the path c:\windows\system32\abc.dll is "abc.dll".</span></span> <span data-ttu-id="f0e46-185">El nombre de elemento secundario para el directorio de c:\windows\system32 es "system32".</span><span class="sxs-lookup"><span data-stu-id="f0e46-185">The child name for the directory c:\windows\system32 is "system32".</span></span>

<span data-ttu-id="f0e46-186">Esta es la implementación de la [System.Management.Automation.Provider.Containercmdletprovider.Getchildnames\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) método para este proveedor.</span><span class="sxs-lookup"><span data-stu-id="f0e46-186">Here is the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchildnames\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) method for this provider.</span></span> <span data-ttu-id="f0e46-187">Tenga en cuenta que el método recupera los nombres de tabla si la ruta de acceso especificada indica la base de datos de Access (unidad) y los números de fila si la ruta de acceso indica una tabla.</span><span class="sxs-lookup"><span data-stu-id="f0e46-187">Notice that the method retrieves table names if the specified path indicates the Access database (drive) and row numbers if the path indicates a table.</span></span>

```csharp
protected override void GetChildNames(string path,
                            ReturnContainers returnContainers)
{
    // If the path represented is a drive, then the child items are
    // tables. get the names of all the tables in the drive.
    if (PathIsDrive(path))
    {
        foreach (DatabaseTableInfo table in GetTables())
        {
            WriteItemObject(table.Name, path, true);
        } // foreach (DatabaseTableInfo...
    } // if (PathIsDrive...
    else
    {
        // Get type, table name and row number from path specified
        string tableName;
        int rowNumber;

        PathType type = GetNamesFromPath(path, out tableName, out rowNumber);

        if (type == PathType.Table)
        {
            // Get all the rows in the table and then write out the
            // row numbers.
            foreach (DatabaseRowInfo row in GetRows(tableName))
            {
                WriteItemObject(row.RowNumber, path, false);
            } // foreach (DatabaseRowInfo...
        }
        else if (type == PathType.Row)
        {
            // In this case the user has directly specified a row, hence
            // just give that particular row
            DatabaseRowInfo row = GetRow(tableName, rowNumber);

            WriteItemObject(row.RowNumber, path, false);
        }
        else
        {
            ThrowTerminatingInvalidPathException(path);
        }
    } // else
} // GetChildNames
```

[!code-csharp[AccessDBProviderSample04.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample04/AccessDBProviderSample04.cs#L369-L411 "AccessDBProviderSample04.cs")]

#### <a name="things-to-remember-about-implementing-getchildnames"></a><span data-ttu-id="f0e46-188">Cosas que recordar acerca de cómo implementar GetChildNames</span><span class="sxs-lookup"><span data-stu-id="f0e46-188">Things to Remember About Implementing GetChildNames</span></span>

<span data-ttu-id="f0e46-189">Las siguientes condiciones pueden aplicarse a la implementación de [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems):</span><span class="sxs-lookup"><span data-stu-id="f0e46-189">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems):</span></span>

- <span data-ttu-id="f0e46-190">Al definir la clase de proveedor, un proveedor de contenedores de Windows PowerShell puede declarar las capacidades del proveedor de ExpandWildcards, filtro, Include o Exclude, desde el [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeración.</span><span class="sxs-lookup"><span data-stu-id="f0e46-190">When defining the provider class, a Windows PowerShell container provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="f0e46-191">En estos casos, la implementación de la [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) debe asegurarse de que la ruta de acceso que se pasa al método cumple los requisitos del elemento especificado (método) capacidades.</span><span class="sxs-lookup"><span data-stu-id="f0e46-191">In these cases, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="f0e46-192">Para ello, el método debe tener acceso a la propiedad adecuada, por ejemplo, el [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) y [ System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) propiedades.</span><span class="sxs-lookup"><span data-stu-id="f0e46-192">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

  > [!NOTE]
  > <span data-ttu-id="f0e46-193">Se produce una excepción a esta regla cuando el `returnAllContainers` se especifica el parámetro del cmdlet.</span><span class="sxs-lookup"><span data-stu-id="f0e46-193">An exception to this rule occurs when the `returnAllContainers` parameter of the cmdlet is specified.</span></span> <span data-ttu-id="f0e46-194">En este caso, el método debe recuperar cualquier nombre de elemento secundario de un contenedor, incluso si no coincide con los valores de la [System.Management.Automation.Provider.Cmdletprovider.Filter\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Filter), [ System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include), o [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) propiedades.</span><span class="sxs-lookup"><span data-stu-id="f0e46-194">In this case, the method should retrieve any child name for a container, even if it does not match the values of the [System.Management.Automation.Provider.Cmdletprovider.Filter\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Filter), [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include), or [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) properties.</span></span>

- <span data-ttu-id="f0e46-195">De forma predeterminada, las invalidaciones de este método no deben recuperar los nombres de objetos que se ocultan generalmente el usuario a menos que el [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) se especifica la propiedad.</span><span class="sxs-lookup"><span data-stu-id="f0e46-195">By default, overrides of this method should not retrieve names of objects that are generally hidden from the user unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is specified.</span></span> <span data-ttu-id="f0e46-196">Si la ruta de acceso especificada indica un contenedor, el [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) propiedad no es necesaria.</span><span class="sxs-lookup"><span data-stu-id="f0e46-196">If the specified path indicates a container, the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is not required.</span></span>

- <span data-ttu-id="f0e46-197">La implementación de [System.Management.Automation.Provider.Containercmdletprovider.Getchildnames\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) es responsable de evitar una recursión infinita cuando hay vínculos circulares y similares.</span><span class="sxs-lookup"><span data-stu-id="f0e46-197">Your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Getchildnames\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNames) is responsible for preventing infinite recursion when there are circular links, and the like.</span></span> <span data-ttu-id="f0e46-198">Debe iniciará una excepción de terminación adecuada para reflejar una condición de ese tipo.</span><span class="sxs-lookup"><span data-stu-id="f0e46-198">An appropriate terminating exception should be thrown to reflect such a condition.</span></span>

## <a name="attaching-dynamic-parameters-to-the-get-childitem-cmdlet-name"></a><span data-ttu-id="f0e46-199">Asociar los parámetros dinámicos al Cmdlet Get-ChildItem (nombre)</span><span class="sxs-lookup"><span data-stu-id="f0e46-199">Attaching Dynamic Parameters to the Get-ChildItem Cmdlet (Name)</span></span>

<span data-ttu-id="f0e46-200">A veces la `Get-ChildItem` cmdlet (con el `Name` parámetro) requiere parámetros adicionales que se especifican de forma dinámica en tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="f0e46-200">Sometimes the `Get-ChildItem` cmdlet (with the `Name` parameter) requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="f0e46-201">Para proporcionar estos parámetros dinámicos, debe implementar el proveedor de contenedores de Windows PowerShell la [System.Management.Automation.Provider.Containercmdletprovider.Getchildnamesdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNamesDynamicParameters) método.</span><span class="sxs-lookup"><span data-stu-id="f0e46-201">To provide these dynamic parameters, the Windows PowerShell container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Getchildnamesdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildNamesDynamicParameters) method.</span></span> <span data-ttu-id="f0e46-202">Este método recupera los parámetros dinámicos para el elemento situado en la ruta de acceso indicada y devuelve un objeto que tiene las propiedades y campos con atributos similares a una clase de cmdlet de análisis o un [ System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) objeto.</span><span class="sxs-lookup"><span data-stu-id="f0e46-202">This method retrieves the dynamic parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="f0e46-203">El tiempo de ejecución de Windows PowerShell usa el objeto devuelto para agregar los parámetros para el `Get-ChildItem` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="f0e46-203">The Windows PowerShell runtime uses the returned object to add the parameters to the `Get-ChildItem` cmdlet.</span></span>

<span data-ttu-id="f0e46-204">Este proveedor no implementa este método.</span><span class="sxs-lookup"><span data-stu-id="f0e46-204">This provider does not implement this method.</span></span> <span data-ttu-id="f0e46-205">Sin embargo, el código siguiente es la implementación predeterminada de este método.</span><span class="sxs-lookup"><span data-stu-id="f0e46-205">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidergetchildnamesdynamicparameters](Msh_samplestestcmdlets#testprovidergetchildnamesdynamicparameters)]  -->

## <a name="renaming-items"></a><span data-ttu-id="f0e46-206">Cambiar nombre de elementos</span><span class="sxs-lookup"><span data-stu-id="f0e46-206">Renaming Items</span></span>

<span data-ttu-id="f0e46-207">Para cambiar el nombre de un elemento, un proveedor de contenedores de Windows PowerShell debe invalidar el [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) método para admitir llamadas desde el `Rename-Item` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="f0e46-207">To rename an item, a Windows PowerShell container provider must override the [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) method to support calls from the `Rename-Item` cmdlet.</span></span> <span data-ttu-id="f0e46-208">Este método cambia el nombre del elemento en la ruta de acceso especificada para el nuevo nombre proporcionado.</span><span class="sxs-lookup"><span data-stu-id="f0e46-208">This method changes the name of the item at the specified path to the new name provided.</span></span> <span data-ttu-id="f0e46-209">Siempre debe ser el nuevo nombre en relación con el elemento primario (contenedor).</span><span class="sxs-lookup"><span data-stu-id="f0e46-209">The new name must always be relative to the parent item (container).</span></span>

<span data-ttu-id="f0e46-210">Este proveedor no invalida el [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) método.</span><span class="sxs-lookup"><span data-stu-id="f0e46-210">This provider does not override the [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) method.</span></span> <span data-ttu-id="f0e46-211">Sin embargo, la siguiente es la implementación predeterminada.</span><span class="sxs-lookup"><span data-stu-id="f0e46-211">However, the following is the default implementation.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testproviderrenameitem](Msh_samplestestcmdlets#testproviderrenameitem)]  -->

#### <a name="things-to-remember-about-implementing-renameitem"></a><span data-ttu-id="f0e46-212">Cosas que recordar acerca de cómo implementar RenameItem</span><span class="sxs-lookup"><span data-stu-id="f0e46-212">Things to Remember About Implementing RenameItem</span></span>

<span data-ttu-id="f0e46-213">Las siguientes condiciones pueden aplicarse a la implementación de [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem):</span><span class="sxs-lookup"><span data-stu-id="f0e46-213">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem):</span></span>

- <span data-ttu-id="f0e46-214">Al definir la clase de proveedor, un proveedor de contenedores de Windows PowerShell puede declarar las capacidades del proveedor de ExpandWildcards, filtro, Include o Exclude, desde el [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeración.</span><span class="sxs-lookup"><span data-stu-id="f0e46-214">When defining the provider class, a Windows PowerShell container provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="f0e46-215">En estos casos, la implementación de la [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) debe asegurarse de que la ruta de acceso que se pasa al método cumple los requisitos del elemento especificado (método) capacidades.</span><span class="sxs-lookup"><span data-stu-id="f0e46-215">In these cases, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="f0e46-216">Para ello, el método debe tener acceso a la propiedad adecuada, por ejemplo, el [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) y [ System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) propiedades.</span><span class="sxs-lookup"><span data-stu-id="f0e46-216">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="f0e46-217">El [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) método está pensado para la modificación del nombre de un solo producto y no para las operaciones de movimiento.</span><span class="sxs-lookup"><span data-stu-id="f0e46-217">The [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) method is intended for the modification of the name of an item only, and not for move operations.</span></span> <span data-ttu-id="f0e46-218">La implementación del método debe escribir un error si el `newName` parámetro contiene separadores de ruta de acceso, o pueden provocar el elemento para cambiar su ubicación principal.</span><span class="sxs-lookup"><span data-stu-id="f0e46-218">Your implementation of the method should write an error if the `newName` parameter contains path separators, or might otherwise cause the item to change its parent location.</span></span>

- <span data-ttu-id="f0e46-219">De forma predeterminada, las invalidaciones de este método deben no cambiar el nombre de los objetos a menos que el [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) se especifica la propiedad.</span><span class="sxs-lookup"><span data-stu-id="f0e46-219">By default, overrides of this method should not rename objects unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is specified.</span></span> <span data-ttu-id="f0e46-220">Si la ruta de acceso especificada indica un contenedor, el [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) propiedad no es necesaria.</span><span class="sxs-lookup"><span data-stu-id="f0e46-220">If the specified path indicates a container, the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is not required.</span></span>

- <span data-ttu-id="f0e46-221">La implementación de la [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) debe llamar al método [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) y comprobar su valor devuelto antes de realizar cualquier cambio en el almacén de datos.</span><span class="sxs-lookup"><span data-stu-id="f0e46-221">Your implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) method should call [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and check its return value before making any changes to the data store.</span></span> <span data-ttu-id="f0e46-222">Este método se utiliza para confirmar la ejecución de una operación cuando se modifica el estado del sistema, por ejemplo, cambiar el nombre de archivos.</span><span class="sxs-lookup"><span data-stu-id="f0e46-222">This method is used to confirm execution of an operation when a change is made to system state, for example, renaming files.</span></span> <span data-ttu-id="f0e46-223">[System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) envía el nombre del recurso que se puede cambiar para el usuario, con el tiempo de ejecución de Windows PowerShell teniendo en cuenta cualquier configuración de línea de comandos o variables de preferencia en determinar lo que debe mostrarse.</span><span class="sxs-lookup"><span data-stu-id="f0e46-223">[System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) sends the name of the resource to be changed to the user, with the Windows PowerShell runtime taking into account any command line settings or preference variables in determining what should be displayed.</span></span>

  <span data-ttu-id="f0e46-224">Después de llamar a [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) devuelve `true`, [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) debe llamar al método el [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) método.</span><span class="sxs-lookup"><span data-stu-id="f0e46-224">After the call to [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns `true`, the [System.Management.Automation.Provider.Containercmdletprovider.Renameitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItem) method should call the [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method.</span></span> <span data-ttu-id="f0e46-225">Este método envía un mensaje en un mensaje de confirmación al usuario para que los comentarios adicionales que decir si debe continuarse la operación.</span><span class="sxs-lookup"><span data-stu-id="f0e46-225">This method sends a message a confirmation message to the user to allow additional feedback to say if the operation should be continued.</span></span> <span data-ttu-id="f0e46-226">Debe llamar un proveedor [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) como una comprobación adicional para las modificaciones del sistema potencialmente peligrosos.</span><span class="sxs-lookup"><span data-stu-id="f0e46-226">A provider should call [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) as an additional check for potentially dangerous system modifications.</span></span>

## <a name="attaching-dynamic-parameters-to-the-rename-item-cmdlet"></a><span data-ttu-id="f0e46-227">Asociar los parámetros dinámicos para el Cmdlet Rename-Item</span><span class="sxs-lookup"><span data-stu-id="f0e46-227">Attaching Dynamic Parameters to the Rename-Item Cmdlet</span></span>

<span data-ttu-id="f0e46-228">A veces la `Rename-Item` cmdlet requiere parámetros adicionales que se especifican de forma dinámica en tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="f0e46-228">Sometimes the `Rename-Item` cmdlet requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="f0e46-229">Para proporcionar estos parámetros dinámicos, debe implementar el proveedor de contenedores de Windows PowerShell la [System.Management.Automation.Provider.Containercmdletprovider.Renameitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItemDynamicParameters) método.</span><span class="sxs-lookup"><span data-stu-id="f0e46-229">To provide these dynamic parameters, Windows PowerShell container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Renameitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RenameItemDynamicParameters) method.</span></span> <span data-ttu-id="f0e46-230">Este método recupera los parámetros para el elemento situado en la ruta de acceso indicada y devuelve un objeto que tiene las propiedades y campos con atributos similares a una clase de cmdlet de análisis o un [System.Management.Automation.Runtimedefinedparameterdictionary ](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) objeto.</span><span class="sxs-lookup"><span data-stu-id="f0e46-230">This method retrieves the parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="f0e46-231">El tiempo de ejecución de Windows PowerShell usa el objeto devuelto para agregar los parámetros para el `Rename-Item` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="f0e46-231">The Windows PowerShell runtime uses the returned object to add the parameters to the `Rename-Item` cmdlet.</span></span>

<span data-ttu-id="f0e46-232">Este proveedor de contenedor no implementa este método.</span><span class="sxs-lookup"><span data-stu-id="f0e46-232">This container provider does not implement this method.</span></span> <span data-ttu-id="f0e46-233">Sin embargo, el código siguiente es la implementación predeterminada de este método.</span><span class="sxs-lookup"><span data-stu-id="f0e46-233">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testproviderrenameitemdynamicparameters](Msh_samplestestcmdlets#testproviderrenameitemdynamicparameters)]  -->

## <a name="creating-new-items"></a><span data-ttu-id="f0e46-234">Crear nuevos elementos</span><span class="sxs-lookup"><span data-stu-id="f0e46-234">Creating New Items</span></span>

<span data-ttu-id="f0e46-235">Para crear nuevos elementos, debe implementar un proveedor de contenedores de la [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) método para admitir llamadas desde el `New-Item` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="f0e46-235">To create new items, a container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method to support calls from the `New-Item` cmdlet.</span></span> <span data-ttu-id="f0e46-236">Este método crea un elemento de datos ubicado en la ruta de acceso especificada.</span><span class="sxs-lookup"><span data-stu-id="f0e46-236">This method creates a data item located at the specified path.</span></span> <span data-ttu-id="f0e46-237">El `type` parámetro del cmdlet contiene el tipo definido por el proveedor para el nuevo elemento.</span><span class="sxs-lookup"><span data-stu-id="f0e46-237">The `type` parameter of the cmdlet contains the provider-defined type for the new item.</span></span> <span data-ttu-id="f0e46-238">Por ejemplo, el proveedor de sistema de archivos usa un `type` parámetro con un valor "file" o "directory".</span><span class="sxs-lookup"><span data-stu-id="f0e46-238">For example, the FileSystem provider uses a `type` parameter with a value of "file" or "directory".</span></span> <span data-ttu-id="f0e46-239">El `newItemValue` parámetro del cmdlet especifica un valor específico del proveedor para el nuevo elemento.</span><span class="sxs-lookup"><span data-stu-id="f0e46-239">The `newItemValue` parameter of the cmdlet specifies a provider-specific value for the new item.</span></span>

<span data-ttu-id="f0e46-240">Esta es la implementación de la [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) método para este proveedor.</span><span class="sxs-lookup"><span data-stu-id="f0e46-240">Here is the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method for this provider.</span></span>

```csharp
protected override void NewItem( string path, string type,
                                 object newItemValue )
{
    // Create the new item here after
    // performing necessary validations
    //
    // WriteItemObject(newItemValue, path, false);

    // Example
    //
    // if (ShouldProcess(path, "new item"))
    // {
    //      // Create a new item and then call WriteObject
    //      WriteObject(newItemValue, path, false);
    // }

} // NewItem
```

[!code-csharp[AccessDBProviderSample04.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample04/AccessDBProviderSample04.cs#L939-L955 "AccessDBProviderSample04.cs")]

#### <a name="things-to-remember-about-implementing-newitem"></a><span data-ttu-id="f0e46-241">Cosas que recordar acerca de cómo implementar el nuevo elemento</span><span class="sxs-lookup"><span data-stu-id="f0e46-241">Things to Remember About Implementing NewItem</span></span>

<span data-ttu-id="f0e46-242">Las siguientes condiciones pueden aplicarse a la implementación de [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem):</span><span class="sxs-lookup"><span data-stu-id="f0e46-242">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem):</span></span>

- <span data-ttu-id="f0e46-243">El [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) método debe realizar una comparación entre mayúsculas y minúsculas de la cadena pasada en el `type` parámetro.</span><span class="sxs-lookup"><span data-stu-id="f0e46-243">The [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method should perform a case-insensitive comparison of the string passed in the `type` parameter.</span></span> <span data-ttu-id="f0e46-244">También debe permitir coincidencias menos ambiguo.</span><span class="sxs-lookup"><span data-stu-id="f0e46-244">It should also allow for least ambiguous matches.</span></span> <span data-ttu-id="f0e46-245">Por ejemplo, para los tipos "file" y "Active", solo la primera letra es necesario para eliminar la ambigüedad.</span><span class="sxs-lookup"><span data-stu-id="f0e46-245">For example, for the types "file" and "directory", only the first letter is required to disambiguate.</span></span> <span data-ttu-id="f0e46-246">Si el `type` parámetro indica un tipo no se puede crear el proveedor, el [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) método debe escribir una excepción ArgumentException con un mensaje que indica los tipos puede crear el proveedor.</span><span class="sxs-lookup"><span data-stu-id="f0e46-246">If the `type` parameter indicates a type your provider cannot create, the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method should write an ArgumentException with a message indicating the types the provider can create.</span></span>

- <span data-ttu-id="f0e46-247">Para el `newItemValue` parámetro, la implementación de la [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) método se recomienda que acepte las cadenas como mínimo.</span><span class="sxs-lookup"><span data-stu-id="f0e46-247">For the `newItemValue` parameter, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method is recommended to accept strings at a minimum.</span></span> <span data-ttu-id="f0e46-248">También debe aceptar el tipo de objeto que se recupera mediante la [System.Management.Automation.Provider.Itemcmdletprovider.Getitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem) método para la misma ruta de acceso.</span><span class="sxs-lookup"><span data-stu-id="f0e46-248">It should also accept the type of object that is retrieved by the [System.Management.Automation.Provider.Itemcmdletprovider.Getitem\*](/dotnet/api/System.Management.Automation.Provider.ItemCmdletProvider.GetItem) method for the same path.</span></span> <span data-ttu-id="f0e46-249">El [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) método puede utilizar el [System.Management.Automation.Languageprimitives.Convertto\*](/dotnet/api/System.Management.Automation.LanguagePrimitives.ConvertTo) método para convertir tipos el tipo deseado.</span><span class="sxs-lookup"><span data-stu-id="f0e46-249">The [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method can use the [System.Management.Automation.Languageprimitives.Convertto\*](/dotnet/api/System.Management.Automation.LanguagePrimitives.ConvertTo) method to convert types to the desired type.</span></span>

- <span data-ttu-id="f0e46-250">La implementación de la [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) debe llamar al método [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) y comprobar su valor devuelto antes de realizar cualquier cambio en el almacén de datos.</span><span class="sxs-lookup"><span data-stu-id="f0e46-250">Your implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method should call [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and check its return value before making any changes to the data store.</span></span> <span data-ttu-id="f0e46-251">Después de llamar a [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) devuelve true, el [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) debe llamar al método el [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) método como una comprobación adicional para las modificaciones del sistema potencialmente peligrosos.</span><span class="sxs-lookup"><span data-stu-id="f0e46-251">After the call to [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns true, the [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem) method should call the [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method as an additional check for potentially dangerous system modifications.</span></span>

## <a name="attaching-dynamic-parameters-to-the-new-item-cmdlet"></a><span data-ttu-id="f0e46-252">Asociar los parámetros dinámicos al Cmdlet New-Item</span><span class="sxs-lookup"><span data-stu-id="f0e46-252">Attaching Dynamic Parameters to the New-Item Cmdlet</span></span>

<span data-ttu-id="f0e46-253">A veces la `New-Item` cmdlet requiere parámetros adicionales que se especifican de forma dinámica en tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="f0e46-253">Sometimes the `New-Item` cmdlet requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="f0e46-254">Para proporcionar estos parámetros dinámicos, el proveedor de contenedor debe implementar la [System.Management.Automation.Provider.Containercmdletprovider.Newitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItemDynamicParameters) método.</span><span class="sxs-lookup"><span data-stu-id="f0e46-254">To provide these dynamic parameters, the container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Newitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItemDynamicParameters) method.</span></span> <span data-ttu-id="f0e46-255">Este método recupera los parámetros para el elemento situado en la ruta de acceso indicada y devuelve un objeto que tiene las propiedades y campos con atributos similares a una clase de cmdlet de análisis o un [System.Management.Automation.Runtimedefinedparameterdictionary ](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) objeto.</span><span class="sxs-lookup"><span data-stu-id="f0e46-255">This method retrieves the parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="f0e46-256">El tiempo de ejecución de Windows PowerShell usa el objeto devuelto para agregar los parámetros para el `New-Item` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="f0e46-256">The Windows PowerShell runtime uses the returned object to add the parameters to the `New-Item` cmdlet.</span></span>

<span data-ttu-id="f0e46-257">Este proveedor no implementa este método.</span><span class="sxs-lookup"><span data-stu-id="f0e46-257">This provider does not implement this method.</span></span> <span data-ttu-id="f0e46-258">Sin embargo, el código siguiente es la implementación predeterminada de este método.</span><span class="sxs-lookup"><span data-stu-id="f0e46-258">However, the following code is the default implementation of this method.</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidernewitemdynamicparameters](Msh_samplestestcmdlets#testprovidernewitemdynamicparameters)]  -->

## <a name="removing-items"></a><span data-ttu-id="f0e46-259">Quitar elementos</span><span class="sxs-lookup"><span data-stu-id="f0e46-259">Removing Items</span></span>

<span data-ttu-id="f0e46-260">Para quitar elementos, debe invalidar el proveedor de Windows PowerShell la [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) método para admitir llamadas desde el `Remove-Item` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="f0e46-260">To remove items, the Windows PowerShell provider must override the [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) method to support calls from the `Remove-Item` cmdlet.</span></span> <span data-ttu-id="f0e46-261">Este método elimina un elemento del almacén de datos en la ruta especificada.</span><span class="sxs-lookup"><span data-stu-id="f0e46-261">This method deletes an item from the data store at the specified path.</span></span> <span data-ttu-id="f0e46-262">Si el `recurse` parámetro de la `Remove-Item` cmdlet está establecido en `true`, el método quita todos los elementos secundarios, independientemente de su nivel.</span><span class="sxs-lookup"><span data-stu-id="f0e46-262">If the `recurse` parameter of the `Remove-Item` cmdlet is set to `true`, the method removes all child items regardless of their level.</span></span> <span data-ttu-id="f0e46-263">Si el parámetro se establece en `false`, el método quita solo de un solo elemento en la ruta de acceso especificada.</span><span class="sxs-lookup"><span data-stu-id="f0e46-263">If the parameter is set to `false`, the method removes only a single item at the specified path.</span></span>

<span data-ttu-id="f0e46-264">Este proveedor no admite la eliminación de elementos.</span><span class="sxs-lookup"><span data-stu-id="f0e46-264">This provider does not support item removal.</span></span> <span data-ttu-id="f0e46-265">Sin embargo, el código siguiente es la implementación predeterminada de [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem).</span><span class="sxs-lookup"><span data-stu-id="f0e46-265">However, the following code is the default implementation of [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem).</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testproviderremoveitem](Msh_samplestestcmdlets#testproviderremoveitem)]  -->

#### <a name="things-to-remember-about-implementing-removeitem"></a><span data-ttu-id="f0e46-266">Cosas que recordar acerca de cómo implementar RemoveItem</span><span class="sxs-lookup"><span data-stu-id="f0e46-266">Things to Remember About Implementing RemoveItem</span></span>

<span data-ttu-id="f0e46-267">Las siguientes condiciones pueden aplicarse a la implementación de [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem):</span><span class="sxs-lookup"><span data-stu-id="f0e46-267">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Newitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.NewItem):</span></span>

- <span data-ttu-id="f0e46-268">Al definir la clase de proveedor, un proveedor de contenedores de Windows PowerShell puede declarar las capacidades del proveedor de ExpandWildcards, filtro, Include o Exclude, desde el [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeración.</span><span class="sxs-lookup"><span data-stu-id="f0e46-268">When defining the provider class, a Windows PowerShell container provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="f0e46-269">En estos casos, la implementación de la [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) debe asegurarse de que la ruta de acceso que se pasa al método cumple los requisitos del elemento especificado (método) capacidades.</span><span class="sxs-lookup"><span data-stu-id="f0e46-269">In these cases, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="f0e46-270">Para ello, el método debe tener acceso a la propiedad adecuada, por ejemplo, el [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) y [ System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) propiedades.</span><span class="sxs-lookup"><span data-stu-id="f0e46-270">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="f0e46-271">De forma predeterminada, las invalidaciones de este método no deberían quitar objetos a menos que el [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) propiedad está establecida en true.</span><span class="sxs-lookup"><span data-stu-id="f0e46-271">By default, overrides of this method should not remove objects unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to true.</span></span> <span data-ttu-id="f0e46-272">Si la ruta de acceso especificada indica un contenedor, el [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) propiedad no es necesaria.</span><span class="sxs-lookup"><span data-stu-id="f0e46-272">If the specified path indicates a container, the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is not required.</span></span>

- <span data-ttu-id="f0e46-273">La implementación de [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) es responsable de evitar una recursión infinita cuando hay vínculos circulares y similares.</span><span class="sxs-lookup"><span data-stu-id="f0e46-273">Your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) is responsible for preventing infinite recursion when there are circular links, and the like.</span></span> <span data-ttu-id="f0e46-274">Debe iniciará una excepción de terminación adecuada para reflejar una condición de ese tipo.</span><span class="sxs-lookup"><span data-stu-id="f0e46-274">An appropriate terminating exception should be thrown to reflect such a condition.</span></span>

- <span data-ttu-id="f0e46-275">La implementación de la [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) debe llamar al método [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) y comprobar su valor devuelto antes de realizar cualquier cambio en el almacén de datos.</span><span class="sxs-lookup"><span data-stu-id="f0e46-275">Your implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) method should call [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and check its return value before making any changes to the data store.</span></span> <span data-ttu-id="f0e46-276">Después de llamar a [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) devuelve `true`, [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) debe llamar al método el [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) método como una comprobación adicional para las modificaciones del sistema potencialmente peligrosos.</span><span class="sxs-lookup"><span data-stu-id="f0e46-276">After the call to [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns `true`, the [System.Management.Automation.Provider.Containercmdletprovider.Removeitem\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItem) method should call the [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method as an additional check for potentially dangerous system modifications.</span></span>

## <a name="attaching-dynamic-parameters-to-the-remove-item-cmdlet"></a><span data-ttu-id="f0e46-277">Asociar los parámetros dinámicos al Cmdlet Remove-Item</span><span class="sxs-lookup"><span data-stu-id="f0e46-277">Attaching Dynamic Parameters to the Remove-Item Cmdlet</span></span>

<span data-ttu-id="f0e46-278">A veces la `Remove-Item` cmdlet requiere parámetros adicionales que se especifican de forma dinámica en tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="f0e46-278">Sometimes the `Remove-Item` cmdlet requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="f0e46-279">Para proporcionar estos parámetros dinámicos, el proveedor de contenedor debe implementar la [System.Management.Automation.Provider.Containercmdletprovider.Removeitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItemDynamicParameters) método para controlar estos parámetros.</span><span class="sxs-lookup"><span data-stu-id="f0e46-279">To provide these dynamic parameters, the container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Removeitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItemDynamicParameters) method to handle these parameters.</span></span> <span data-ttu-id="f0e46-280">Este método recupera los parámetros dinámicos para el elemento situado en la ruta de acceso indicada y devuelve un objeto que tiene las propiedades y campos con atributos similares a una clase de cmdlet de análisis o un [ System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) objeto.</span><span class="sxs-lookup"><span data-stu-id="f0e46-280">This method retrieves the dynamic parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="f0e46-281">El tiempo de ejecución de Windows PowerShell usa el objeto devuelto para agregar los parámetros para el `Remove-Item` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="f0e46-281">The Windows PowerShell runtime uses the returned object to add the parameters to the `Remove-Item` cmdlet.</span></span>

<span data-ttu-id="f0e46-282">Este proveedor de contenedor no implementa este método.</span><span class="sxs-lookup"><span data-stu-id="f0e46-282">This container provider does not implement this method.</span></span> <span data-ttu-id="f0e46-283">Sin embargo, el código siguiente es la implementación predeterminada de [System.Management.Automation.Provider.Containercmdletprovider.Removeitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItemDynamicParameters).</span><span class="sxs-lookup"><span data-stu-id="f0e46-283">However, the following code is the default implementation of [System.Management.Automation.Provider.Containercmdletprovider.Removeitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.RemoveItemDynamicParameters).</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testproviderremoveitemdynamicparameters](Msh_samplestestcmdlets#testproviderremoveitemdynamicparameters)]  -->

## <a name="querying-for-child-items"></a><span data-ttu-id="f0e46-284">Consulta de elementos secundarios</span><span class="sxs-lookup"><span data-stu-id="f0e46-284">Querying for Child Items</span></span>

<span data-ttu-id="f0e46-285">Para comprobar si existen elementos secundarios en la ruta de acceso especificada, el proveedor de contenedores de Windows PowerShell debe invalidar el [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) método.</span><span class="sxs-lookup"><span data-stu-id="f0e46-285">To check to see if child items exist at the specified path, the Windows PowerShell container provider must override the [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) method.</span></span> <span data-ttu-id="f0e46-286">Este método devuelve `true` si el elemento tiene elementos secundarios, y `false` en caso contrario.</span><span class="sxs-lookup"><span data-stu-id="f0e46-286">This method returns `true` if the item has children, and `false` otherwise.</span></span> <span data-ttu-id="f0e46-287">Para una ruta de acceso null o está vacío, el método tiene en cuenta los elementos en el almacén de datos para ser elementos secundarios y devuelve `true`.</span><span class="sxs-lookup"><span data-stu-id="f0e46-287">For a null or empty path, the method considers any items in the data store to be children and returns `true`.</span></span>

<span data-ttu-id="f0e46-288">Aquí está la invalidación para el [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) método.</span><span class="sxs-lookup"><span data-stu-id="f0e46-288">Here is the override for the [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) method.</span></span> <span data-ttu-id="f0e46-289">Si hay más de dos partes de ruta de acceso creadas por el método de aplicación auxiliar ChunkPath, el método devuelve `false`, ya que sólo un contenedor de la base de datos y un contenedor de la tabla se definen.</span><span class="sxs-lookup"><span data-stu-id="f0e46-289">If there are more than two path parts created by the ChunkPath helper method, the method returns `false`, since only a database container and a table container are defined.</span></span> <span data-ttu-id="f0e46-290">Para obtener más información acerca de este método auxiliar, vea el método ChunkPath se describe en [creación de un proveedor de elementos de Windows PowerShell](./creating-a-windows-powershell-item-provider.md).</span><span class="sxs-lookup"><span data-stu-id="f0e46-290">For more information about this helper method, see the ChunkPath method is discussed in [Creating a Windows PowerShell Item Provider](./creating-a-windows-powershell-item-provider.md).</span></span>

```csharp
protected override bool HasChildItems( string path )
{
    return false;
} // HasChildItems
```

[!code-csharp[AccessDBProviderSample04.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample04/AccessDBProviderSample04.cs#L1094-L1097 "AccessDBProviderSample04.cs")]

#### <a name="things-to-remember-about-implementing-haschilditems"></a><span data-ttu-id="f0e46-291">Cosas que recordar acerca de cómo implementar HasChildItems</span><span class="sxs-lookup"><span data-stu-id="f0e46-291">Things to Remember About Implementing HasChildItems</span></span>

<span data-ttu-id="f0e46-292">Las siguientes condiciones pueden aplicarse a la implementación de [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems):</span><span class="sxs-lookup"><span data-stu-id="f0e46-292">The following conditions may apply to your implementation of [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems):</span></span>

- <span data-ttu-id="f0e46-293">Si el proveedor de contenedor expone una raíz que contiene los puntos de montaje interesantes, la implementación de la [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) método debe devolver `true`cuando un valor null o una cadena vacía se pasa en la ruta de acceso.</span><span class="sxs-lookup"><span data-stu-id="f0e46-293">If the container provider exposes a root that contains interesting mount points, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Haschilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.HasChildItems) method should return `true` when a null or an empty string is passed in for the path.</span></span>

## <a name="copying-items"></a><span data-ttu-id="f0e46-294">Copiar elementos</span><span class="sxs-lookup"><span data-stu-id="f0e46-294">Copying Items</span></span>

<span data-ttu-id="f0e46-295">Para copiar elementos, el proveedor de contenedor debe implementar la [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) método para admitir llamadas desde el `Copy-Item` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="f0e46-295">To copy items, the container provider must implement the [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) method to support calls from the `Copy-Item` cmdlet.</span></span> <span data-ttu-id="f0e46-296">Este método copia un elemento de datos desde la ubicación indicada por el `path` parámetro del cmdlet para la ubicación indicada por el `copyPath` parámetro.</span><span class="sxs-lookup"><span data-stu-id="f0e46-296">This method copies a data item from the location indicated by the `path` parameter of the cmdlet to the location indicated by the `copyPath` parameter.</span></span> <span data-ttu-id="f0e46-297">Si el `recurse` parámetro se especifica, el método de copia de todos los subcontenedores.</span><span class="sxs-lookup"><span data-stu-id="f0e46-297">If the `recurse` parameter is specified, the method copies all sub-containers.</span></span> <span data-ttu-id="f0e46-298">Si no se especifica el parámetro, el método de copia únicamente un solo nivel de elementos.</span><span class="sxs-lookup"><span data-stu-id="f0e46-298">If the parameter is not specified, the method copies only a single level of items.</span></span>

<span data-ttu-id="f0e46-299">Este proveedor no implementa este método.</span><span class="sxs-lookup"><span data-stu-id="f0e46-299">This provider does not implement this method.</span></span> <span data-ttu-id="f0e46-300">Sin embargo, el código siguiente es la implementación predeterminada de [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem).</span><span class="sxs-lookup"><span data-stu-id="f0e46-300">However, the following code is the default implementation of [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem).</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidercopyitem](Msh_samplestestcmdlets#testprovidercopyitem)]  -->

#### <a name="things-to-remember-about-implementing-copyitem"></a><span data-ttu-id="f0e46-301">Cosas que recordar sobre la implementación de CopyItem</span><span class="sxs-lookup"><span data-stu-id="f0e46-301">Things to Remember About Implementing CopyItem</span></span>

<span data-ttu-id="f0e46-302">Las siguientes condiciones pueden aplicarse a la implementación de [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem):</span><span class="sxs-lookup"><span data-stu-id="f0e46-302">The following conditions may apply to your implementation of [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem):</span></span>

- <span data-ttu-id="f0e46-303">Al definir la clase de proveedor, un proveedor de contenedores de Windows PowerShell puede declarar las capacidades del proveedor de ExpandWildcards, filtro, Include o Exclude, desde el [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeración.</span><span class="sxs-lookup"><span data-stu-id="f0e46-303">When defining the provider class, a Windows PowerShell container provider might declare provider capabilities of ExpandWildcards, Filter, Include, or Exclude, from the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="f0e46-304">En estos casos, la implementación de la [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) debe asegurarse de que la ruta de acceso que se pasa al método cumple los requisitos del elemento especificado (método) capacidades.</span><span class="sxs-lookup"><span data-stu-id="f0e46-304">In these cases, the implementation of the [System.Management.Automation.Provider.Containercmdletprovider.Getchilditems\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.GetChildItems) method needs to ensure that the path passed to the method meets the requirements of the specified capabilities.</span></span> <span data-ttu-id="f0e46-305">Para ello, el método debe tener acceso a la propiedad adecuada, por ejemplo, el [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) y [ System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) propiedades.</span><span class="sxs-lookup"><span data-stu-id="f0e46-305">To do this, the method should access the appropriate property, for example, the [System.Management.Automation.Provider.Cmdletprovider.Exclude\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Exclude) and [System.Management.Automation.Provider.Cmdletprovider.Include\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Include) properties.</span></span>

- <span data-ttu-id="f0e46-306">De forma predeterminada, las invalidaciones de este método no deben copiar los objetos a través de los objetos existentes a menos que el [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) propiedad está establecida en `true`.</span><span class="sxs-lookup"><span data-stu-id="f0e46-306">By default, overrides of this method should not copy objects over existing objects unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="f0e46-307">Por ejemplo, el proveedor FileSystem no copiará c:\temp\abc.txt a través de un archivo c:\abc.txt existente a menos que el [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) propiedad está establecida en `true`.</span><span class="sxs-lookup"><span data-stu-id="f0e46-307">For example, the FileSystem provider will not copy c:\temp\abc.txt over an existing c:\abc.txt file unless the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is set to `true`.</span></span> <span data-ttu-id="f0e46-308">Si la ruta de acceso especificada en el `copyPath` parámetro existe y que un contenedor, el [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) propiedad no es necesaria.</span><span class="sxs-lookup"><span data-stu-id="f0e46-308">If the path specified in the `copyPath` parameter exists and indicates a container, the [System.Management.Automation.Provider.Cmdletprovider.Force\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Force) property is not required.</span></span> <span data-ttu-id="f0e46-309">En este caso, [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) debe copiar el elemento indicado por el `path` parámetro en el contenedor indicado por el `copyPath` parámetro como un elemento secundario.</span><span class="sxs-lookup"><span data-stu-id="f0e46-309">In this case, [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) should copy the item indicated by the `path` parameter to the container indicated by the `copyPath` parameter as a child.</span></span>

- <span data-ttu-id="f0e46-310">La implementación de [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) es responsable de evitar una recursión infinita cuando hay vínculos circulares y similares.</span><span class="sxs-lookup"><span data-stu-id="f0e46-310">Your implementation of [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) is responsible for preventing infinite recursion when there are circular links, and the like.</span></span> <span data-ttu-id="f0e46-311">Debe iniciará una excepción de terminación adecuada para reflejar una condición de ese tipo.</span><span class="sxs-lookup"><span data-stu-id="f0e46-311">An appropriate terminating exception should be thrown to reflect such a condition.</span></span>

- <span data-ttu-id="f0e46-312">La implementación de la [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) debe llamar al método [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) y comprobar su valor devuelto antes de realizar cualquier cambio en el almacén de datos.</span><span class="sxs-lookup"><span data-stu-id="f0e46-312">Your implementation of the [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) method should call [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) and check its return value before making any changes to the data store.</span></span> <span data-ttu-id="f0e46-313">Después de llamar a [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) devuelve true, el [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) debe llamar al método el [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) método como una comprobación adicional para las modificaciones del sistema potencialmente peligrosos.</span><span class="sxs-lookup"><span data-stu-id="f0e46-313">After the call to [System.Management.Automation.Provider.Cmdletprovider.ShouldProcess](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldProcess) returns true, the [System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItem) method should call the [System.Management.Automation.Provider.Cmdletprovider.ShouldContinue](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.ShouldContinue) method as an additional check for potentially dangerous system modifications.</span></span> <span data-ttu-id="f0e46-314">Para obtener más información sobre cómo llamar a estos métodos, consulte [cambiar el nombre de elementos](#Renaming-Items).</span><span class="sxs-lookup"><span data-stu-id="f0e46-314">For more information about calling these methods, see [Rename Items](#Renaming-Items).</span></span>

## <a name="attaching-dynamic-parameters-to-the-copy-item-cmdlet"></a><span data-ttu-id="f0e46-315">Asociar los parámetros dinámicos para el Cmdlet Copy-Item</span><span class="sxs-lookup"><span data-stu-id="f0e46-315">Attaching Dynamic Parameters to the Copy-Item Cmdlet</span></span>

<span data-ttu-id="f0e46-316">A veces la `Copy-Item` cmdlet requiere parámetros adicionales que se especifican de forma dinámica en tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="f0e46-316">Sometimes the `Copy-Item` cmdlet requires additional parameters that are specified dynamically at runtime.</span></span> <span data-ttu-id="f0e46-317">Para proporcionar estos parámetros dinámicos, debe implementar el proveedor de contenedores de Windows PowerShell la [System.Management.Automation.Provider.Containercmdletprovider.Copyitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItemDynamicParameters) método para controlar estos parámetros.</span><span class="sxs-lookup"><span data-stu-id="f0e46-317">To provide these dynamic parameters, the Windows PowerShell container provider must implement the [System.Management.Automation.Provider.Containercmdletprovider.Copyitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItemDynamicParameters) method to handle these parameters.</span></span> <span data-ttu-id="f0e46-318">Este método recupera los parámetros para el elemento situado en la ruta de acceso indicada y devuelve un objeto que tiene las propiedades y campos con atributos similares a una clase de cmdlet de análisis o un [System.Management.Automation.Runtimedefinedparameterdictionary ](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) objeto.</span><span class="sxs-lookup"><span data-stu-id="f0e46-318">This method retrieves the parameters for the item at the indicated path and returns an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span> <span data-ttu-id="f0e46-319">El tiempo de ejecución de Windows PowerShell usa el objeto devuelto para agregar los parámetros para el `Copy-Item` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="f0e46-319">The Windows PowerShell runtime uses the returned object to add the parameters to the `Copy-Item` cmdlet.</span></span>

<span data-ttu-id="f0e46-320">Este proveedor no implementa este método.</span><span class="sxs-lookup"><span data-stu-id="f0e46-320">This provider does not implement this method.</span></span> <span data-ttu-id="f0e46-321">Sin embargo, el código siguiente es la implementación predeterminada de [System.Management.Automation.Provider.Containercmdletprovider.Copyitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItemDynamicParameters).</span><span class="sxs-lookup"><span data-stu-id="f0e46-321">However, the following code is the default implementation of [System.Management.Automation.Provider.Containercmdletprovider.Copyitemdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.ContainerCmdletProvider.CopyItemDynamicParameters).</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplestestcmdlets#testprovidercopyitemdynamicparameters](Msh_samplestestcmdlets#testprovidercopyitemdynamicparameters)]  -->

## <a name="code-sample"></a><span data-ttu-id="f0e46-322">Ejemplo de código</span><span class="sxs-lookup"><span data-stu-id="f0e46-322">Code Sample</span></span>

<span data-ttu-id="f0e46-323">Para el código de ejemplo completo, vea [AccessDbProviderSample04 código de ejemplo](./accessdbprovidersample04-code-sample.md).</span><span class="sxs-lookup"><span data-stu-id="f0e46-323">For complete sample code, see [AccessDbProviderSample04 Code Sample](./accessdbprovidersample04-code-sample.md).</span></span>

## <a name="building-the-windows-powershell-provider"></a><span data-ttu-id="f0e46-324">Creación del proveedor de Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="f0e46-324">Building the Windows PowerShell Provider</span></span>

<span data-ttu-id="f0e46-325">Consulte [cómo registrar Cmdlets, proveedores y aplicaciones Host](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c).</span><span class="sxs-lookup"><span data-stu-id="f0e46-325">See [How to Register Cmdlets, Providers, and Host Applications](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c).</span></span>

## <a name="testing-the-windows-powershell-provider"></a><span data-ttu-id="f0e46-326">Probar el proveedor de Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="f0e46-326">Testing the Windows PowerShell Provider</span></span>

<span data-ttu-id="f0e46-327">Cuando se ha registrado el proveedor de Windows PowerShell con Windows PowerShell, puede probarla mediante la ejecución de los cmdlets compatibles en la línea de comandos.</span><span class="sxs-lookup"><span data-stu-id="f0e46-327">When your Windows PowerShell provider has been registered with Windows PowerShell, you can test it by running the supported cmdlets on the command line.</span></span> <span data-ttu-id="f0e46-328">Tenga en cuenta que la salida del ejemplo siguiente utiliza una base de datos de Access ficticia.</span><span class="sxs-lookup"><span data-stu-id="f0e46-328">Be aware that the following example output uses a fictitious Access database.</span></span>

1. <span data-ttu-id="f0e46-329">Ejecute el `Get-ChildItem` cmdlet para recuperar la lista de elementos secundarios de una tabla Customers de la base de datos de Access.</span><span class="sxs-lookup"><span data-stu-id="f0e46-329">Run the `Get-ChildItem` cmdlet to retrieve the list of child items from a Customers table in the Access database.</span></span>

   ```powershell
   Get-ChildItem mydb:customers
   ```

   <span data-ttu-id="f0e46-330">Aparece el siguiente resultado.</span><span class="sxs-lookup"><span data-stu-id="f0e46-330">The following output appears.</span></span>

   ```output
   PSPath        : AccessDB::customers
   PSDrive       : mydb
   PSProvider    : System.Management.Automation.ProviderInfo
   PSIsContainer : True
   Data          : System.Data.DataRow
   Name          : Customers
   RowCount      : 91
   Columns       :
   ```

2. <span data-ttu-id="f0e46-331">Ejecute el `Get-ChildItem` cmdlet nuevo para recuperar los datos de una tabla.</span><span class="sxs-lookup"><span data-stu-id="f0e46-331">Run the `Get-ChildItem` cmdlet again to retrieve the data of a table.</span></span>

   ```powershell
   (Get-ChildItem mydb:customers).data
   ```

   <span data-ttu-id="f0e46-332">Aparece el siguiente resultado.</span><span class="sxs-lookup"><span data-stu-id="f0e46-332">The following output appears.</span></span>

   ```output
   TABLE_CAT   : c:\PS\northwind
   TABLE_SCHEM :
   TABLE_NAME  : Customers
   TABLE_TYPE  : TABLE
   REMARKS     :
   ```

3. <span data-ttu-id="f0e46-333">Ahora utilice el `Get-Item` cmdlet para recuperar los elementos de la fila 0 en la tabla de datos.</span><span class="sxs-lookup"><span data-stu-id="f0e46-333">Now use the `Get-Item` cmdlet to retrieve the items at row 0 in the data table.</span></span>

   ```powershell
   Get-Item mydb:\customers\0
   ```

   <span data-ttu-id="f0e46-334">Aparece el siguiente resultado.</span><span class="sxs-lookup"><span data-stu-id="f0e46-334">The following output appears.</span></span>

   ```output
   PSPath        : AccessDB::customers\0
   PSDrive       : mydb
   PSProvider    : System.Management.Automation.ProviderInfo
   PSIsContainer : False
   Data          : System.Data.DataRow
   RowNumber     : 0
   ```

4. <span data-ttu-id="f0e46-335">Reutilizar `Get-Item` para recuperar los datos para los elementos en la fila 0.</span><span class="sxs-lookup"><span data-stu-id="f0e46-335">Reuse `Get-Item` to retrieve the data for the items in row 0.</span></span>

   ```powershell
   (Get-Item mydb:\customers\0).data
   ```

   <span data-ttu-id="f0e46-336">Aparece el siguiente resultado.</span><span class="sxs-lookup"><span data-stu-id="f0e46-336">The following output appears.</span></span>

   ```output
   CustomerID   : 1234
   CompanyName  : Fabrikam
   ContactName  : Eric Gruber
   ContactTitle : President
   Address      : 4567 Main Street
   City         : Buffalo
   Region       : NY
   PostalCode   : 98052
   Country      : USA
   Phone        : (425) 555-0100
   Fax          : (425) 555-0101
   ```

5. <span data-ttu-id="f0e46-337">Ahora utilice el `New-Item` cmdlet para agregar una fila a una tabla existente.</span><span class="sxs-lookup"><span data-stu-id="f0e46-337">Now use the `New-Item` cmdlet to add a row to an existing table.</span></span> <span data-ttu-id="f0e46-338">El `Path` parámetro especifica la ruta de acceso completa a la fila y debe indicar un número de fila que es mayor que el número de filas de la tabla existente.</span><span class="sxs-lookup"><span data-stu-id="f0e46-338">The `Path` parameter specifies the full path to the row, and must indicate a row number that is greater than the existing number of rows in the table.</span></span> <span data-ttu-id="f0e46-339">El `Type` parámetro indica "row" para especificar ese tipo de elemento se va a agregar.</span><span class="sxs-lookup"><span data-stu-id="f0e46-339">The `Type` parameter indicates "row" to specify that type of item to add.</span></span> <span data-ttu-id="f0e46-340">Por último, el `Value` parámetro especifica una lista delimitada por comas de valores de columna para la fila.</span><span class="sxs-lookup"><span data-stu-id="f0e46-340">Finally, the `Value` parameter specifies a comma-delimited list of column values for the row.</span></span>

   ```powershell
   New-Item -Path mydb:\Customers\3 -ItemType "row" -Value "3,CustomerFirstName,CustomerLastName,CustomerEmailAddress,CustomerTitle,CustomerCompany,CustomerPhone, CustomerAddress,CustomerCity,CustomerState,CustomerZip,CustomerCountry"
   ```

6. <span data-ttu-id="f0e46-341">Compruebe la exactitud de la nueva operación de elemento como sigue.</span><span class="sxs-lookup"><span data-stu-id="f0e46-341">Verify the correctness of the new item operation as follows.</span></span>

   ```none
   PS mydb:\> cd Customers
   PS mydb:\Customers> (Get-Item 3).data
   ```

   <span data-ttu-id="f0e46-342">Aparece el siguiente resultado.</span><span class="sxs-lookup"><span data-stu-id="f0e46-342">The following output appears.</span></span>

   ```output
   ID        : 3
   FirstName : Eric
   LastName  : Gruber
   Email     : ericgruber@fabrikam.com
   Title     : President
   Company   : Fabrikam
   WorkPhone : (425) 555-0100
   Address   : 4567 Main Street
   City      : Buffalo
   State     : NY
   Zip       : 98052
   Country   : USA
   ```

## <a name="see-also"></a><span data-ttu-id="f0e46-343">Véase también</span><span class="sxs-lookup"><span data-stu-id="f0e46-343">See Also</span></span>

[<span data-ttu-id="f0e46-344">Creación de proveedores de Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="f0e46-344">Creating Windows PowerShell Providers</span></span>](./how-to-create-a-windows-powershell-provider.md)

[<span data-ttu-id="f0e46-345">Diseñar el proveedor de Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="f0e46-345">Designing Your Windows PowerShell Provider</span></span>](./designing-your-windows-powershell-provider.md)

[<span data-ttu-id="f0e46-346">Implementar un proveedor de elementos de Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="f0e46-346">Implementing an Item Windows PowerShell Provider</span></span>](./creating-a-windows-powershell-item-provider.md)

[<span data-ttu-id="f0e46-347">Implementar un proveedor de navegación de Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="f0e46-347">Implementing a Navigation Windows PowerShell Provider</span></span>](./creating-a-windows-powershell-navigation-provider.md)

[<span data-ttu-id="f0e46-348">Cómo registrar Cmdlets, proveedores y aplicaciones Host</span><span class="sxs-lookup"><span data-stu-id="f0e46-348">How to Register Cmdlets, Providers, and Host Applications</span></span>](http://msdn.microsoft.com/en-us/a41e9054-29c8-40ab-bf2b-8ce4e7ec1c8c)

[<span data-ttu-id="f0e46-349">Windows PowerShell SDK</span><span class="sxs-lookup"><span data-stu-id="f0e46-349">Windows PowerShell SDK</span></span>](../windows-powershell-reference.md)

[<span data-ttu-id="f0e46-350">Guía del programador de Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="f0e46-350">Windows PowerShell Programmer's Guide</span></span>](./windows-powershell-programmer-s-guide.md)