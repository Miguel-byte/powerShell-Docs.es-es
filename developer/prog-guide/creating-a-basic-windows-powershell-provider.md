---
title: Creación de un proveedor de PowerShell de Windows básico | Microsoft Docs
ms.custom: ''
ms.date: 09/13/2016
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- base provider [PowerShell Programmer's Guide]
- providers [PowerShell Programmer's Guide], base provider
ms.assetid: 11eeea41-15c8-47ad-9016-0f4b72573305
caps.latest.revision: 7
ms.openlocfilehash: 5ebc22067b20f0e1d35d31d5f33e599f50cb7564
ms.sourcegitcommit: 01b81317029b28dd9b61d167045fd31f1ec7bc06
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 05/17/2019
ms.locfileid: "65855065"
---
# <a name="creating-a-basic-windows-powershell-provider"></a><span data-ttu-id="19096-102">Diseño de un proveedor de Windows PowerShell básico</span><span class="sxs-lookup"><span data-stu-id="19096-102">Creating a Basic Windows PowerShell Provider</span></span>

<span data-ttu-id="19096-103">En este tema es el punto de partida para aprender a crear un proveedor de Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="19096-103">This topic is the starting point for learning how to create a Windows PowerShell provider.</span></span> <span data-ttu-id="19096-104">El proveedor básico que se describen aquí proporciona métodos para iniciar y detener el proveedor y, aunque este proveedor no proporciona un medio para tener acceso a un almacén de datos o para obtener o establecer los datos en el almacén de datos, proporcionan la funcionalidad básica requerida por todos los proveedores.</span><span class="sxs-lookup"><span data-stu-id="19096-104">The basic provider described here provides methods for starting and stopping the provider, and although this provider does not provide a means to access a data store or to get or set the data in the data store, it does provide the basic functionality that is required by all providers.</span></span>

<span data-ttu-id="19096-105">Como se mencionó anteriormente, el proveedor básico descrito aquí implementa métodos para iniciar y detener el proveedor.</span><span class="sxs-lookup"><span data-stu-id="19096-105">As mentioned previously, the basic provider described here implements methods for starting and stopping the provider.</span></span> <span data-ttu-id="19096-106">El tiempo de ejecución de Windows PowerShell llama a estos métodos para inicializar y anular la inicialización del proveedor.</span><span class="sxs-lookup"><span data-stu-id="19096-106">The Windows PowerShell runtime calls these methods to initialize and uninitialize the provider.</span></span>

> [!NOTE]
> <span data-ttu-id="19096-107">Puede encontrar un ejemplo de este proveedor en el archivo AccessDBSampleProvider01.cs proporcionado por Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="19096-107">You can find a sample of this provider in the AccessDBSampleProvider01.cs file provided by Windows PowerShell.</span></span>

## <a name="defining-the-windows-powershell-provider-class"></a><span data-ttu-id="19096-108">Definición de la clase de proveedor de PowerShell de Windows</span><span class="sxs-lookup"><span data-stu-id="19096-108">Defining the Windows PowerShell Provider Class</span></span>

<span data-ttu-id="19096-109">El primer paso para crear un proveedor de Windows PowerShell es definir su clase. NET.</span><span class="sxs-lookup"><span data-stu-id="19096-109">The first step in creating a Windows PowerShell provider is to define its .NET class.</span></span> <span data-ttu-id="19096-110">Este proveedor básico define una clase denominada `AccessDBProvider` que se deriva el [System.Management.Automation.Provider.Cmdletprovider](/dotnet/api/System.Management.Automation.Provider.CmdletProvider) clase base.</span><span class="sxs-lookup"><span data-stu-id="19096-110">This basic provider defines a class called `AccessDBProvider` that derives from the [System.Management.Automation.Provider.Cmdletprovider](/dotnet/api/System.Management.Automation.Provider.CmdletProvider) base class.</span></span>

<span data-ttu-id="19096-111">Se recomienda que coloque las clases de proveedor en un `Providers` espacio de nombres de su espacio de nombres de API, por ejemplo, xxx. PowerShell.Providers.</span><span class="sxs-lookup"><span data-stu-id="19096-111">It is recommended that you place your provider classes in a `Providers` namespace of your API namespace, for example, xxx.PowerShell.Providers.</span></span> <span data-ttu-id="19096-112">Este proveedor utiliza la `Microsoft.Samples.PowerShell.Provider` espacio de nombres, en el que se ejecutan todas las muestras de proveedor de Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="19096-112">This provider uses the `Microsoft.Samples.PowerShell.Provider` namespace, in which all Windows PowerShell provider samples run.</span></span>

> [!NOTE]
> <span data-ttu-id="19096-113">La clase para un proveedor de Windows PowerShell debe marcarse explícitamente como pública.</span><span class="sxs-lookup"><span data-stu-id="19096-113">The class for a Windows PowerShell provider must be explicitly marked as public.</span></span> <span data-ttu-id="19096-114">Las clases no está marcadas como público predeterminado será interno y no se encontrará el tiempo de ejecución de Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="19096-114">Classes not marked as public will default to internal and will not be found by the Windows PowerShell runtime.</span></span>

<span data-ttu-id="19096-115">Esta es la definición de clase para este proveedor básico:</span><span class="sxs-lookup"><span data-stu-id="19096-115">Here is the class definition for this basic provider:</span></span>

[!code-csharp[AccessDBProviderSample01.cs](../../powershell-sdk-samples/SDK-2.0/csharp/AccessDBProviderSample01/AccessDBProviderSample01.cs#L23-L24 "AccessDBProviderSample01.cs")]

<span data-ttu-id="19096-116">Justo antes de la definición de clase debe declarar la [System.Management.Automation.Provider.Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) atributo con la sintaxis [CmdletProvider()].</span><span class="sxs-lookup"><span data-stu-id="19096-116">Right before the class definition, you must declare the [System.Management.Automation.Provider.Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) attribute, with the syntax [CmdletProvider()].</span></span>

<span data-ttu-id="19096-117">Puede establecer las palabras clave de atributo para declarar aún más la clase si es necesario.</span><span class="sxs-lookup"><span data-stu-id="19096-117">You can set attribute keywords to further declare the class if necessary.</span></span> <span data-ttu-id="19096-118">Tenga en cuenta que el [System.Management.Automation.Provider.Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) atributo declarado aquí incluye dos parámetros.</span><span class="sxs-lookup"><span data-stu-id="19096-118">Notice that the [System.Management.Automation.Provider.Cmdletproviderattribute](/dotnet/api/System.Management.Automation.Provider.CmdletProviderAttribute) attribute declared here includes two parameters.</span></span> <span data-ttu-id="19096-119">El primer parámetro de atributo especifica el nombre predeterminado para el proveedor, que el usuario puede modificar más adelante.</span><span class="sxs-lookup"><span data-stu-id="19096-119">The first attribute parameter specifies the default-friendly name for the provider, which the user can modify later.</span></span> <span data-ttu-id="19096-120">El segundo parámetro especifica las capacidades definidas en Windows PowerShell que expone el proveedor para el tiempo de ejecución de Windows PowerShell durante el procesamiento de comandos.</span><span class="sxs-lookup"><span data-stu-id="19096-120">The second parameter specifies the Windows PowerShell-defined capabilities that the provider exposes to the Windows PowerShell runtime during command processing.</span></span> <span data-ttu-id="19096-121">Los valores posibles para las capacidades del proveedor se definen mediante la [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeración.</span><span class="sxs-lookup"><span data-stu-id="19096-121">The possible values for the provider capabilities are defined by the [System.Management.Automation.Provider.Providercapabilities](/dotnet/api/System.Management.Automation.Provider.ProviderCapabilities) enumeration.</span></span> <span data-ttu-id="19096-122">Se trata de un proveedor de base, es compatible con ninguna capacidad.</span><span class="sxs-lookup"><span data-stu-id="19096-122">Because this is a base provider, it supports no capabilities.</span></span>

> [!NOTE]
> <span data-ttu-id="19096-123">El nombre completo del proveedor de Windows PowerShell incluye el nombre del ensamblado y otros atributos que se determina mediante Windows PowerShell tras el registro del proveedor.</span><span class="sxs-lookup"><span data-stu-id="19096-123">The fully qualified name of the Windows PowerShell provider includes the assembly name and other attributes determined by Windows PowerShell upon registration of the provider.</span></span>

## <a name="defining-provider-specific-state-information"></a><span data-ttu-id="19096-124">Definir la información de estado específica del proveedor</span><span class="sxs-lookup"><span data-stu-id="19096-124">Defining Provider-Specific State Information</span></span>

<span data-ttu-id="19096-125">El [System.Management.Automation.Provider.Cmdletprovider](/dotnet/api/System.Management.Automation.Provider.CmdletProvider) clase base y todas las clases derivadas se consideran sin estado porque el tiempo de ejecución de Windows PowerShell crea instancias del proveedor solo según sea necesario.</span><span class="sxs-lookup"><span data-stu-id="19096-125">The [System.Management.Automation.Provider.Cmdletprovider](/dotnet/api/System.Management.Automation.Provider.CmdletProvider) base class and all derived classes are considered stateless because the Windows PowerShell runtime creates provider instances only as required.</span></span> <span data-ttu-id="19096-126">Por lo tanto, si su proveedor requiere control total y el mantenimiento de estado para los datos específicos del proveedor, debe derivar una clase de la [System.Management.Automation.Providerinfo](/dotnet/api/System.Management.Automation.ProviderInfo) clase.</span><span class="sxs-lookup"><span data-stu-id="19096-126">Therefore, if your provider requires full control and state maintenance for provider-specific data, it must derive a class from the [System.Management.Automation.Providerinfo](/dotnet/api/System.Management.Automation.ProviderInfo) class.</span></span> <span data-ttu-id="19096-127">La clase derivada debe definir los miembros necesarios para mantener el estado para que los datos específicos del proveedor pueden obtenerse cuando el tiempo de ejecución de Windows PowerShell llama a la [System.Management.Automation.Provider.Cmdletprovider.Start\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) método para inicializar el proveedor.</span><span class="sxs-lookup"><span data-stu-id="19096-127">Your derived class should define the members necessary to maintain the state so that the provider-specific data can be accessed when the Windows PowerShell runtime calls the [System.Management.Automation.Provider.Cmdletprovider.Start\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) method to initialize the provider.</span></span>

<span data-ttu-id="19096-128">Un proveedor de Windows PowerShell también puede mantener el estado de conexión.</span><span class="sxs-lookup"><span data-stu-id="19096-128">A Windows PowerShell provider can also maintain connection-based state.</span></span> <span data-ttu-id="19096-129">Para obtener más información sobre cómo mantener el estado de conexión, consulte [creación de un proveedor de la unidad de PowerShell](./creating-a-windows-powershell-drive-provider.md).</span><span class="sxs-lookup"><span data-stu-id="19096-129">For more information about maintaining connection state, see [Creating a PowerShell Drive Provider](./creating-a-windows-powershell-drive-provider.md).</span></span>

## <a name="initializing-the-provider"></a><span data-ttu-id="19096-130">Inicializar el proveedor</span><span class="sxs-lookup"><span data-stu-id="19096-130">Initializing the Provider</span></span>

<span data-ttu-id="19096-131">Para inicializar el proveedor, las llamadas en tiempo de ejecución de Windows PowerShell la [System.Management.Automation.Provider.Cmdletprovider.Start\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) método cuando se inicia Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="19096-131">To initialize the provider, the Windows PowerShell runtime calls the [System.Management.Automation.Provider.Cmdletprovider.Start\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) method when Windows PowerShell is started.</span></span> <span data-ttu-id="19096-132">En su mayor parte, el proveedor puede usar la implementación predeterminada de este método, que simplemente devuelve el [System.Management.Automation.Providerinfo](/dotnet/api/System.Management.Automation.ProviderInfo) objeto que describe el proveedor.</span><span class="sxs-lookup"><span data-stu-id="19096-132">For the most part, your provider can use the default implementation of this method, which simply returns the [System.Management.Automation.Providerinfo](/dotnet/api/System.Management.Automation.ProviderInfo) object that describes your provider.</span></span> <span data-ttu-id="19096-133">Sin embargo, en el caso donde desea agregar la información de inicialización adicionales, debe implementar su propio [System.Management.Automation.Provider.Cmdletprovider.Start\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) método que devuelve una versión modificada de la [ System.Management.Automation.Providerinfo](/dotnet/api/System.Management.Automation.ProviderInfo) objeto que se pasa al proveedor.</span><span class="sxs-lookup"><span data-stu-id="19096-133">However, in the case where you want to add additional initialization information, you should implement your own [System.Management.Automation.Provider.Cmdletprovider.Start\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) method that returns a modified version of the [System.Management.Automation.Providerinfo](/dotnet/api/System.Management.Automation.ProviderInfo) object that is passed to your provider.</span></span> <span data-ttu-id="19096-134">En general, este método debe devolver proporcionado [System.Management.Automation.Providerinfo](/dotnet/api/System.Management.Automation.ProviderInfo) objeto pasa a él o una modificada [System.Management.Automation.Providerinfo](/dotnet/api/System.Management.Automation.ProviderInfo) objeto contiene información de inicialización.</span><span class="sxs-lookup"><span data-stu-id="19096-134">In general, this method should return the provided [System.Management.Automation.Providerinfo](/dotnet/api/System.Management.Automation.ProviderInfo) object passed to it or a modified [System.Management.Automation.Providerinfo](/dotnet/api/System.Management.Automation.ProviderInfo) object that contains other initialization information.</span></span>

<span data-ttu-id="19096-135">Este proveedor básico no invalida este método.</span><span class="sxs-lookup"><span data-stu-id="19096-135">This basic provider does not override this method.</span></span> <span data-ttu-id="19096-136">Sin embargo, el código siguiente muestra la implementación predeterminada de este método:</span><span class="sxs-lookup"><span data-stu-id="19096-136">However, the following code shows the default implementation of this method:</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplesaccessdbprov01#accessdbprov01ProviderStart](Msh_samplesaccessdbprov01#accessdbprov01ProviderStart)]  -->

<span data-ttu-id="19096-137">El proveedor puede mantener el estado de la información específica del proveedor como se describe en [estado de los datos específicos del proveedor definir](#defining-provider-specific-state-information).</span><span class="sxs-lookup"><span data-stu-id="19096-137">The provider can maintain the state of provider-specific information as described in [Defining Provider-specific Data State](#defining-provider-specific-state-information).</span></span> <span data-ttu-id="19096-138">En este caso, debe invalidar la implementación de la [System.Management.Automation.Provider.Cmdletprovider.Start\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) método para devolver una instancia de la clase derivada.</span><span class="sxs-lookup"><span data-stu-id="19096-138">In this case, your implementation must override the [System.Management.Automation.Provider.Cmdletprovider.Start\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) method to return an instance of the derived class.</span></span>

## <a name="start-dynamic-parameters"></a><span data-ttu-id="19096-139">Iniciar los parámetros dinámicos</span><span class="sxs-lookup"><span data-stu-id="19096-139">Start Dynamic Parameters</span></span>

<span data-ttu-id="19096-140">La implementación del proveedor de la [System.Management.Automation.Provider.Cmdletprovider.Start\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) método puede requerir parámetros adicionales.</span><span class="sxs-lookup"><span data-stu-id="19096-140">Your provider implementation of the [System.Management.Automation.Provider.Cmdletprovider.Start\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Start) method might require additional parameters.</span></span> <span data-ttu-id="19096-141">En este caso, debe invalidar el proveedor la [System.Management.Automation.Provider.Cmdletprovider.Startdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.StartDynamicParameters) método y devolver un objeto que tiene las propiedades y campos con el análisis de atributos similar a un clase del cmdlet o una [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) objeto.</span><span class="sxs-lookup"><span data-stu-id="19096-141">In this case, the provider should override the [System.Management.Automation.Provider.Cmdletprovider.Startdynamicparameters\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.StartDynamicParameters) method and return an object that has properties and fields with parsing attributes similar to a cmdlet class or a [System.Management.Automation.Runtimedefinedparameterdictionary](/dotnet/api/System.Management.Automation.RuntimeDefinedParameterDictionary) object.</span></span>

<span data-ttu-id="19096-142">Este proveedor básico no invalida este método.</span><span class="sxs-lookup"><span data-stu-id="19096-142">This basic provider does not override this method.</span></span> <span data-ttu-id="19096-143">Sin embargo, el código siguiente muestra la implementación predeterminada de este método:</span><span class="sxs-lookup"><span data-stu-id="19096-143">However, the following code shows the default implementation of this method:</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplesaccessdbprov01#accessdbprov01ProviderDynamicParameters](Msh_samplesaccessdbprov01#accessdbprov01ProviderDynamicParameters)]  -->

## <a name="uninitializing-the-provider"></a><span data-ttu-id="19096-144">Cancelar la inicialización del proveedor</span><span class="sxs-lookup"><span data-stu-id="19096-144">Uninitializing the Provider</span></span>

<span data-ttu-id="19096-145">Para liberar los recursos que usa el proveedor de Windows PowerShell, el proveedor debe implementar su propio [System.Management.Automation.Provider.Cmdletprovider.Stop\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Stop) método.</span><span class="sxs-lookup"><span data-stu-id="19096-145">To free resources that the Windows PowerShell provider uses, your provider should implement its own [System.Management.Automation.Provider.Cmdletprovider.Stop\*](/dotnet/api/System.Management.Automation.Provider.CmdletProvider.Stop) method.</span></span> <span data-ttu-id="19096-146">Este método es invocado por el tiempo de ejecución de Windows PowerShell para anular la inicialización del proveedor en el cierre de sesión.</span><span class="sxs-lookup"><span data-stu-id="19096-146">This method is called by the Windows PowerShell runtime to uninitialize the provider at the close of a session.</span></span>

<span data-ttu-id="19096-147">Este proveedor básico no invalida este método.</span><span class="sxs-lookup"><span data-stu-id="19096-147">This basic provider does not override this method.</span></span> <span data-ttu-id="19096-148">Sin embargo, el código siguiente muestra la implementación predeterminada de este método:</span><span class="sxs-lookup"><span data-stu-id="19096-148">However, the following code shows the default implementation of this method:</span></span>

<!-- TODO!!!: review snippet reference  [!CODE [Msh_samplesaccessdbprov01#accessdbprov01ProviderStop](Msh_samplesaccessdbprov01#accessdbprov01ProviderStop)]  -->

## <a name="code-sample"></a><span data-ttu-id="19096-149">Ejemplo de código</span><span class="sxs-lookup"><span data-stu-id="19096-149">Code Sample</span></span>

<span data-ttu-id="19096-150">Para el código de ejemplo completo, vea [AccessDbProviderSample01 código de ejemplo](./accessdbprovidersample01-code-sample.md).</span><span class="sxs-lookup"><span data-stu-id="19096-150">For complete sample code, see [AccessDbProviderSample01 Code Sample](./accessdbprovidersample01-code-sample.md).</span></span>

## <a name="testing-the-windows-powershell-provider"></a><span data-ttu-id="19096-151">Probar el proveedor de Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="19096-151">Testing the Windows PowerShell Provider</span></span>

<span data-ttu-id="19096-152">Una vez que se ha registrado el proveedor de Windows PowerShell con Windows PowerShell, puede probarla mediante la ejecución de los cmdlets compatibles en la línea de comandos.</span><span class="sxs-lookup"><span data-stu-id="19096-152">Once your Windows PowerShell provider has been registered with Windows PowerShell, you can test it by running the supported cmdlets on the command line.</span></span> <span data-ttu-id="19096-153">Para este proveedor básica, ejecute el nuevo shell y usar el `Get-PSProvider` cmdlet para recuperar la lista de proveedores y asegúrese de que el proveedor de AccessDb está presente.</span><span class="sxs-lookup"><span data-stu-id="19096-153">For this basic provider, run the new shell and use the `Get-PSProvider` cmdlet to retrieve the list of providers and ensure that the AccessDb provider is present.</span></span>

```powershell
Get-PSProvider
```

<span data-ttu-id="19096-154">Aparecerá el siguiente resultado:</span><span class="sxs-lookup"><span data-stu-id="19096-154">The following output appears:</span></span>

```output
Name                 Capabilities                  Drives
----                 ------------                  ------
AccessDb             None                          {}
Alias                ShouldProcess                 {Alias}
Environment          ShouldProcess                 {Env}
FileSystem           Filter, ShouldProcess         {C, Z}
Function             ShouldProcess                 {function}
Registry             ShouldProcess                 {HKLM, HKCU}
```

## <a name="see-also"></a><span data-ttu-id="19096-155">Véase también</span><span class="sxs-lookup"><span data-stu-id="19096-155">See Also</span></span>

[<span data-ttu-id="19096-156">Creación de proveedores de Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="19096-156">Creating Windows PowerShell Providers</span></span>](./how-to-create-a-windows-powershell-provider.md)

[<span data-ttu-id="19096-157">Diseñar el proveedor de Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="19096-157">Designing Your Windows PowerShell Provider</span></span>](./designing-your-windows-powershell-provider.md)